import{r as d,j as r,I}from"./index-COkkxyBS.js";const k=({questions:a,_sheetUrl:v,_onLoad:w,_onLoadFirestore:j,_onClearView:S,_onHardReset:E,onUpdateQuestion:g,onKickBack:m,_isProcessing:M,showMessage:c,filterMode:p="all",sortBy:u="default"})=>{const[_,L]=d.useState(!1),[N,A]=d.useState(0),[C,x]=d.useState(!1),f=d.useRef(null);d.useEffect(()=>{const t=e=>{f.current&&!f.current.contains(e.target)&&x(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const l=d.useMemo(()=>{if(!a)return[];const e=[...a];switch(u){case"newest":return e.sort((n,s)=>{const o=n.createdAt||n.id||0;return(s.createdAt||s.id||0)-o});case"oldest":return e.sort((n,s)=>{const o=n.createdAt||n.id||0,i=s.createdAt||s.id||0;return o-i});case"language":return e.sort((n,s)=>(n.language||"English").localeCompare(s.language||"English"));case"discipline":return e.sort((n,s)=>(n.discipline||"").localeCompare(s.discipline||""));case"difficulty":{const n={Easy:1,Medium:2,Hard:3};return e.sort((s,o)=>(n[s.difficulty]||0)-(n[o.difficulty]||0))}case"default":default:return e}},[a,u,p]),h=d.useMemo(()=>{if(!a)return new Map;const t=new Map;return a.forEach(e=>{e.uniqueId&&(t.has(e.uniqueId)||t.set(e.uniqueId,new Set),t.get(e.uniqueId).add(e.language||"English"))}),t},[a]),y=d.useMemo(()=>{if(!a)return new Map;const t=new Map;return a.forEach(e=>{if(!e.uniqueId)return;const n=`${e.uniqueId}::${e.language||"English"}`;t.set(n,e)}),t},[a]),b=(t,e)=>{if(!t.uniqueId){c("Cannot switch: Question has no unique ID for linking translations.");return}const n=`${t.uniqueId}::${e}`,s=y.get(n);if(s){const o=l.findIndex(i=>i.id===s.id);if(o!==-1){const i=document.querySelector(`[data-question-index="${o}"]`);i&&(i.scrollIntoView({behavior:"smooth",block:"center"}),i.classList.add("ring-2","ring-green-500"),setTimeout(()=>i.classList.remove("ring-2","ring-green-500"),2e3)),c(`Scrolled to ${e} version.`)}}else c(`${e} version not found in current view. Try using "Sort by Language" to find it.`)};return r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"flex justify-between items-center bg-blue-900/20 p-4 rounded border border-blue-800/50",children:r.jsx("div",{className:"flex items-center gap-4",children:r.jsxs("div",{children:[r.jsxs("h2",{className:"text-lg font-bold text-blue-400 flex items-center gap-2",children:[r.jsx(I,{name:"database"})," Database View"]}),r.jsxs("p",{className:"text-xs text-blue-300/70",children:["Viewing ",l.length," of ",a.length," loaded records"]})]})})}),r.jsx(MetricsDashboard,{questions:a}),l.length===0?r.jsx("div",{className:"text-center py-10 text-slate-500",children:"No questions loaded from database. Click Refresh."}):l.map((t,e)=>r.jsx("div",{"data-question-index":e,className:"opacity-75 hover:opacity-100 transition-all",children:r.jsx(QuestionItem,{q:t,onUpdateStatus:()=>{},onExplain:()=>{},onVariate:()=>{},onCritique:()=>{},onTranslateSingle:()=>{},onSwitchLanguage:n=>b(t,n),onDelete:()=>{},onUpdateQuestion:g,onKickBack:m,availableLanguages:h.get(t.uniqueId),isProcessing:!1,appMode:"database",showMessage:c})},e))]})};export{k as default};
