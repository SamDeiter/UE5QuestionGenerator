import{R as _,r as y,j as t,a as N,I as g,b as z}from"./index-dnyhAfNJ.js";const Q=({q:e,onUpdateStatus:a,onExplain:n,onVariate:o,onCritique:d,onRewrite:x,onTranslateSingle:m,onSwitchLanguage:f,onDelete:b,onUpdateQuestion:l,onKickBack:p,availableLanguages:h,isProcessing:c,appMode:s,showMessage:r,isSelected:w,onToggleSelect:v,showCheckbox:u})=>{const[R,S]=y.useState(!1),[A,V]=y.useState(e.question),k=i=>{switch(i){case"accepted":return"ring-1 ring-green-500/50";case"rejected":return"border-red-900/50 bg-slate-950/80 opacity-50 grayscale";default:return""}},C=i=>{switch(i?.toLowerCase()){case"easy":return"bg-gradient-to-br from-slate-900/50 to-green-950 border-green-700 shadow-[0_0_15px_-5px_rgba(34,197,94,0.3)]";case"medium":return"bg-gradient-to-br from-slate-900/50 to-yellow-950 border-yellow-700 shadow-[0_0_15px_-5px_rgba(234,179,8,0.3)]";case"hard":return"bg-gradient-to-br from-slate-900/50 to-red-950 border-red-700 shadow-[0_0_15px_-5px_rgba(239,68,68,0.3)]";default:return"bg-slate-900 border-slate-800"}},E=i=>{switch(i?.toLowerCase()){case"easy":return"bg-green-950 text-green-400 border-green-900";case"medium":return"bg-yellow-950 text-amber-300 border-yellow-900";case"hard":return"bg-red-950 text-red-400 border-red-900";default:return"bg-slate-800 text-slate-400 border-slate-700"}};return e.status,t.jsxs("div",{className:`group rounded-lg border shadow-sm transition-all p-4 relative ${C(e.difficulty)} ${k(e.status)}`,children:[u&&t.jsx("div",{className:"absolute top-4 left-4 z-20",children:t.jsx("input",{type:"checkbox",checked:w,onChange:i=>{i.stopPropagation(),v()},className:"w-4 h-4 rounded border-slate-600 bg-slate-800 text-indigo-600 focus:ring-indigo-500 cursor-pointer"})}),t.jsxs("div",{className:"flex flex-col gap-2 mb-3 pl-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsx("div",{className:"flex-1",children:t.jsx(QuestionHeader,{q:e,getDiffBadgeColor:E,onKickBack:p,appMode:s})}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsx(QuestionActions,{q:e,onUpdateStatus:a,onCritique:d,onExplain:n,onVariate:o,onDelete:b,onUpdateQuestion:l,isProcessing:c,appMode:s,showMessage:r})})]}),s==="review"&&t.jsx(ReviewProgressBar,{question:e,onCritique:()=>d?.(e),onVerify:()=>{const j=N("ue5_gen_config")?.creatorName||"Unknown";l(e.id,{...e,humanVerified:!0,humanVerifiedAt:new Date().toISOString(),humanVerifiedBy:j}),r&&r("✓ Source verified! Click Accept to approve.",2e3)},onAccept:()=>{if(!e.humanVerified){r&&r("⚠️ Please verify first",3e3);return}a(e.id,"accepted")},isProcessing:c}),t.jsx(LanguageControls,{q:e,availableLanguages:h,onSwitchLanguage:f,onTranslateSingle:m,isProcessing:c,appMode:s})]}),(!e._validation?.isValid||e.answerMismatch||e.invalidUrl)&&t.jsxs("div",{className:"pl-6 mb-3 flex flex-col gap-2",children:[(e.answerMismatch||e._validation&&!e._validation.isValid&&e._validation.warnings.some(i=>i.includes("Answer")))&&t.jsxs("div",{className:"flex items-center gap-2 p-2 bg-yellow-950/40 border border-yellow-700/40 rounded text-yellow-200 text-xs animate-in fade-in slide-in-from-top-1",children:[t.jsx(g,{name:"alert-triangle",size:14,className:"text-yellow-500"}),t.jsxs("span",{children:[t.jsx("strong",{children:"Warning:"})," Answer may not match source excerpt. Verify carefully."]})]}),(e.invalidUrl||e._validation&&!e._validation.isValid&&e._validation.warnings.some(i=>i.includes("URL")))&&t.jsxs("div",{className:"flex items-center gap-2 p-2 bg-red-950/40 border border-red-700/40 rounded text-red-200 text-xs animate-in fade-in slide-in-from-top-1",children:[t.jsx(g,{name:"link",size:14,className:"text-red-500"}),t.jsxs("span",{children:[t.jsx("strong",{children:"Warning:"})," Source URL may be invalid or generic."]})]})]}),t.jsxs("div",{className:"pl-6",children:[t.jsx(QuestionContent,{q:e,isEditing:R,editedText:A,setEditedText:V,setIsEditing:S,onUpdateQuestion:l,showMessage:r,appMode:s}),s==="review"&&(e.critique||e.critiqueScore)&&t.jsx(CritiqueDisplay,{critique:e.critiqueScore?{score:e.critiqueScore,text:e.critique}:e.critique,onRewrite:s==="review"&&x?()=>x(e):void 0,isProcessing:c,suggestedRewrite:s==="review"?e.suggestedRewrite:null,rewriteChanges:s==="review"?e.rewriteChanges:null,originalQuestion:e,onApplyRewrite:async()=>{if(!e.suggestedRewrite)return;const i={...e,question:e.suggestedRewrite.question,options:e.suggestedRewrite.options,correct:e.suggestedRewrite.correct,suggestedRewrite:null,rewriteChanges:null,critique:null,critiqueScore:null,humanVerified:!1};l(e.id,i),r&&r("✓ Applied! Re-critiquing...",2e3),d&&setTimeout(()=>{d({...i,id:e.id})},300)},onApplyAndAccept:()=>{if(!e.suggestedRewrite)return;const j=N("ue5_gen_config")?.creatorName||"Unknown",L={...e,question:e.suggestedRewrite.question,options:e.suggestedRewrite.options,correct:e.suggestedRewrite.correct,suggestedRewrite:null,rewriteChanges:null,critique:null,critiqueScore:100,humanVerified:!0,humanVerifiedAt:new Date().toISOString(),humanVerifiedBy:j,status:"accepted"};l(e.id,L),a(e.id,"accepted"),r&&r("✓ Applied & Accepted!",3e3)},onExplain:s==="review"&&n?()=>n(e):void 0,onVariate:s==="review"&&o?()=>o(e):void 0}),e.explanation&&t.jsxs("div",{className:"mb-3 p-3 bg-indigo-950/30 border border-indigo-500/30 rounded-lg animate-in fade-in slide-in-from-top-2",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1 text-indigo-300 text-sm font-bold uppercase",children:[t.jsx(g,{name:"lightbulb",size:14})," Explanation"]}),t.jsx("div",{className:"text-sm text-slate-300 leading-relaxed",dangerouslySetInnerHTML:{__html:z(e.explanation)}})]}),t.jsx(QuestionMetadata,{q:e,showMessage:r})]})]})},T=_.memo(Q),D=({questions:e,currentIndex:a,setCurrentIndex:n,onUpdateStatus:o,onExplain:d,onVariate:x,onCritique:m,onTranslateSingle:f,onSwitchLanguage:b,onDelete:l,onUpdateQuestion:p,translationMap:h,isProcessing:c,showMessage:s})=>{if(_.useEffect(()=>{e&&e>0&&a>=e&&n(e-1)},[e,a,n]),!e||e.length===0)return null;const r=e[a];if(!r)return t.jsx("div",{className:"text-center p-10 text-slate-500",children:"No question selected."});const w=a>0,v=a<e.length-1;return t.jsxs("div",{className:"flex flex-col items-center justify-start h-full max-w-4xl mx-auto w-full pt-4",children:[t.jsxs("div",{className:"w-full mb-6 flex justify-between items-center text-slate-400 text-xs font-mono bg-slate-900/50 p-2 rounded-lg border border-slate-800",children:[t.jsxs("button",{onClick:()=>n(u=>Math.max(u-1,0)),disabled:!w,className:"flex items-center gap-2 px-4 py-2 rounded hover:bg-slate-800 disabled:opacity-30 disabled:hover:bg-transparent transition-colors font-bold",children:[t.jsx(g,{name:"arrow-left",size:16})," PREV"]}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-slate-500 uppercase text-[10px] tracking-widest",children:"Review Progress"}),t.jsxs("span",{className:"text-lg",children:[t.jsx("span",{className:"text-white font-bold",children:a+1})," ",t.jsx("span",{className:"text-slate-600",children:"/"})," ",t.jsx("span",{className:"text-slate-400 font-bold",children:e.length})]})]}),t.jsxs("button",{onClick:()=>n(u=>Math.min(u+1,e.length-1)),disabled:!v,className:"flex items-center gap-2 px-4 py-2 rounded hover:bg-slate-800 disabled:opacity-30 disabled:hover:bg-transparent transition-colors font-bold",children:["NEXT ",t.jsx(g,{name:"arrow-right",size:16})]})]}),t.jsx("div",{className:"w-full transform transition-all duration-300",children:t.jsx(T,{q:r,onUpdateStatus:o,onExplain:d,onVariate:x,onCritique:m,onTranslateSingle:f,onSwitchLanguage:b,onDelete:l,onUpdateQuestion:p,availableLanguages:h.get(r.uniqueId),isProcessing:c,appMode:"review",showMessage:s},r.uniqueId)})]})};export{D as default};
