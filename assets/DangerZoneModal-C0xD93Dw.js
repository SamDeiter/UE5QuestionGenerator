const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Do-3NpYN.js","assets/index-Ci3uOsUR.css"])))=>i.map(i=>d[i]);
import{j as e,I as l,r as f,_ as v,m as P,n as L,o as q,B as O,p as z,q as M,s as V,F as Y,t as $,u as G,v as U,G as B,w as Q,x as W,y as H,z as K,E as Z,H as J,S as X,J as ee,V as te,K as se,M as ae,N as re,O as oe,P as le,W as ne,Y as ie,Z as ce,$ as de,a0 as ue,a1 as me,a2 as xe,a3 as he,a4 as ge,a5 as be,a6 as fe,a7 as pe,a8 as ye,a9 as Ne,aa as Ee,ab as je,ac as we}from"./index-Do-3NpYN.js";const Ce=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:q,Bytes:O,CollectionReference:z,DocumentReference:M,DocumentSnapshot:V,FieldPath:Y,FieldValue:$,Firestore:G,FirestoreError:U,GeoPoint:B,Query:Q,QueryCompositeFilterConstraint:W,QueryConstraint:H,QueryDocumentSnapshot:K,QueryFieldFilterConstraint:Z,QuerySnapshot:J,SnapshotMetadata:X,Timestamp:ee,VectorValue:te,_AutoId:se,_ByteString:ae,_DatabaseId:re,_DocumentKey:oe,_EmptyAuthCredentialsProvider:le,_FieldPath:ne,_cast:ie,_logWarn:ce,_validateIsNotUsedTogether:de,collection:ue,connectFirestoreEmulator:me,deleteDoc:xe,doc:he,ensureFirestoreConfigured:ge,executeWrite:be,getDoc:fe,getDocs:pe,getFirestore:ye,query:Ne,setDoc:Ee,updateDoc:je,where:we},Symbol.toStringTag,{value:"Module"})),Te=({isOpen:p,title:y,message:n,confirmText:N="Confirm",cancelText:s="Cancel",onConfirm:d,onCancel:E,isDanger:r=!1})=>p?e.jsx("div",{className:"fixed inset-0 bg-black/90 z-[200] flex items-center justify-center p-4 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-700 p-6 rounded-xl shadow-2xl max-w-md w-full animate-in zoom-in-95 duration-300 space-y-4",children:[e.jsxs("h3",{className:`text-xl font-bold flex items-center gap-2 ${r?"text-red-500":"text-yellow-500"}`,children:[e.jsx(l,{name:r?"alert-triangle":"help-circle",size:24}),y]}),e.jsx("div",{className:"text-sm text-slate-300",children:n.split(`
`).map((j,t)=>e.jsx("p",{className:t>0?"mt-2":"",children:j},t))}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:E,className:"flex-1 px-4 py-2.5 text-sm rounded bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition-colors font-medium",children:s}),e.jsx("button",{onClick:d,className:`flex-1 px-4 py-2.5 text-sm rounded font-bold transition-colors ${r?"bg-red-600 hover:bg-red-500 text-white":"bg-blue-600 hover:bg-blue-500 text-white"}`,children:N})]})]})}):null,Fe=({isOpen:p,title:y,message:n,placeholder:N="",expectedValue:s=null,confirmText:d="Confirm",cancelText:E="Cancel",onConfirm:r,onCancel:j,isDanger:t=!1})=>{const[u,c]=f.useState("");if(!p)return null;const w=()=>{if(s&&u!==s){alert(`Please type "${s}" exactly to confirm.`);return}r(u),c("")},m=()=>{c(""),j()};return e.jsx("div",{className:"fixed inset-0 bg-black/90 z-[200] flex items-center justify-center p-4 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-700 p-6 rounded-xl shadow-2xl max-w-md w-full animate-in zoom-in-95 duration-300 space-y-4",children:[e.jsxs("h3",{className:`text-xl font-bold flex items-center gap-2 ${t?"text-red-500":"text-yellow-500"}`,children:[e.jsx(l,{name:t?"alert-triangle":"help-circle",size:24}),y]}),e.jsx("p",{className:"text-sm text-slate-300 whitespace-pre-line",children:n}),e.jsx("input",{type:"text",value:u,onChange:x=>c(x.target.value),placeholder:N,className:"w-full px-3 py-2 bg-slate-800 border border-slate-700 rounded text-sm text-white focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all",autoFocus:!0,onKeyDown:x=>{x.key==="Enter"&&w(),x.key==="Escape"&&m()}}),s&&e.jsxs("p",{className:"text-xs text-slate-500",children:["Type ",e.jsx("span",{className:"font-bold text-red-400",children:s})," to confirm"]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{onClick:m,className:"flex-1 px-4 py-2 text-sm rounded bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition-colors font-medium",children:E}),e.jsx("button",{onClick:w,className:`flex-1 px-4 py-2 text-sm rounded font-bold transition-colors ${t?"bg-red-600 hover:bg-red-500 text-white":"bg-blue-600 hover:bg-blue-500 text-white"}`,children:d})]})]})})},_e=({isOpen:p,onClose:y,config:n,onClearData:N})=>{const[s,d]=f.useState(!1),[E,r]=f.useState(!1),[j,t]=f.useState(!1),[u,c]=f.useState(!1),[w,m]=f.useState(null),x=()=>{r(!0)},_=()=>{r(!1),t(!0)},R=async h=>{if(h!=="DELETE EVERYTHING"){alert("Factory reset cancelled. You must type 'DELETE EVERYTHING' exactly."),t(!1);return}console.log("âš ï¸ FACTORY RESET INITIATED"),t(!1),d(!0);try{let i=0;console.log("Clearing Firestore...");try{i=await P(),console.log(`âœ… Deleted ${i} questions from Firestore`)}catch(g){throw console.error("âŒ Firestore deletion failed:",g),new Error(`Firestore deletion failed: ${g.message}`)}if(n.sheetUrl){console.log("Clearing Google Spreadsheet...");try{L(n.sheetUrl),console.log("âœ… Spreadsheet clear request sent (check new tab)")}catch(g){console.error("âŒ Sheets clearing failed:",g)}}console.log("Clearing localStorage..."),localStorage.clear(),console.log("âœ… Local storage cleared"),alert(`Factory Reset Complete!

â€¢ Firestore: ${i} questions deleted
â€¢ Spreadsheet: ${n.sheetUrl?"Clearing in new tab":"Skipped"}
â€¢ Local Storage: Cleared

Page will reload.`),window.location.reload()}catch(i){console.error("âŒ Factory reset error:",i),alert(`Error during factory reset:

`+i.message+`

Check console for details.`),d(!1)}},S=async()=>{if(confirm('This will add your creator name to all questions that currently show "N/A". Continue?')){c(!0),m(null);try{const{getDocs:h,collection:i,doc:g,updateDoc:D}=await v(async()=>{const{getDocs:o,collection:a,doc:b,updateDoc:k}=await Promise.resolve().then(()=>Ce);return{getDocs:o,collection:a,doc:b,updateDoc:k}},void 0),{db:F}=await v(async()=>{const{db:o}=await import("./index-Do-3NpYN.js").then(a=>a.ad);return{db:o}},__vite__mapDeps([0,1])),A=n.creatorName||"Unknown",I=await h(i(F,"questions")),C=[];if(I.forEach(o=>{const a=o.data(),b=a.creatorName;(!b||b.trim()===""||b==="N/A"||b==="Unknown")&&C.push({id:o.id,...a})}),C.length===0){m({success:0,total:0,message:"All questions already have creator names!"}),c(!1);return}let T=0;for(const o of C)try{const a=g(F,"questions",String(o.id));await D(a,{creatorName:A,backfilledAt:new Date().toISOString()}),T++}catch(a){console.error(`Failed to update question ${o.id}:`,a)}m({success:T,total:C.length,message:`Successfully updated ${T} of ${C.length} questions!`})}catch(h){console.error("Migration failed:",h),alert("Migration failed: "+h.message)}finally{c(!1)}}};return p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-red-950/50 border-2 border-red-500 rounded-xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"p-4 border-b border-red-900 flex justify-between items-center bg-red-900/50",children:[e.jsxs("h2",{className:"text-lg font-bold text-red-300 flex items-center gap-2",children:[e.jsx(l,{name:"alert-triangle",className:"text-red-500"})," DANGER ZONE"]}),e.jsx("button",{onClick:y,className:"text-red-400 hover:text-white transition-colors","aria-label":"Close Danger Zone",children:e.jsx(l,{name:"x"})})]}),e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("div",{className:"bg-red-900/20 p-4 rounded-lg border border-red-900/50",children:[e.jsxs("p",{className:"text-sm text-red-300 mb-4",children:["âš ï¸ ",e.jsx("strong",{children:"WARNING:"})," These operations are ",e.jsx("strong",{children:"PERMANENT"})," and cannot be undone. Your data will be lost forever."]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-blue-900/20 p-3 rounded border border-blue-900/50 mb-3",children:[e.jsx("p",{className:"text-xs text-blue-300 mb-2 font-semibold",children:"ðŸ”§ Data Migration"}),e.jsx("button",{onClick:S,disabled:u,className:"w-full px-4 py-2 bg-blue-900/20 hover:bg-blue-900/40 text-blue-400 text-xs font-bold rounded border border-blue-900/50 transition-colors flex items-center justify-center gap-2 disabled:opacity-50",children:u?e.jsxs(e.Fragment,{children:[e.jsx(l,{name:"loader",size:14,className:"animate-spin"})," Migrating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(l,{name:"user-check",size:14})," Backfill Creator Names"]})}),w&&e.jsxs("p",{className:"text-xs text-green-400 mt-2 text-center",children:["âœ“ ",w.message]}),e.jsx("p",{className:"text-[9px] text-blue-400/60 mt-1",children:'Adds your name to questions showing "N/A"'})]}),e.jsxs("button",{onClick:N,className:"w-full px-4 py-3 bg-red-900/20 hover:bg-red-900/40 text-red-400 text-sm font-bold rounded border border-red-900/50 transition-colors flex items-center justify-center gap-2",children:[e.jsx(l,{name:"trash-2",size:16}),"Clear Local Data (Keep Cloud Backup)"]}),e.jsx("button",{onClick:x,disabled:s,className:"w-full px-4 py-3 bg-red-950 hover:bg-red-900 text-red-500 text-sm font-bold rounded border-2 border-red-900 transition-colors flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:s?e.jsxs(e.Fragment,{children:[e.jsx(l,{name:"loader",size:16,className:"animate-spin"})," Resetting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(l,{name:"bomb",size:16})," FACTORY RESET (Delete Everything)"]})})]}),e.jsx("p",{className:"text-[10px] text-red-400/70 mt-3 text-center",children:"Factory Reset deletes ALL data: Spreadsheet + Firestore + Local Storage"})]})})]})}),e.jsx(Te,{isOpen:E,title:"âš ï¸ FACTORY RESET WARNING âš ï¸",message:`This will PERMANENTLY DELETE ALL data from:

â€¢ Google Spreadsheet (all Master_ sheets)
â€¢ Firestore Database (cloud)  
â€¢ Local storage (questions, settings, analytics)

This action CANNOT be undone. Are you ABSOLUTELY SURE?`,confirmText:"Yes, I Understand",cancelText:"Cancel",onConfirm:_,onCancel:()=>r(!1),isDanger:!0}),e.jsx(Fe,{isOpen:j,title:"ðŸ”´ FINAL CONFIRMATION ðŸ”´",message:"Type 'DELETE EVERYTHING' (all caps, no quotes) to confirm permanent deletion of ALL data:",placeholder:"Type DELETE EVERYTHING here",expectedValue:"DELETE EVERYTHING",confirmText:"Delete Everything Forever",cancelText:"Cancel",onConfirm:R,onCancel:()=>t(!1),isDanger:!0})]}):null};export{_e as default};
