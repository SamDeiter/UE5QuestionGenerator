const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-ByeKXsca.js","assets/index-BZz-e5_v.css"])))=>i.map(i=>d[i]);
import{j as e,I as l,r as b,_ as v,m as P,n as L,o as q,B as O,p as z,q as M,s as V,F as Y,t as $,u as U,v as G,G as Q,w as B,x as W,y as H,z as K,E as Z,H as J,J as X,K as ee,M as te,S as se,N as re,V as ae,O as oe,P as le,W as ne,Y as ie,Z as ce,$ as de,a0 as ue,a1 as me,a2 as xe,a3 as he,a4 as fe,a5 as ge,a6 as be,a7 as pe,a8 as ye,a9 as Ne,aa as Ee,ab as je,ac as Ce,ad as we,ae as Te,af as Fe,ag as ve,ah as _e,ai as Re}from"./index-ByeKXsca.js";const Se=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:q,Bytes:O,CollectionReference:z,DocumentReference:M,DocumentSnapshot:V,FieldPath:Y,FieldValue:$,Firestore:U,FirestoreError:G,GeoPoint:Q,Query:B,QueryCompositeFilterConstraint:W,QueryConstraint:H,QueryDocumentSnapshot:K,QueryFieldFilterConstraint:Z,QueryLimitConstraint:J,QueryOrderByConstraint:X,QuerySnapshot:ee,QueryStartAtConstraint:te,SnapshotMetadata:se,Timestamp:re,VectorValue:ae,_AutoId:oe,_ByteString:le,_DatabaseId:ne,_DocumentKey:ie,_EmptyAuthCredentialsProvider:ce,_FieldPath:de,_cast:ue,_logWarn:me,_validateIsNotUsedTogether:xe,collection:he,connectFirestoreEmulator:fe,deleteDoc:ge,doc:be,ensureFirestoreConfigured:pe,executeWrite:ye,getDoc:Ne,getDocs:Ee,getFirestore:je,limit:Ce,orderBy:we,query:Te,setDoc:Fe,startAfter:ve,updateDoc:_e,where:Re},Symbol.toStringTag,{value:"Module"})),Ae=({isOpen:p,title:y,message:n,confirmText:N="Confirm",cancelText:a="Cancel",onConfirm:d,onCancel:E,isDanger:o=!1})=>p?e.jsx("div",{className:"fixed inset-0 bg-black/90 z-[200] flex items-center justify-center p-4 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-700 p-6 rounded-xl shadow-2xl max-w-md w-full animate-in zoom-in-95 duration-300 space-y-4",children:[e.jsxs("h3",{className:`text-xl font-bold flex items-center gap-2 ${o?"text-red-500":"text-yellow-500"}`,children:[e.jsx(l,{name:o?"alert-triangle":"help-circle",size:24}),y]}),e.jsx("div",{className:"text-sm text-slate-300",children:n.split(`
`).map((j,s)=>e.jsx("p",{className:s>0?"mt-2":"",children:j},s))}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:E,className:"flex-1 px-4 py-2.5 text-sm rounded bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition-colors font-medium",children:a}),e.jsx("button",{onClick:d,className:`flex-1 px-4 py-2.5 text-sm rounded font-bold transition-colors ${o?"bg-red-600 hover:bg-red-500 text-white":"bg-blue-600 hover:bg-blue-500 text-white"}`,children:N})]})]})}):null,Ie=({isOpen:p,title:y,message:n,placeholder:N="",expectedValue:a=null,confirmText:d="Confirm",cancelText:E="Cancel",onConfirm:o,onCancel:j,isDanger:s=!1})=>{const[u,c]=b.useState("");if(!p)return null;const C=()=>{if(a&&u!==a){alert(`Please type "${a}" exactly to confirm.`);return}o(u),c("")},m=()=>{c(""),j()};return e.jsx("div",{className:"fixed inset-0 bg-black/90 z-[200] flex items-center justify-center p-4 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-700 p-6 rounded-xl shadow-2xl max-w-md w-full animate-in zoom-in-95 duration-300 space-y-4",children:[e.jsxs("h3",{className:`text-xl font-bold flex items-center gap-2 ${s?"text-red-500":"text-yellow-500"}`,children:[e.jsx(l,{name:s?"alert-triangle":"help-circle",size:24}),y]}),e.jsx("p",{className:"text-sm text-slate-300 whitespace-pre-line",children:n}),e.jsx("input",{type:"text",value:u,onChange:x=>c(x.target.value),placeholder:N,className:"w-full px-3 py-2 bg-slate-800 border border-slate-700 rounded text-sm text-white focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all",autoFocus:!0,onKeyDown:x=>{x.key==="Enter"&&C(),x.key==="Escape"&&m()}}),a&&e.jsxs("p",{className:"text-xs text-slate-500",children:["Type ",e.jsx("span",{className:"font-bold text-red-400",children:a})," to confirm"]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{onClick:m,className:"flex-1 px-4 py-2 text-sm rounded bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition-colors font-medium",children:E}),e.jsx("button",{onClick:C,className:`flex-1 px-4 py-2 text-sm rounded font-bold transition-colors ${s?"bg-red-600 hover:bg-red-500 text-white":"bg-blue-600 hover:bg-blue-500 text-white"}`,children:d})]})]})})},ke=({isOpen:p,onClose:y,config:n,onClearData:N})=>{const[a,d]=b.useState(!1),[E,o]=b.useState(!1),[j,s]=b.useState(!1),[u,c]=b.useState(!1),[C,m]=b.useState(null),x=()=>{o(!0)},_=()=>{o(!1),s(!0)},R=async h=>{if(h!=="DELETE EVERYTHING"){alert("Factory reset cancelled. You must type 'DELETE EVERYTHING' exactly."),s(!1);return}console.log("âš ï¸ FACTORY RESET INITIATED"),s(!1),d(!0);try{let i=0;console.log("Clearing Firestore...");try{i=await P(),console.log(`âœ… Deleted ${i} questions from Firestore`)}catch(f){throw console.error("âŒ Firestore deletion failed:",f),new Error(`Firestore deletion failed: ${f.message}`)}if(n.sheetUrl){console.log("Clearing Google Spreadsheet...");try{L(n.sheetUrl),console.log("âœ… Spreadsheet clear request sent (check new tab)")}catch(f){console.error("âŒ Sheets clearing failed:",f)}}console.log("Clearing localStorage..."),localStorage.clear(),console.log("âœ… Local storage cleared"),alert(`Factory Reset Complete!

â€¢ Firestore: ${i} questions deleted
â€¢ Spreadsheet: ${n.sheetUrl?"Clearing in new tab":"Skipped"}
â€¢ Local Storage: Cleared

Page will reload.`),window.location.reload()}catch(i){console.error("âŒ Factory reset error:",i),alert(`Error during factory reset:

`+i.message+`

Check console for details.`),d(!1)}},S=async()=>{if(confirm('This will add your creator name to all questions that currently show "N/A". Continue?')){c(!0),m(null);try{const{getDocs:h,collection:i,doc:f,updateDoc:A}=await v(async()=>{const{getDocs:t,collection:r,doc:g,updateDoc:k}=await Promise.resolve().then(()=>Se);return{getDocs:t,collection:r,doc:g,updateDoc:k}},void 0),{db:F}=await v(async()=>{const{db:t}=await import("./index-ByeKXsca.js").then(r=>r.aj);return{db:t}},__vite__mapDeps([0,1])),I=n.creatorName||"Unknown",D=await h(i(F,"questions")),w=[];if(D.forEach(t=>{const r=t.data(),g=r.creatorName;(!g||g.trim()===""||g==="N/A"||g==="Unknown")&&w.push({firestoreId:t.id,...r})}),w.length===0){m({success:0,total:0,message:"All questions already have creator names!"}),c(!1);return}let T=0;for(const t of w)try{console.log("Updating question:",t.firestoreId,"Creator:",t.creatorName);const r=f(F,"questions",t.firestoreId);await A(r,{creatorName:I,backfilledAt:new Date().toISOString()}),T++,console.log("âœ“ Successfully updated:",t.firestoreId)}catch(r){console.error(`Failed to update question ${t.firestoreId}:`,r.message,r)}m({success:T,total:w.length,message:`Successfully updated ${T} of ${w.length} questions!`})}catch(h){console.error("Migration failed:",h),alert("Migration failed: "+h.message)}finally{c(!1)}}};return p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-red-950/50 border-2 border-red-500 rounded-xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"p-4 border-b border-red-900 flex justify-between items-center bg-red-900/50",children:[e.jsxs("h2",{className:"text-lg font-bold text-red-300 flex items-center gap-2",children:[e.jsx(l,{name:"alert-triangle",className:"text-red-500"})," DANGER ZONE"]}),e.jsx("button",{onClick:y,className:"text-red-400 hover:text-white transition-colors","aria-label":"Close Danger Zone",children:e.jsx(l,{name:"x"})})]}),e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("div",{className:"bg-red-900/20 p-4 rounded-lg border border-red-900/50",children:[e.jsxs("p",{className:"text-sm text-red-300 mb-4",children:["âš ï¸ ",e.jsx("strong",{children:"WARNING:"})," These operations are ",e.jsx("strong",{children:"PERMANENT"})," and cannot be undone. Your data will be lost forever."]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-blue-900/20 p-3 rounded border border-blue-900/50 mb-3",children:[e.jsx("p",{className:"text-xs text-blue-300 mb-2 font-semibold",children:"ðŸ”§ Data Migration"}),e.jsx("button",{onClick:S,disabled:u,className:"w-full px-4 py-2 bg-blue-900/20 hover:bg-blue-900/40 text-blue-400 text-xs font-bold rounded border border-blue-900/50 transition-colors flex items-center justify-center gap-2 disabled:opacity-50",children:u?e.jsxs(e.Fragment,{children:[e.jsx(l,{name:"loader",size:14,className:"animate-spin"})," Migrating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(l,{name:"user-check",size:14})," Backfill Creator Names"]})}),C&&e.jsxs("p",{className:"text-xs text-green-400 mt-2 text-center",children:["âœ“ ",C.message]}),e.jsx("p",{className:"text-[9px] text-blue-400/60 mt-1",children:'Adds your name to questions showing "N/A"'})]}),e.jsxs("button",{onClick:N,className:"w-full px-4 py-3 bg-red-900/20 hover:bg-red-900/40 text-red-400 text-sm font-bold rounded border border-red-900/50 transition-colors flex items-center justify-center gap-2",children:[e.jsx(l,{name:"trash-2",size:16}),"Clear Local Data (Keep Cloud Backup)"]}),e.jsx("button",{onClick:x,disabled:a,className:"w-full px-4 py-3 bg-red-950 hover:bg-red-900 text-red-500 text-sm font-bold rounded border-2 border-red-900 transition-colors flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:a?e.jsxs(e.Fragment,{children:[e.jsx(l,{name:"loader",size:16,className:"animate-spin"})," Resetting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(l,{name:"bomb",size:16})," FACTORY RESET (Delete Everything)"]})})]}),e.jsx("p",{className:"text-[10px] text-red-400/70 mt-3 text-center",children:"Factory Reset deletes ALL data: Spreadsheet + Firestore + Local Storage"})]})})]})}),e.jsx(Ae,{isOpen:E,title:"âš ï¸ FACTORY RESET WARNING âš ï¸",message:`This will PERMANENTLY DELETE ALL data from:

â€¢ Google Spreadsheet (all Master_ sheets)
â€¢ Firestore Database (cloud)  
â€¢ Local storage (questions, settings, analytics)

This action CANNOT be undone. Are you ABSOLUTELY SURE?`,confirmText:"Yes, I Understand",cancelText:"Cancel",onConfirm:_,onCancel:()=>o(!1),isDanger:!0}),e.jsx(Ie,{isOpen:j,title:"ðŸ”´ FINAL CONFIRMATION ðŸ”´",message:"Type 'DELETE EVERYTHING' (all caps, no quotes) to confirm permanent deletion of ALL data:",placeholder:"Type DELETE EVERYTHING here",expectedValue:"DELETE EVERYTHING",confirmText:"Delete Everything Forever",cancelText:"Cancel",onConfirm:R,onCancel:()=>s(!1),isDanger:!0})]}):null};export{ke as default};
