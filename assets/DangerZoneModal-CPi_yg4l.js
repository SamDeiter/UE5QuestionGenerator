const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-dnyhAfNJ.js","assets/index-BZz-e5_v.css"])))=>i.map(i=>d[i]);
import{r as c,j as e,I as a,_ as N,f as P,h as q,A as k,B as O,C as V,D as M,i as Y,F as U,k as G,l as Q,m as B,G as z,Q as $,n as W,o as H,p as K,q as Z,s as J,t as X,u as ee,v as te,S as se,w as re,V as ae,x as oe,y as ne,z as le,E as ie,H as ce,J as de,K as ue,M as me,N as ge,O as he,P as xe,W as fe,X as pe,Y as be,Z as ye,$ as Ee,a0 as Ne,a1 as Ce,a2 as Te,a3 as Fe,a4 as _e,a5 as je,a6 as De,a7 as Re,a8 as Ae}from"./index-dnyhAfNJ.js";const we=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:k,Bytes:O,CollectionReference:V,DocumentReference:M,DocumentSnapshot:Y,FieldPath:U,FieldValue:G,Firestore:Q,FirestoreError:B,GeoPoint:z,Query:$,QueryCompositeFilterConstraint:W,QueryConstraint:H,QueryDocumentSnapshot:K,QueryFieldFilterConstraint:Z,QueryLimitConstraint:J,QueryOrderByConstraint:X,QuerySnapshot:ee,QueryStartAtConstraint:te,SnapshotMetadata:se,Timestamp:re,VectorValue:ae,_AutoId:oe,_ByteString:ne,_DatabaseId:le,_DocumentKey:ie,_EmptyAuthCredentialsProvider:ce,_FieldPath:de,_cast:ue,_logWarn:me,_validateIsNotUsedTogether:ge,collection:he,connectFirestoreEmulator:xe,deleteDoc:fe,doc:pe,ensureFirestoreConfigured:be,executeWrite:ye,getDoc:Ee,getDocs:Ne,getFirestore:Ce,limit:Te,orderBy:Fe,query:_e,setDoc:je,startAfter:De,updateDoc:Re,where:Ae},Symbol.toStringTag,{value:"Module"})),Ie=({isOpen:C,onClose:T,config:d,onClearData:F})=>{const[f,p]=c.useState(!1),[_,m]=c.useState(!1),[j,u]=c.useState(!1),[b,g]=c.useState(!1),[y,h]=c.useState(null),D=()=>{m(!0)},R=()=>{m(!1),u(!0)},A=async o=>{if(o!=="DELETE EVERYTHING"){alert("Factory reset cancelled. You must type 'DELETE EVERYTHING' exactly."),u(!1);return}console.log("âš ï¸ FACTORY RESET INITIATED"),u(!1),p(!0);try{let r=0;console.log("Clearing Firestore...");try{r=await P(),console.log(`âœ… Deleted ${r} questions from Firestore`)}catch(n){throw console.error("âŒ Firestore deletion failed:",n),new Error(`Firestore deletion failed: ${n.message}`)}if(d.sheetUrl){console.log("Clearing Google Spreadsheet...");try{q(d.sheetUrl),console.log("âœ… Spreadsheet clear request sent (check new tab)")}catch(n){console.error("âŒ Sheets clearing failed:",n)}}console.log("Clearing localStorage..."),localStorage.clear(),console.log("âœ… Local storage cleared"),alert(`Factory Reset Complete!

â€¢ Firestore: ${r} questions deleted
â€¢ Spreadsheet: ${d.sheetUrl?"Clearing in new tab":"Skipped"}
â€¢ Local Storage: Cleared

Page will reload.`),window.location.reload()}catch(r){console.error("âŒ Factory reset error:",r),alert(`Error during factory reset:

`+r.message+`

Check console for details.`),p(!1)}},w=async()=>{if(confirm('This will add your creator name to all questions that currently show "N/A". Continue?')){g(!0),h(null);try{const{getDocs:o,collection:r,doc:n,updateDoc:S}=await N(async()=>{const{getDocs:t,collection:s,doc:l,updateDoc:L}=await Promise.resolve().then(()=>we);return{getDocs:t,collection:s,doc:l,updateDoc:L}},void 0),{db:E}=await N(async()=>{const{db:t}=await import("./index-dnyhAfNJ.js").then(s=>s.a9);return{db:t}},__vite__mapDeps([0,1])),I=d.creatorName||"Unknown",v=await o(r(E,"questions")),i=[];if(v.forEach(t=>{const s=t.data(),l=s.creatorName;(!l||l.trim()===""||l==="N/A"||l==="Unknown")&&i.push({firestoreId:t.id,...s})}),i.length===0){h({success:0,total:0,message:"All questions already have creator names!"}),g(!1);return}let x=0;for(const t of i)try{console.log("Updating question:",t.firestoreId,"Creator:",t.creatorName);const s=n(E,"questions",t.firestoreId);await S(s,{creatorName:I,backfilledAt:new Date().toISOString()}),x++,console.log("âœ“ Successfully updated:",t.firestoreId)}catch(s){console.error(`Failed to update question ${t.firestoreId}:`,s.message,s)}h({success:x,total:i.length,message:`Successfully updated ${x} of ${i.length} questions!`})}catch(o){console.error("Migration failed:",o),alert("Migration failed: "+o.message)}finally{g(!1)}}};return C?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-red-950/50 border-2 border-red-500 rounded-xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"p-4 border-b border-red-900 flex justify-between items-center bg-red-900/50",children:[e.jsxs("h2",{className:"text-lg font-bold text-red-300 flex items-center gap-2",children:[e.jsx(a,{name:"alert-triangle",className:"text-red-500"})," DANGER ZONE"]}),e.jsx("button",{onClick:T,className:"text-red-400 hover:text-white transition-colors","aria-label":"Close Danger Zone",children:e.jsx(a,{name:"x"})})]}),e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("div",{className:"bg-red-900/20 p-4 rounded-lg border border-red-900/50",children:[e.jsxs("p",{className:"text-sm text-red-300 mb-4",children:["âš ï¸ ",e.jsx("strong",{children:"WARNING:"})," These operations are ",e.jsx("strong",{children:"PERMANENT"})," and cannot be undone. Your data will be lost forever."]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-blue-900/20 p-3 rounded border border-blue-900/50 mb-3",children:[e.jsx("p",{className:"text-xs text-blue-300 mb-2 font-semibold",children:"ðŸ”§ Data Migration"}),e.jsx("button",{onClick:w,disabled:b,className:"w-full px-4 py-2 bg-blue-900/20 hover:bg-blue-900/40 text-blue-400 text-xs font-bold rounded border border-blue-900/50 transition-colors flex items-center justify-center gap-2 disabled:opacity-50",children:b?e.jsxs(e.Fragment,{children:[e.jsx(a,{name:"loader",size:14,className:"animate-spin"})," Migrating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(a,{name:"user-check",size:14})," Backfill Creator Names"]})}),y&&e.jsxs("p",{className:"text-xs text-green-400 mt-2 text-center",children:["âœ“ ",y.message]}),e.jsx("p",{className:"text-[9px] text-blue-400/60 mt-1",children:'Adds your name to questions showing "N/A"'})]}),e.jsxs("button",{onClick:F,className:"w-full px-4 py-3 bg-red-900/20 hover:bg-red-900/40 text-red-400 text-sm font-bold rounded border border-red-900/50 transition-colors flex items-center justify-center gap-2",children:[e.jsx(a,{name:"trash-2",size:16}),"Clear Local Data (Keep Cloud Backup)"]}),e.jsx("button",{onClick:D,disabled:f,className:"w-full px-4 py-3 bg-red-950 hover:bg-red-900 text-red-500 text-sm font-bold rounded border-2 border-red-900 transition-colors flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:f?e.jsxs(e.Fragment,{children:[e.jsx(a,{name:"loader",size:16,className:"animate-spin"})," Resetting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(a,{name:"bomb",size:16})," FACTORY RESET (Delete Everything)"]})})]}),e.jsx("p",{className:"text-[10px] text-red-400/70 mt-3 text-center",children:"Factory Reset deletes ALL data: Spreadsheet + Firestore + Local Storage"})]})})]})}),e.jsx(ConfirmDialog,{isOpen:_,title:"âš ï¸ FACTORY RESET WARNING âš ï¸",message:`This will PERMANENTLY DELETE ALL data from:

â€¢ Google Spreadsheet (all Master_ sheets)
â€¢ Firestore Database (cloud)  
â€¢ Local storage (questions, settings, analytics)

This action CANNOT be undone. Are you ABSOLUTELY SURE?`,confirmText:"Yes, I Understand",cancelText:"Cancel",onConfirm:R,onCancel:()=>m(!1),isDanger:!0}),e.jsx(PromptDialog,{isOpen:j,title:"ðŸ”´ FINAL CONFIRMATION ðŸ”´",message:"Type 'DELETE EVERYTHING' (all caps, no quotes) to confirm permanent deletion of ALL data:",placeholder:"Type DELETE EVERYTHING here",expectedValue:"DELETE EVERYTHING",confirmText:"Delete Everything Forever",cancelText:"Cancel",onConfirm:A,onCancel:()=>u(!1),isDanger:!0})]}):null};export{Ie as default};
