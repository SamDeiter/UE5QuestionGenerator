[{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\functions\\index.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'configError' is defined but never used.","line":200,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":200,"endColumn":29}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"const functions = require(\"firebase-functions\");\r\nconst admin = require(\"firebase-admin\");\r\n\r\n// Load environment variables from .env file (for local development)\r\nrequire(\"dotenv\").config();\r\n\r\nadmin.initializeApp();\r\n\r\n/**\r\n * Cloud Function: generateQuestions\r\n * Securely calls the Gemini API with server-side API key\r\n *\r\n * This function:\r\n * 1. Validates the user is authenticated\r\n * 2. Implements rate limiting per user\r\n * 3. Calls Gemini API with server-side key\r\n * 4. Returns generated content\r\n */\r\nexports.generateQuestions = functions\r\n  .runWith({\r\n    secrets: [\"GEMINI_API_KEY\"],\r\n    timeoutSeconds: 60,\r\n    memory: \"256MB\",\r\n  })\r\n  .https.onCall(async (data, context) => {\r\n    // 1. Authentication check\r\n    if (!context.auth) {\r\n      throw new functions.https.HttpsError(\r\n        \"unauthenticated\",\r\n        \"User must be authenticated to generate questions.\"\r\n      );\r\n    }\r\n    // ... (start of function body remains)\r\n\r\n    const userId = context.auth.uid;\r\n    const {\r\n      systemPrompt,\r\n      userPrompt,\r\n      temperature = 0.2,\r\n      model = \"gemini-2.0-flash-exp\",\r\n    } = data;\r\n\r\n    // 2. Input validation\r\n    if (!systemPrompt || !userPrompt) {\r\n      throw new functions.https.HttpsError(\r\n        \"invalid-argument\",\r\n        \"systemPrompt and userPrompt are required.\"\r\n      );\r\n    }\r\n\r\n    // 4. Rate limiting check\r\n    const rateLimitCheck = await checkRateLimit(userId);\r\n    if (!rateLimitCheck.allowed) {\r\n      throw new functions.https.HttpsError(\r\n        \"resource-exhausted\",\r\n        `Rate limit exceeded. ${rateLimitCheck.message}`\r\n      );\r\n    }\r\n\r\n    try {\r\n      // 4. Get API key from Secrets or Config\r\n      // secrets using .runWith() are available in process.env\r\n      let apiKey = process.env.GEMINI_API_KEY;\r\n\r\n      if (!apiKey) {\r\n        // Fallback for local emulator or legacy config\r\n        apiKey = functions.config().gemini?.api_key;\r\n      }\r\n\r\n      if (!apiKey) {\r\n        console.error(\"[ERROR] GEMINI_API_KEY secret is not set.\");\r\n        throw new functions.https.HttpsError(\r\n          \"failed-precondition\",\r\n          \"Server configuration error: API Key missing.\"\r\n        );\r\n      }\r\n\r\n      // ... rest of logic\r\n\r\n      console.log(\"[DEBUG] API key found, length:\", apiKey.length);\r\n\r\n      // 5. Call Gemini API\r\n      const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`;\r\n      console.log(\r\n        \"[DEBUG] Calling Gemini API (SKIPPED FOR DEBUGGING) with model:\",\r\n        model\r\n      );\r\n\r\n      const payload = {\r\n        contents: [{ parts: [{ text: userPrompt }] }],\r\n        systemInstruction: { parts: [{ text: systemPrompt }] },\r\n        tools: [\r\n          {\r\n            googleSearch: {}, // Enable grounding\r\n          },\r\n        ],\r\n        generationConfig: {\r\n          temperature: temperature,\r\n          maxOutputTokens: 8192,\r\n        },\r\n      };\r\n\r\n      console.log(\"[DEBUG] Payload prepared, calling fetch...\");\r\n\r\n      const response = await fetch(url, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(payload),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorText = await response.text();\r\n        console.error(\r\n          `[ERROR] Gemini API failed: ${response.status} ${response.statusText}`,\r\n          errorText\r\n        );\r\n        throw new Error(\r\n          `Gemini API error: ${response.status} ${response.statusText}`\r\n        );\r\n      }\r\n\r\n      const responseData = await response.json();\r\n      const generatedText =\r\n        responseData.candidates?.[0]?.content?.parts?.[0]?.text;\r\n      const sources = extractGroundingSources(responseData);\r\n\r\n      if (!generatedText) {\r\n        console.error(\r\n          \"[ERROR] No content in Gemini response:\",\r\n          JSON.stringify(responseData)\r\n        );\r\n        throw new Error(\"No content generated from Gemini\");\r\n      }\r\n\r\n      // Log usage\r\n      await logApiUsage(userId, {\r\n        model: model,\r\n        type: \"generation\",\r\n      });\r\n\r\n      return {\r\n        success: true,\r\n        textResponse: generatedText,\r\n        groundingSources: sources,\r\n      };\r\n    } catch (error) {\r\n      console.error(\"[ERROR] Error details:\", JSON.stringify(error, null, 2));\r\n      throw new functions.https.HttpsError(\r\n        \"internal\",\r\n        `Failed to generate questions: ${error.message}`\r\n      );\r\n    }\r\n  });\r\n\r\n/**\r\n * Cloud Function: generateCritique\r\n * Securely calls Gemini API for question critique\r\n */\r\nexports.generateCritique = functions\r\n  .runWith({\r\n    secrets: [\"GEMINI_API_KEY\"],\r\n    timeoutSeconds: 60,\r\n    memory: \"256MB\",\r\n  })\r\n  .https.onCall(async (data, context) => {\r\n    // Authentication check\r\n    if (!context.auth) {\r\n      throw new functions.https.HttpsError(\r\n        \"unauthenticated\",\r\n        \"User must be authenticated.\"\r\n      );\r\n    }\r\n\r\n    const userId = context.auth.uid;\r\n    const { question, options, correct, modeLabel } = data;\r\n\r\n    // Input validation\r\n    if (!question || !options || !correct) {\r\n      throw new functions.https.HttpsError(\r\n        \"invalid-argument\",\r\n        \"question, options, and correct are required.\"\r\n      );\r\n    }\r\n\r\n    // Rate limiting\r\n    const rateLimitCheck = await checkRateLimit(userId, \"critique\");\r\n    if (!rateLimitCheck.allowed) {\r\n      throw new functions.https.HttpsError(\r\n        \"resource-exhausted\",\r\n        `Rate limit exceeded. ${rateLimitCheck.message}`\r\n      );\r\n    }\r\n\r\n    try {\r\n      let apiKey = process.env.GEMINI_API_KEY;\r\n\r\n      if (!apiKey) {\r\n        try {\r\n          apiKey = functions.config().gemini?.api_key;\r\n        } catch (configError) {\r\n          // Ignore functions.config() errors\r\n        }\r\n      }\r\n\r\n      if (!apiKey) {\r\n        throw new functions.https.HttpsError(\r\n          \"failed-precondition\",\r\n          \"Gemini API key not configured.\"\r\n        );\r\n      }\r\n\r\n      // Build critique prompt - Balanced and constructive evaluation\r\n      const systemPrompt =\r\n        \"Expert UE5 Technical Reviewer. Output valid JSON only. Evaluate objectively and provide constructive feedback.\";\r\n\r\n      let strictnessInstruction = \"\";\r\n      if (modeLabel === \"Strict\") {\r\n        strictnessInstruction = `\r\n            CONTEXT: The user requested a STRICT, FOUNDATIONAL question. \r\n            - If this is obscure, tricky, or niche: DEDUCT 20 POINTS. \r\n            - If it has multiple valid workflows (ambiguous) without context: DEDUCT 30 POINTS.\r\n            - Must be textbook quality.`;\r\n      } else if (modeLabel === \"Wild\") {\r\n        strictnessInstruction = `\r\n            CONTEXT: The user requested a WILD, EDGE-CASE question. \r\n            - If this is basic or obvious (\"Documentation 101\"): DEDUCT 20 POINTS.\r\n            - Must be challenging and specific.`;\r\n      }\r\n\r\n      const userPrompt = `Evaluate this UE5 question as a Senior Technical Reviewer for a professional certification exam.\r\n        ${strictnessInstruction}\r\n        \r\n        **SCORING GUIDELINES:** Score based on ACTUAL quality. Use the FULL 0-100 range appropriately:\r\n        - 90-100: Excellent - Clear, accurate, well-written, strong distractors, verifiable source\r\n        - 80-89: Good - Minor issues but professionally acceptable\r\n        - 70-79: Acceptable - Needs polish but fundamentally sound\r\n        - 60-69: Needs Work - Multiple issues requiring revision\r\n        - Below 60: Poor - Major problems with accuracy, clarity, or structure\r\n        \r\n        **EVALUATION CRITERIA:**\r\n        1. Technical Accuracy: Is the answer factually correct for UE5?\r\n        2. Clarity: Is the question clear and unambiguous?\r\n        3. Distractors: Are wrong answers plausible but definitively incorrect?\r\n        4. Professional Tone: Is it suitable for certification/interview use?\r\n        5. Source Quality: Can the answer be verified from official documentation?\r\n        \r\n        MANDATORY OUTPUT FORMAT: Return ONLY a raw JSON object (no markdown formatting) with this structure:\r\n        {\r\n            \"score\": number, // 0-100 (Integer only) - Use the FULL range appropriately\r\n            \"critique\": \"string\", // Detailed feedback with specific suggestions\r\n            \"rewrite\": {\r\n                \"question\": \"string\", // Improved question text\r\n                \"options\": { \"A\": \"...\", \"B\": \"...\", \"C\": \"...\", \"D\": \"...\" },\r\n                \"correct\": \"string\" // Correct letter (A, B, C, or D)\r\n            },\r\n            \"changes\": \"string\" // Brief explanation of what was changed and why\r\n        }\r\n\r\n        Question: ${question}\r\n        Options: ${JSON.stringify(options)}\r\n        Correct: ${correct}`;\r\n\r\n      const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent?key=${apiKey}`;\r\n\r\n      const response = await fetch(url, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          contents: [{ parts: [{ text: userPrompt }] }],\r\n          systemInstruction: { parts: [{ text: systemPrompt }] },\r\n          generationConfig: {\r\n            temperature: 0.2,\r\n            maxOutputTokens: 8192,\r\n            responseMimeType: \"application/json\",\r\n          },\r\n        }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`API error: ${response.statusText}`);\r\n      }\r\n\r\n      const responseData = await response.json();\r\n      const rawText =\r\n        responseData.candidates?.[0]?.content?.parts?.[0]?.text || \"\";\r\n\r\n      // Parse JSON response\r\n      let result;\r\n      try {\r\n        const cleanJson = rawText.replace(/```json\\n?|\\n?```/g, \"\").trim();\r\n        result = JSON.parse(cleanJson);\r\n      } catch {\r\n        // Fallback: extract score if JSON parsing fails\r\n        // Try multiple patterns to extract score (Robust Fallback)\r\n        let score = null;\r\n        const patterns = [\r\n          /SCORE:\\s*(\\d+)/i, // SCORE: 75\r\n          /\"score\"\\s*:\\s*(\\d+)/i, // \"score\": 75\r\n          /\\bscore\\s*[:\\-=]\\s*(\\d+)/i, // score: 75, score = 75\r\n          /(\\d+)\\s*\\/\\s*100/i, // 75/100\r\n          /^(\\d{1,3})(?!\\d)/m, // Just a number at start of line (0-999)\r\n        ];\r\n\r\n        for (const pattern of patterns) {\r\n          const match = rawText.match(pattern);\r\n          if (match) {\r\n            const parsed = parseInt(match[1]);\r\n            if (parsed >= 0 && parsed <= 100) {\r\n              score = parsed;\r\n              break;\r\n            }\r\n          }\r\n        }\r\n\r\n        result = {\r\n          score: score !== null ? score : 0, // Default to 0 to signal failure/review needed\r\n          critique: rawText,\r\n          rewrite: null,\r\n          changes: null,\r\n        };\r\n      }\r\n\r\n      // Log usage\r\n      await logApiUsage(userId, {\r\n        model: \"gemini-2.0-flash-exp\",\r\n        type: \"critique\",\r\n        timestamp: admin.firestore.FieldValue.serverTimestamp(),\r\n      });\r\n\r\n      return {\r\n        success: true,\r\n        score: result.score,\r\n        text: result.critique || result.text,\r\n        rewrite: result.rewrite,\r\n        changes: result.changes,\r\n      };\r\n    } catch (error) {\r\n      console.error(\"Error in generateCritique:\", error);\r\n      throw new functions.https.HttpsError(\r\n        \"internal\",\r\n        `Failed to generate critique: ${error.message}`\r\n      );\r\n    }\r\n  });\r\n\r\n/**\r\n * Rate limiting helper\r\n * Checks if user has exceeded rate limits\r\n */\r\nasync function checkRateLimit(userId, type = \"generation\") {\r\n  const db = admin.firestore();\r\n  const now = Date.now();\r\n  const oneMinuteAgo = now - 60 * 1000;\r\n\r\n  // Get user's recent API calls\r\n  const recentCalls = await db\r\n    .collection(\"apiUsage\")\r\n    .where(\"userId\", \"==\", userId)\r\n    .where(\"timestamp\", \">\", new Date(oneMinuteAgo))\r\n    .get();\r\n\r\n  const callCount = recentCalls.size;\r\n\r\n  // Rate limits (adjust as needed)\r\n  const RATE_LIMITS = {\r\n    generation: 10, // 10 requests per minute\r\n    critique: 20, // 20 critiques per minute\r\n  };\r\n\r\n  const limit = RATE_LIMITS[type] || 10;\r\n\r\n  if (callCount >= limit) {\r\n    return {\r\n      allowed: false,\r\n      message: `You can make ${limit} ${type} requests per minute. Please wait.`,\r\n    };\r\n  }\r\n\r\n  return { allowed: true };\r\n}\r\n\r\n/**\r\n * Log API usage for rate limiting and analytics\r\n */\r\nasync function logApiUsage(userId, data) {\r\n  const db = admin.firestore();\r\n  await db.collection(\"apiUsage\").add({\r\n    userId,\r\n    ...data,\r\n    timestamp: admin.firestore.FieldValue.serverTimestamp(),\r\n  });\r\n}\r\n\r\nfunction extractGroundingSources(responseData) {\r\n  const groundingMetadata = responseData.candidates?.[0]?.groundingMetadata;\r\n  const sources = [];\r\n\r\n  if (groundingMetadata?.groundingChunks) {\r\n    groundingMetadata.groundingChunks.forEach((chunk) => {\r\n      if (chunk.web?.uri && chunk.web?.title) {\r\n        const url = chunk.web.uri.toLowerCase();\r\n\r\n        // Only accept Epic Games documentation\r\n        if (url.includes(\"dev.epicgames.com/documentation\")) {\r\n          sources.push({\r\n            url: chunk.web.uri,\r\n            title: chunk.web.title,\r\n          });\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  return sources;\r\n}\r\n\r\n// ============================================================================\r\n// INVITE SYSTEM - Secure Registration with Invite Codes\r\n// ============================================================================\r\n\r\nconst crypto = require(\"crypto\");\r\n\r\n/**\r\n * Check if a user is an admin (from Firestore admins collection)\r\n * @param {string} uid - User ID\r\n * @returns {Promise<boolean>}\r\n */\r\nasync function isAdminUser(uid) {\r\n  if (!uid) return false;\r\n  try {\r\n    const adminDoc = await admin\r\n      .firestore()\r\n      .collection(\"admins\")\r\n      .doc(uid)\r\n      .get();\r\n    return adminDoc.exists && adminDoc.data()?.isAdmin === true;\r\n  } catch (error) {\r\n    console.error(\"Error checking admin status:\", error);\r\n    return false;\r\n  }\r\n}\r\n\r\n/**\r\n * Cloud Function: validateInvite\r\n * Validates an invite code server-side with rate limiting\r\n * Does NOT require authentication (pre-signup validation)\r\n */\r\nexports.validateInvite = functions\r\n  .runWith({ timeoutSeconds: 30, memory: \"256MB\" })\r\n  .https.onCall(async (data, context) => {\r\n    const { code } = data;\r\n    const db = admin.firestore();\r\n\r\n    // === INPUT SANITIZATION ===\r\n    if (!code || typeof code !== \"string\") {\r\n      throw new functions.https.HttpsError(\r\n        \"invalid-argument\",\r\n        \"Invite code is required\"\r\n      );\r\n    }\r\n\r\n    // Sanitize: alphanumeric only, max 16 chars\r\n    const sanitizedCode = code\r\n      .replace(/[^A-Za-z0-9]/g, \"\")\r\n      .substring(0, 16)\r\n      .toUpperCase();\r\n\r\n    if (sanitizedCode.length < 8) {\r\n      throw new functions.https.HttpsError(\r\n        \"invalid-argument\",\r\n        \"Invalid invite code format\"\r\n      );\r\n    }\r\n\r\n    // === RATE LIMITING ===\r\n    // TESTING: Set to true to enable rate limiting\r\n    const ENABLE_RATE_LIMIT = false;\r\n\r\n    // Use a hash of the request IP or a session identifier\r\n    const clientId =\r\n      context.rawRequest?.ip ||\r\n      context.rawRequest?.headers?.[\"x-forwarded-for\"] ||\r\n      \"unknown\";\r\n    const rateLimitRef = db\r\n      .collection(\"inviteAttempts\")\r\n      .doc(clientId.replace(/[^a-zA-Z0-9]/g, \"_\"));\r\n\r\n    try {\r\n      if (ENABLE_RATE_LIMIT) {\r\n        const rateLimitDoc = await rateLimitRef.get();\r\n\r\n        if (rateLimitDoc.exists) {\r\n          const rateData = rateLimitDoc.data();\r\n\r\n          // Check if locked out\r\n          if (\r\n            rateData.lockedUntil &&\r\n            rateData.lockedUntil.toDate() > new Date()\r\n          ) {\r\n            const remainingMins = Math.ceil(\r\n              (rateData.lockedUntil.toDate() - new Date()) / 60000\r\n            );\r\n            throw new functions.https.HttpsError(\r\n              \"resource-exhausted\",\r\n              `Too many failed attempts. Try again in ${remainingMins} minutes.`\r\n            );\r\n          }\r\n\r\n          // Check if too many recent attempts\r\n          if (rateData.attempts >= 5) {\r\n            // Lock for 1 hour\r\n            await rateLimitRef.update({\r\n              lockedUntil: admin.firestore.Timestamp.fromDate(\r\n                new Date(Date.now() + 60 * 60 * 1000)\r\n              ),\r\n            });\r\n            throw new functions.https.HttpsError(\r\n              \"resource-exhausted\",\r\n              \"Too many failed attempts. Locked for 1 hour.\"\r\n            );\r\n          }\r\n        }\r\n      }\r\n\r\n      // === VALIDATE INVITE CODE ===\r\n      const inviteRef = db.collection(\"invites\").doc(sanitizedCode);\r\n      const inviteDoc = await inviteRef.get();\r\n\r\n      if (!inviteDoc.exists) {\r\n        // Increment failed attempts\r\n        await rateLimitRef.set(\r\n          {\r\n            attempts: admin.firestore.FieldValue.increment(1),\r\n            lastAttempt: admin.firestore.Timestamp.now(),\r\n          },\r\n          { merge: true }\r\n        );\r\n        throw new functions.https.HttpsError(\r\n          \"not-found\",\r\n          \"Invalid invite code\"\r\n        );\r\n      }\r\n\r\n      const invite = inviteDoc.data();\r\n\r\n      // Check if active\r\n      if (!invite.isActive) {\r\n        throw new functions.https.HttpsError(\r\n          \"failed-precondition\",\r\n          \"This invite has been revoked\"\r\n        );\r\n      }\r\n\r\n      // Check expiration\r\n      if (invite.expiresAt && invite.expiresAt.toDate() < new Date()) {\r\n        throw new functions.https.HttpsError(\r\n          \"failed-precondition\",\r\n          \"This invite has expired\"\r\n        );\r\n      }\r\n\r\n      // Check usage limit\r\n      if (invite.maxUses !== -1 && invite.currentUses >= invite.maxUses) {\r\n        throw new functions.https.HttpsError(\r\n          \"failed-precondition\",\r\n          \"This invite has reached its usage limit\"\r\n        );\r\n      }\r\n\r\n      // === SUCCESS - Clear rate limit ===\r\n      await rateLimitRef.delete();\r\n\r\n      return {\r\n        valid: true,\r\n        role: invite.role || \"user\",\r\n        expiresAt: invite.expiresAt\r\n          ? invite.expiresAt.toDate().toISOString()\r\n          : null,\r\n        remainingUses:\r\n          invite.maxUses === -1\r\n            ? \"unlimited\"\r\n            : invite.maxUses - invite.currentUses,\r\n      };\r\n    } catch (error) {\r\n      if (error instanceof functions.https.HttpsError) {\r\n        throw error;\r\n      }\r\n      console.error(\"Error validating invite:\", error);\r\n      throw new functions.https.HttpsError(\r\n        \"internal\",\r\n        \"Failed to validate invite\"\r\n      );\r\n    }\r\n  });\r\n\r\n/**\r\n * Cloud Function: consumeInvite\r\n * Marks an invite as used after successful authentication\r\n * REQUIRES authentication\r\n */\r\nexports.consumeInvite = functions\r\n  .runWith({ timeoutSeconds: 30, memory: \"256MB\" })\r\n  .https.onCall(async (data, context) => {\r\n    // MUST be authenticated\r\n    if (!context.auth) {\r\n      throw new functions.https.HttpsError(\r\n        \"unauthenticated\",\r\n        \"Must be signed in to use invite\"\r\n      );\r\n    }\r\n\r\n    const { code } = data;\r\n    const userEmail = context.auth.token.email;\r\n    const userId = context.auth.uid;\r\n    const db = admin.firestore();\r\n\r\n    // Sanitize code\r\n    const sanitizedCode = (code || \"\")\r\n      .replace(/[^A-Za-z0-9]/g, \"\")\r\n      .substring(0, 16)\r\n      .toUpperCase();\r\n\r\n    if (!sanitizedCode) {\r\n      throw new functions.https.HttpsError(\r\n        \"invalid-argument\",\r\n        \"Invite code is required\"\r\n      );\r\n    }\r\n\r\n    try {\r\n      const inviteRef = db.collection(\"invites\").doc(sanitizedCode);\r\n      const inviteDoc = await inviteRef.get();\r\n\r\n      if (!inviteDoc.exists) {\r\n        throw new functions.https.HttpsError(\r\n          \"not-found\",\r\n          \"Invalid invite code\"\r\n        );\r\n      }\r\n\r\n      const invite = inviteDoc.data();\r\n\r\n      // Check if already used by this user\r\n      const alreadyUsed = invite.usedBy?.some(\r\n        (u) => u.email === userEmail || u.uid === userId\r\n      );\r\n      if (alreadyUsed) {\r\n        return { success: true, alreadyUsed: true, role: invite.role };\r\n      }\r\n\r\n      // Validate invite is still valid\r\n      if (!invite.isActive) {\r\n        throw new functions.https.HttpsError(\r\n          \"failed-precondition\",\r\n          \"Invite has been revoked\"\r\n        );\r\n      }\r\n      if (invite.expiresAt && invite.expiresAt.toDate() < new Date()) {\r\n        throw new functions.https.HttpsError(\r\n          \"failed-precondition\",\r\n          \"Invite has expired\"\r\n        );\r\n      }\r\n      if (invite.maxUses !== -1 && invite.currentUses >= invite.maxUses) {\r\n        throw new functions.https.HttpsError(\r\n          \"failed-precondition\",\r\n          \"Invite limit reached\"\r\n        );\r\n      }\r\n\r\n      // Update invite usage\r\n      await inviteRef.update({\r\n        currentUses: admin.firestore.FieldValue.increment(1),\r\n        usedBy: admin.firestore.FieldValue.arrayUnion({\r\n          email: userEmail,\r\n          uid: userId,\r\n          usedAt: admin.firestore.Timestamp.now(),\r\n        }),\r\n      });\r\n\r\n      // Mark user as registered (for future access checks)\r\n      await db\r\n        .collection(\"registeredUsers\")\r\n        .doc(userId)\r\n        .set(\r\n          {\r\n            email: userEmail,\r\n            uid: userId,\r\n            inviteCode: sanitizedCode,\r\n            role: invite.role || \"user\",\r\n            registeredAt: admin.firestore.Timestamp.now(),\r\n          },\r\n          { merge: true }\r\n        );\r\n\r\n      console.log(`Invite ${sanitizedCode} consumed by ${userEmail}`);\r\n\r\n      return { success: true, role: invite.role || \"user\" };\r\n    } catch (error) {\r\n      if (error instanceof functions.https.HttpsError) {\r\n        throw error;\r\n      }\r\n      console.error(\"Error consuming invite:\", error);\r\n      throw new functions.https.HttpsError(\r\n        \"internal\",\r\n        \"Failed to consume invite\"\r\n      );\r\n    }\r\n  });\r\n\r\n/**\r\n * Cloud Function: createInvite\r\n * Creates a new invite code (ADMIN ONLY)\r\n */\r\nexports.createInvite = functions\r\n  .runWith({ timeoutSeconds: 30, memory: \"256MB\" })\r\n  .https.onCall(async (data, context) => {\r\n    // ADMIN CHECK\r\n    if (!context.auth) {\r\n      throw new functions.https.HttpsError(\r\n        \"unauthenticated\",\r\n        \"Must be signed in\"\r\n      );\r\n    }\r\n\r\n    const isAdmin = await isAdminUser(context.auth.uid);\r\n    if (!isAdmin) {\r\n      throw new functions.https.HttpsError(\r\n        \"permission-denied\",\r\n        \"Admin access required\"\r\n      );\r\n    }\r\n\r\n    const { maxUses = 1, expiresInDays = 7, role = \"user\", note = \"\" } = data;\r\n    const db = admin.firestore();\r\n\r\n    try {\r\n      // Generate cryptographically secure code\r\n      const code = crypto\r\n        .randomBytes(9)\r\n        .toString(\"base64\")\r\n        .replace(/[^A-Za-z0-9]/g, \"\")\r\n        .substring(0, 12)\r\n        .toUpperCase();\r\n\r\n      // Calculate expiration (max 30 days)\r\n      const expiresAt = new Date();\r\n      expiresAt.setDate(\r\n        expiresAt.getDate() + Math.min(Math.max(expiresInDays, 1), 30)\r\n      );\r\n\r\n      const inviteData = {\r\n        code,\r\n        createdBy: context.auth.uid,\r\n        createdByEmail: context.auth.token.email,\r\n        createdAt: admin.firestore.Timestamp.now(),\r\n        expiresAt: admin.firestore.Timestamp.fromDate(expiresAt),\r\n        maxUses: maxUses === -1 ? -1 : Math.max(1, maxUses),\r\n        currentUses: 0,\r\n        usedBy: [],\r\n        role: role === \"admin\" ? \"admin\" : \"user\",\r\n        isActive: true,\r\n        note: (note || \"\").substring(0, 200), // Limit note length\r\n      };\r\n\r\n      await db.collection(\"invites\").doc(code).set(inviteData);\r\n\r\n      console.log(`Invite ${code} created by ${context.auth.token.email}`);\r\n\r\n      return {\r\n        success: true,\r\n        code,\r\n        inviteUrl: `https://samdeiter.github.io/UE5QuestionGenerator/?invite=${code}`,\r\n        expiresAt: expiresAt.toISOString(),\r\n        maxUses: inviteData.maxUses,\r\n      };\r\n    } catch (error) {\r\n      console.error(\"Error creating invite:\", error);\r\n      throw new functions.https.HttpsError(\r\n        \"internal\",\r\n        \"Failed to create invite\"\r\n      );\r\n    }\r\n  });\r\n\r\n/**\r\n * Cloud Function: revokeInvite\r\n * Revokes an existing invite code (ADMIN ONLY)\r\n */\r\nexports.revokeInvite = functions\r\n  .runWith({ timeoutSeconds: 30, memory: \"256MB\" })\r\n  .https.onCall(async (data, context) => {\r\n    // ADMIN CHECK\r\n    if (!context.auth) {\r\n      throw new functions.https.HttpsError(\r\n        \"unauthenticated\",\r\n        \"Must be signed in\"\r\n      );\r\n    }\r\n\r\n    const isAdmin = await isAdminUser(context.auth.uid);\r\n    if (!isAdmin) {\r\n      throw new functions.https.HttpsError(\r\n        \"permission-denied\",\r\n        \"Admin access required\"\r\n      );\r\n    }\r\n\r\n    const { code } = data;\r\n    const db = admin.firestore();\r\n\r\n    const sanitizedCode = (code || \"\")\r\n      .replace(/[^A-Za-z0-9]/g, \"\")\r\n      .substring(0, 16)\r\n      .toUpperCase();\r\n\r\n    if (!sanitizedCode) {\r\n      throw new functions.https.HttpsError(\r\n        \"invalid-argument\",\r\n        \"Invite code is required\"\r\n      );\r\n    }\r\n\r\n    try {\r\n      const inviteRef = db.collection(\"invites\").doc(sanitizedCode);\r\n      const inviteDoc = await inviteRef.get();\r\n\r\n      if (!inviteDoc.exists) {\r\n        throw new functions.https.HttpsError(\"not-found\", \"Invite not found\");\r\n      }\r\n\r\n      await inviteRef.update({\r\n        isActive: false,\r\n        revokedAt: admin.firestore.Timestamp.now(),\r\n        revokedBy: context.auth.uid,\r\n      });\r\n\r\n      console.log(\r\n        `Invite ${sanitizedCode} revoked by ${context.auth.token.email}`\r\n      );\r\n\r\n      return { success: true };\r\n    } catch (error) {\r\n      if (error instanceof functions.https.HttpsError) {\r\n        throw error;\r\n      }\r\n      console.error(\"Error revoking invite:\", error);\r\n      throw new functions.https.HttpsError(\r\n        \"internal\",\r\n        \"Failed to revoke invite\"\r\n      );\r\n    }\r\n  });\r\n\r\n/**\r\n * Cloud Function: checkUserRegistration\r\n * Checks if a user is registered (has used a valid invite)\r\n */\r\nexports.checkUserRegistration = functions\r\n  .runWith({ timeoutSeconds: 15, memory: \"128MB\" })\r\n  .https.onCall(async (data, context) => {\r\n    if (!context.auth) {\r\n      return { registered: false };\r\n    }\r\n\r\n    const db = admin.firestore();\r\n    const userId = context.auth.uid;\r\n\r\n    try {\r\n      const userDoc = await db.collection(\"registeredUsers\").doc(userId).get();\r\n\r\n      if (userDoc.exists) {\r\n        const userData = userDoc.data();\r\n        return {\r\n          registered: true,\r\n          role: userData.role || \"user\",\r\n          registeredAt: userData.registeredAt?.toDate()?.toISOString(),\r\n        };\r\n      }\r\n\r\n      // Also check if user is an admin (admins don't need invites)\r\n      const isAdmin = await isAdminUser(userId);\r\n      if (isAdmin) {\r\n        return { registered: true, role: \"admin\" };\r\n      }\r\n\r\n      return { registered: false };\r\n    } catch (error) {\r\n      console.error(\"Error checking registration:\", error);\r\n      return { registered: false };\r\n    }\r\n  });\r\n\r\n/**\r\n * Cloud Function: setupInitialAdmin\r\n * One-time setup function to add initial admin user\r\n * Can only be called by the specified email\r\n */\r\nexports.setupInitialAdmin = functions\r\n  .runWith({ timeoutSeconds: 30, memory: \"128MB\" })\r\n  .https.onCall(async (data, context) => {\r\n    // Must be authenticated\r\n    if (!context.auth) {\r\n      throw new functions.https.HttpsError(\r\n        \"unauthenticated\",\r\n        \"Must be signed in\"\r\n      );\r\n    }\r\n\r\n    const userEmail = context.auth.token.email;\r\n    const userId = context.auth.uid;\r\n    const db = admin.firestore();\r\n\r\n    // Only allow specific emails to become initial admin\r\n    const ALLOWED_INITIAL_ADMINS = [\r\n      \"sam.deiter@epicgames.com\",\r\n      \"samdeiter@gmail.com\",\r\n    ];\r\n\r\n    if (!ALLOWED_INITIAL_ADMINS.includes(userEmail.toLowerCase())) {\r\n      throw new functions.https.HttpsError(\r\n        \"permission-denied\",\r\n        \"Not authorized for initial admin setup\"\r\n      );\r\n    }\r\n\r\n    try {\r\n      // Add to admins collection\r\n      await db.collection(\"admins\").doc(userId).set({\r\n        email: userEmail,\r\n        isAdmin: true,\r\n        createdAt: admin.firestore.Timestamp.now(),\r\n        createdBy: \"setupInitialAdmin\",\r\n      });\r\n\r\n      // Add to registeredUsers collection\r\n      await db.collection(\"registeredUsers\").doc(userId).set(\r\n        {\r\n          email: userEmail,\r\n          uid: userId,\r\n          role: \"admin\",\r\n          registeredAt: admin.firestore.Timestamp.now(),\r\n          inviteCode: \"INITIAL_ADMIN_SETUP\",\r\n        },\r\n        { merge: true }\r\n      );\r\n\r\n      console.log(`Initial admin setup complete for ${userEmail}`);\r\n\r\n      return {\r\n        success: true,\r\n        message: `${userEmail} is now an admin`,\r\n        role: \"admin\",\r\n      };\r\n    } catch (error) {\r\n      console.error(\"Error in setupInitialAdmin:\", error);\r\n      throw new functions.https.HttpsError(\"internal\", \"Failed to setup admin\");\r\n    }\r\n  });\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\functions\\test\\invite.test.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'adminMock' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":11,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"adminMock"},"fix":{"range":[267,791],"text":""},"desc":"Remove unused variable 'adminMock'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'name' is defined but never used. Allowed unused args must match /^_/u.","line":13,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"name"},"fix":{"range":[326,330],"text":""},"desc":"Remove unused variable 'name'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'id' is defined but never used. Allowed unused args must match /^_/u.","line":14,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"id"},"fix":{"range":[350,352],"text":""},"desc":"Remove unused variable 'id'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Invite System Cloud Functions - Unit Tests\n *\n * Following TESTING FIRST rule from .agent/rules/testing-security-policy.md\n * These tests verify the invite system security and functionality.\n */\n\nconst { expect } = require(\"chai\");\n\n// Mock Firebase Admin SDK\nconst adminMock = {\n  firestore: () => ({\n    collection: (name) => ({\n      doc: (id) => ({\n        get: async () => ({ exists: false, data: () => null }),\n        set: async () => {},\n        update: async () => {},\n        delete: async () => {},\n      }),\n    }),\n    FieldValue: {\n      increment: (n) => n,\n      arrayUnion: (item) => [item],\n      serverTimestamp: () => new Date(),\n    },\n    Timestamp: {\n      now: () => ({ toDate: () => new Date() }),\n      fromDate: (d) => ({ toDate: () => d }),\n    },\n  }),\n};\n\n// Test data\nconst validInviteData = {\n  code: \"ABC123XYZ789\",\n  isActive: true,\n  expiresAt: { toDate: () => new Date(Date.now() + 86400000) }, // Tomorrow\n  maxUses: 5,\n  currentUses: 0,\n  usedBy: [],\n  role: \"user\",\n};\n\nconst expiredInviteData = {\n  ...validInviteData,\n  expiresAt: { toDate: () => new Date(Date.now() - 86400000) }, // Yesterday\n};\n\nconst revokedInviteData = {\n  ...validInviteData,\n  isActive: false,\n};\n\nconst maxedOutInviteData = {\n  ...validInviteData,\n  currentUses: 5,\n};\n\ndescribe(\"Invite System Cloud Functions\", () => {\n  describe(\"Input Sanitization\", () => {\n    it(\"should reject codes with special characters\", () => {\n      const maliciousCode = '<script>alert(\"xss\")</script>';\n      const sanitized = maliciousCode\n        .replace(/[^A-Za-z0-9]/g, \"\")\n        .substring(0, 16)\n        .toUpperCase();\n      expect(sanitized).to.equal(\"SCRIPTALERTXSSSCRIPT\".substring(0, 16));\n      expect(sanitized).to.not.include(\"<\");\n      expect(sanitized).to.not.include(\">\");\n    });\n\n    it(\"should uppercase all codes for consistency\", () => {\n      const mixedCase = \"abc123XYZ789\";\n      const sanitized = mixedCase\n        .replace(/[^A-Za-z0-9]/g, \"\")\n        .substring(0, 16)\n        .toUpperCase();\n      expect(sanitized).to.equal(\"ABC123XYZ789\");\n    });\n\n    it(\"should limit code length to 16 characters\", () => {\n      const longCode = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ123456\";\n      const sanitized = longCode.substring(0, 16);\n      expect(sanitized.length).to.equal(16);\n    });\n\n    it(\"should reject codes shorter than 8 characters\", () => {\n      const shortCode = \"ABC123\";\n      const isValid = shortCode.length >= 8;\n      expect(isValid).to.be.false;\n    });\n\n    it(\"should reject SQL injection attempts\", () => {\n      const sqlInjection = \"'; DROP TABLE invites; --\";\n      const sanitized = sqlInjection\n        .replace(/[^A-Za-z0-9]/g, \"\")\n        .substring(0, 16)\n        .toUpperCase();\n      expect(sanitized).to.equal(\"DROPTABLEINVITES\");\n      expect(sanitized).to.not.include(\"'\");\n      expect(sanitized).to.not.include(\";\");\n    });\n  });\n\n  describe(\"Invite Validation Logic\", () => {\n    it(\"should accept valid, active, unexpired invites\", () => {\n      const invite = validInviteData;\n      const isValid =\n        invite.isActive &&\n        invite.expiresAt.toDate() > new Date() &&\n        (invite.maxUses === -1 || invite.currentUses < invite.maxUses);\n      expect(isValid).to.be.true;\n    });\n\n    it(\"should reject expired invites\", () => {\n      const invite = expiredInviteData;\n      const isExpired = invite.expiresAt.toDate() < new Date();\n      expect(isExpired).to.be.true;\n    });\n\n    it(\"should reject revoked invites\", () => {\n      const invite = revokedInviteData;\n      expect(invite.isActive).to.be.false;\n    });\n\n    it(\"should reject maxed-out invites\", () => {\n      const invite = maxedOutInviteData;\n      const hasUsesRemaining =\n        invite.maxUses === -1 || invite.currentUses < invite.maxUses;\n      expect(hasUsesRemaining).to.be.false;\n    });\n\n    it(\"should allow unlimited uses when maxUses is -1\", () => {\n      const unlimitedInvite = {\n        ...validInviteData,\n        maxUses: -1,\n        currentUses: 1000,\n      };\n      const hasUsesRemaining =\n        unlimitedInvite.maxUses === -1 ||\n        unlimitedInvite.currentUses < unlimitedInvite.maxUses;\n      expect(hasUsesRemaining).to.be.true;\n    });\n  });\n\n  describe(\"Rate Limiting Logic\", () => {\n    it(\"should lock out after 5 failed attempts\", () => {\n      const attempts = 5;\n      const shouldLock = attempts >= 5;\n      expect(shouldLock).to.be.true;\n    });\n\n    it(\"should calculate lockout duration correctly\", () => {\n      const lockDurationMs = 60 * 60 * 1000; // 1 hour\n      const lockedUntil = new Date(Date.now() + lockDurationMs);\n      const remainingMins = Math.ceil((lockedUntil - new Date()) / 60000);\n      expect(remainingMins).to.be.approximately(60, 1);\n    });\n\n    it(\"should clear rate limit on successful validation\", () => {\n      // After successful validation, attempts should reset\n      const attemptsAfterSuccess = 0;\n      expect(attemptsAfterSuccess).to.equal(0);\n    });\n  });\n\n  describe(\"Cryptographic Code Generation\", () => {\n    it(\"should generate 12-character codes\", () => {\n      // Simulate crypto.randomBytes(9).toString('base64').replace(...).substring(0, 12)\n      const mockBase64 = \"ABC123XYZ789abc\";\n      const code = mockBase64\n        .replace(/[^A-Za-z0-9]/g, \"\")\n        .substring(0, 12)\n        .toUpperCase();\n      expect(code.length).to.equal(12);\n    });\n\n    it(\"should generate unique codes\", () => {\n      // Simulate generating 100 codes and checking uniqueness\n      const codes = new Set();\n      for (let i = 0; i < 100; i++) {\n        // Mock random bytes - in reality, crypto.randomBytes ensures uniqueness\n        const mockCode = `CODE${String(i).padStart(8, \"0\")}`;\n        codes.add(mockCode);\n      }\n      expect(codes.size).to.equal(100);\n    });\n\n    it(\"should only contain alphanumeric characters\", () => {\n      const code = \"ABC123XYZ789\";\n      const isAlphanumeric = /^[A-Z0-9]+$/.test(code);\n      expect(isAlphanumeric).to.be.true;\n    });\n  });\n\n  describe(\"Admin Authorization\", () => {\n    it(\"should require authentication for admin actions\", () => {\n      const context = { auth: null };\n      const isAuthenticated = !!context.auth;\n      expect(isAuthenticated).to.be.false;\n    });\n\n    it(\"should verify admin status from Firestore\", async () => {\n      // Mock admin check\n      const mockAdminDoc = { exists: true, data: () => ({ isAdmin: true }) };\n      const isAdmin =\n        mockAdminDoc.exists && mockAdminDoc.data()?.isAdmin === true;\n      expect(isAdmin).to.be.true;\n    });\n\n    it(\"should reject non-admin users for createInvite\", async () => {\n      const mockNonAdminDoc = {\n        exists: true,\n        data: () => ({ isAdmin: false }),\n      };\n      const isAdmin =\n        mockNonAdminDoc.exists && mockNonAdminDoc.data()?.isAdmin === true;\n      expect(isAdmin).to.be.false;\n    });\n\n    it(\"should reject users not in admins collection\", async () => {\n      const mockMissingDoc = { exists: false, data: () => null };\n      const isAdmin =\n        mockMissingDoc.exists && mockMissingDoc.data()?.isAdmin === true;\n      expect(isAdmin).to.be.false;\n    });\n  });\n\n  describe(\"Consume Invite Logic\", () => {\n    it(\"should prevent duplicate consumption by same user\", () => {\n      const invite = {\n        usedBy: [{ email: \"user@example.com\", uid: \"uid123\" }],\n      };\n      const userEmail = \"user@example.com\";\n      const userId = \"uid123\";\n      const alreadyUsed = invite.usedBy?.some(\n        (u) => u.email === userEmail || u.uid === userId\n      );\n      expect(alreadyUsed).to.be.true;\n    });\n\n    it(\"should allow different users to use multi-use invite\", () => {\n      const invite = {\n        usedBy: [{ email: \"user1@example.com\", uid: \"uid1\" }],\n        maxUses: 5,\n        currentUses: 1,\n      };\n      const newUserEmail = \"user2@example.com\";\n      const newUserId = \"uid2\";\n      const alreadyUsed = invite.usedBy?.some(\n        (u) => u.email === newUserEmail || u.uid === newUserId\n      );\n      const hasUsesRemaining =\n        invite.maxUses === -1 || invite.currentUses < invite.maxUses;\n      expect(alreadyUsed).to.be.false;\n      expect(hasUsesRemaining).to.be.true;\n    });\n  });\n\n  describe(\"Expiration Enforcement\", () => {\n    it(\"should enforce maximum 30-day expiration\", () => {\n      const requestedDays = 90;\n      const enforcedDays = Math.min(Math.max(requestedDays, 1), 30);\n      expect(enforcedDays).to.equal(30);\n    });\n\n    it(\"should enforce minimum 1-day expiration\", () => {\n      const requestedDays = 0;\n      const enforcedDays = Math.min(Math.max(requestedDays, 1), 30);\n      expect(enforcedDays).to.equal(1);\n    });\n\n    it(\"should accept valid expiration within range\", () => {\n      const requestedDays = 7;\n      const enforcedDays = Math.min(Math.max(requestedDays, 1), 30);\n      expect(enforcedDays).to.equal(7);\n    });\n  });\n});\n\nconsole.log(\"Γ£à All invite system tests defined. Run with: npm test\");\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\mcp_wrapper.cjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\mcp_wrapper.js","messages":[{"ruleId":"no-undef","severity":2,"message":"'require' is not defined.","line":6,"column":19,"nodeType":"Identifier","messageId":"undef","endLine":6,"endColumn":26},{"ruleId":"no-unused-vars","severity":1,"message":"'path' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":7,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":11,"suggestions":[{"messageId":"removeVar","data":{"varName":"path"},"fix":{"range":[168,197],"text":""},"desc":"Remove unused variable 'path'."}]},{"ruleId":"no-undef","severity":2,"message":"'require' is not defined.","line":7,"column":14,"nodeType":"Identifier","messageId":"undef","endLine":7,"endColumn":21},{"ruleId":"no-undef","severity":2,"message":"'process' is not defined.","line":21,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":21,"endColumn":8},{"ruleId":"no-undef","severity":2,"message":"'process' is not defined.","line":22,"column":20,"nodeType":"Identifier","messageId":"undef","endLine":22,"endColumn":27},{"ruleId":"no-undef","severity":2,"message":"'process' is not defined.","line":26,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":26,"endColumn":10},{"ruleId":"no-undef","severity":2,"message":"'process' is not defined.","line":29,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":29,"endColumn":8},{"ruleId":"no-undef","severity":2,"message":"'process' is not defined.","line":33,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":33,"endColumn":8}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"#!/usr/bin/env node\n/**\n * Node.js wrapper for Python MCP server\n * Handles stdio properly to avoid Windows CRLF issues\n */\nconst { spawn } = require(\"child_process\");\nconst path = require(\"path\");\n\nconst pythonPath =\n  \"C:\\\\Users\\\\Sam Deiter\\\\Documents\\\\GitHub\\\\UE5QuestionGenerator\\\\.venv\\\\Scripts\\\\python.exe\";\nconst serverPath =\n  \"C:\\\\Users\\\\Sam Deiter\\\\Documents\\\\GitHub\\\\UE5QuestionGenerator\\\\optimized_performance_server.py\";\n\n// Spawn Python process with proper stdio handling\nconst python = spawn(pythonPath, [\"-u\", serverPath], {\n  stdio: [\"pipe\", \"pipe\", \"ignore\"], // stdin, stdout, stderr (ignore stderr)\n  windowsHide: true,\n});\n\n// Pipe stdin/stdout directly (Node.js handles encoding correctly)\nprocess.stdin.pipe(python.stdin);\npython.stdout.pipe(process.stdout);\n\n// Handle process termination\npython.on(\"exit\", (code) => {\n  process.exit(code || 0);\n});\n\nprocess.on(\"SIGINT\", () => {\n  python.kill(\"SIGINT\");\n});\n\nprocess.on(\"SIGTERM\", () => {\n  python.kill(\"SIGTERM\");\n});\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\App.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\__tests__\\Header.test.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\__tests__\\debug.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\__tests__\\feedbackLoop.integration.test.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\__tests__\\googleSheets.integration.test.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\__tests__\\importExport.integration.test.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\__tests__\\mocks\\gemini.mock.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\__tests__\\mocks\\googleSheets.mock.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\__tests__\\questionGeneration.integration.test.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\__tests__\\testHelpers.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\__tests__\\translation.integration.test.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\AdminInviteManager.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\AgeGateModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\AnalyticsDashboard.jsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'allAnalyticsData' conditional could make the dependencies of useMemo Hook (at line 94) change on every render. Move it inside the useMemo callback. Alternatively, wrap the initialization of 'allAnalyticsData' in its own useMemo() Hook.","line":57,"column":9,"nodeType":"VariableDeclarator","endLine":59,"endColumn":54,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\AnalyticsView.jsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'onStartTutorial'. Either include it or remove the dependency array. If 'onStartTutorial' changes too often, find the parent component that defines it and wrap that definition in useCallback.","line":73,"column":6,"nodeType":"ArrayExpression","endLine":73,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [onStartTutorial]","fix":{"range":[2171,2173],"text":"[onStartTutorial]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\ApiKeyModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\AppNavigation.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\BlockingProcessModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\BulkActionBar.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\BulkExportModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\ClearConfirmationModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\ConfirmDialog.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\ContextToolbar.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\CookieConsentBanner.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\CooldownTimer.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\CrashRecoveryPrompt.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\CritiqueDisplay.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\CritiqueModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\DangerZoneModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\DatabaseView.jsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'onStartTutorial'. Either include it or remove the dependency array. If 'onStartTutorial' changes too often, find the parent component that defines it and wrap that definition in useCallback.","line":34,"column":6,"nodeType":"ArrayExpression","endLine":34,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [onStartTutorial]","fix":{"range":[1181,1183],"text":"[onStartTutorial]"}}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has an unnecessary dependency: 'filterMode'. Either exclude it or remove the dependency array.","line":89,"column":6,"nodeType":"ArrayExpression","endLine":89,"endColumn":37,"suggestions":[{"desc":"Update the dependencies array to be: [questions, sortBy]","fix":{"range":[3064,3095],"text":"[questions, sortBy]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\DeleteConfirmModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\DeleteConfirmationModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\DraftRestorationBanner.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\EmptyState.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\ErrorBoundary.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\FilterButton.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\FlagIcon.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\Footer.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\GlobalModals.jsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'metrics' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":45,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":45,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"metrics"},"fix":{"range":[1281,1295],"text":""},"desc":"Remove unused variable 'metrics'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from \"react\";\r\nimport NameEntryModal from \"./NameEntryModal\";\r\nimport ClearConfirmationModal from \"./ClearConfirmationModal\";\r\nimport BlockingProcessModal from \"./BlockingProcessModal\";\r\nimport ApiKeyModal from \"./ApiKeyModal\";\r\nimport TermsOfUseModal from \"./TermsOfUseModal\";\r\nimport CookieConsentBanner from \"./CookieConsentBanner\";\r\nimport AgeGateModal from \"./AgeGateModal\";\r\nimport DeleteConfirmationModal from \"./DeleteConfirmationModal\";\r\nimport TutorialOverlay from \"./TutorialOverlay\";\r\nimport SettingsModal from \"./SettingsModal\";\r\nimport BulkExportModal from \"./BulkExportModal\";\r\nimport AnalyticsDashboard from \"./AnalyticsDashboard\";\r\nimport DangerZoneModal from \"./DangerZoneModal\";\r\nimport { Suspense } from \"react\";\r\n\r\n// Standard Modals\r\n// Lazy Modals\r\n// Standard Modals\r\n// Lazy Modals\r\n\r\nconst GlobalModals = ({ visibility, state, handlers }) => {\r\n  const {\r\n    showNameModal,\r\n    showClearModal,\r\n    showBulkExportModal,\r\n    showSettings,\r\n    showAnalytics,\r\n    showDangerZone,\r\n    showApiKeyModal,\r\n    showTerms,\r\n    showAgeGate,\r\n    tutorialActive,\r\n    deleteConfirmId,\r\n  } = visibility;\r\n\r\n  const {\r\n    config,\r\n    isProcessing,\r\n    status,\r\n    translationProgress,\r\n    allQuestionsMap,\r\n    currentStep,\r\n    tutorialSteps,\r\n    metrics, // passed for Analytics/DangerZone\r\n    isAdmin, // passed for SettingsModal\r\n  } = state;\r\n\r\n  const {\r\n    handleNameSave,\r\n    handleDeleteAllQuestions,\r\n    handleBulkExport,\r\n    confirmDelete,\r\n    setDeleteConfirmId,\r\n    onCloseBulkExport,\r\n    onCloseSettings,\r\n    onCloseAnalytics,\r\n    onCloseDangerZone,\r\n    onCloseApiKey,\r\n    handleChange,\r\n    handleSaveApiKey,\r\n    setShowTerms,\r\n    setTermsAccepted,\r\n    setShowAgeGate,\r\n    handleTutorialNext,\r\n    handleTutorialPrev,\r\n    handleTutorialSkip,\r\n    handleTutorialComplete,\r\n    onHardReset,\r\n    window, // needed for reloads/redirects?\r\n  } = handlers;\r\n\r\n  return (\r\n    <>\r\n      {/* Blocking Process - Highest Priority */}\r\n      {isProcessing && (\r\n        <BlockingProcessModal\r\n          isProcessing={isProcessing}\r\n          status={status}\r\n          translationProgress={translationProgress}\r\n        />\r\n      )}\r\n\r\n      {/* Critical Entry/Exit Modals */}\r\n      {config.creatorName === \"\" && showNameModal && (\r\n        <NameEntryModal onSave={handleNameSave} />\r\n      )}\r\n\r\n      {showClearModal && (\r\n        <ClearConfirmationModal\r\n          onConfirm={handleDeleteAllQuestions}\r\n          onCancel={() => handlers.setShowClearModal(false)}\r\n        />\r\n      )}\r\n\r\n      <DeleteConfirmationModal\r\n        deleteConfirmId={deleteConfirmId}\r\n        onConfirm={confirmDelete}\r\n        onCancel={() => setDeleteConfirmId(null)}\r\n      />\r\n\r\n      <ApiKeyModal\r\n        isOpen={showApiKeyModal}\r\n        onClose={onCloseApiKey}\r\n        onSave={handleSaveApiKey}\r\n        currentKey={config.apiKey}\r\n      />\r\n\r\n      <AgeGateModal\r\n        isOpen={showAgeGate}\r\n        onConfirm={() => {\r\n          setShowAgeGate(false);\r\n          setShowTerms(true);\r\n        }}\r\n        onExit={() => {\r\n          window.location.href = \"about:blank\";\r\n        }}\r\n      />\r\n\r\n      <TermsOfUseModal\r\n        isOpen={showTerms}\r\n        onAccept={() => {\r\n          localStorage.setItem(\"ue5_terms_accepted\", \"true\");\r\n          setShowTerms(false);\r\n          setTermsAccepted(true);\r\n        }}\r\n        onDecline={() => {\r\n          window.location.href = \"about:blank\";\r\n        }}\r\n      />\r\n\r\n      <CookieConsentBanner />\r\n\r\n      {/* Lazy Loaded Modals */}\r\n      <Suspense fallback={null}>\r\n        {showBulkExportModal && (\r\n          <BulkExportModal\r\n            onClose={onCloseBulkExport}\r\n            onExport={handleBulkExport}\r\n            questionCount={allQuestionsMap?.size || 0}\r\n          />\r\n        )}\r\n\r\n        {showSettings && (\r\n          <SettingsModal\r\n            showSettings={showSettings}\r\n            setShowSettings={onCloseSettings}\r\n            config={config}\r\n            handleChange={handleChange}\r\n            showApiKey={visibility.showApiKey || false}\r\n            setShowApiKey={handlers.setShowApiKey || (() => {})}\r\n            files={handlers.files}\r\n            handleDetectTopics={handlers.handleDetectTopics}\r\n            isDetecting={handlers.isDetecting}\r\n            fileInputRef={handlers.fileInputRef}\r\n            handleFileChange={handlers.handleFileChange}\r\n            removeFile={handlers.removeFile}\r\n            isApiReady={state.isApiReady}\r\n            customTags={state.customTags}\r\n            onSaveCustomTags={handlers.onSaveCustomTags}\r\n            isAdmin={isAdmin}\r\n          />\r\n        )}\r\n\r\n        <AnalyticsDashboard isOpen={showAnalytics} onClose={onCloseAnalytics} />\r\n\r\n        {showDangerZone && (\r\n          <DangerZoneModal\r\n            isOpen={showDangerZone}\r\n            onClose={onCloseDangerZone}\r\n            onClearData={handleDeleteAllQuestions}\r\n            onHardReset={onHardReset}\r\n            config={config}\r\n            isAdmin={isAdmin}\r\n          />\r\n        )}\r\n      </Suspense>\r\n\r\n      {/* Tutorial Overlay */}\r\n      {tutorialActive && (\r\n        <TutorialOverlay\r\n          steps={tutorialSteps}\r\n          currentStepIndex={currentStep}\r\n          onNext={handleTutorialNext}\r\n          onPrev={handleTutorialPrev}\r\n          onSkip={handleTutorialSkip}\r\n          onComplete={handleTutorialComplete}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default GlobalModals;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\GranularProgress.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\Header.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\Icon.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\InfoTooltip.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\InviteSignUp.jsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'handleValidate'. Either include it or remove the dependency array.","line":42,"column":6,"nodeType":"ArrayExpression","endLine":42,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [handleValidate]","fix":{"range":[1316,1318],"text":"[handleValidate]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\nimport {\n  validateInvite,\n  consumeInvite,\n  getInviteFromUrl,\n  clearInviteFromUrl,\n} from \"../services/inviteService\";\nimport {\n  signInWithGoogle,\n  signUpWithEmail,\n  signInWithEmail,\n} from \"../services/firebase\";\nimport Icon from \"./Icon\";\n\n/**\n * InviteSignUp - Registration with invite code validation\n *\n * @param {Object} props\n * @param {Function} props.onSuccess - Called when registration completes\n * @param {Function} props.onCancel - Called when user cancels\n */\nconst InviteSignUp = ({ onSuccess, onCancel }) => {\n  const [inviteCode, setInviteCode] = useState(\"\");\n  const [validationStatus, setValidationStatus] = useState(null);\n  const [validationError, setValidationError] = useState(\"\");\n  const [inviteRole, setInviteRole] = useState(\"user\");\n  const [isAuthenticating, setIsAuthenticating] = useState(false);\n  const [authError, setAuthError] = useState(\"\");\n\n  // Email auth state\n  const [showEmailAuth, setShowEmailAuth] = useState(false);\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [isNewUser, setIsNewUser] = useState(true);\n\n  useEffect(() => {\n    const urlInvite = getInviteFromUrl();\n    if (urlInvite) {\n      setInviteCode(urlInvite);\n      handleValidate(urlInvite);\n    }\n  }, []);\n\n  const handleValidate = async (code) => {\n    const codeToValidate = code || inviteCode;\n    if (!codeToValidate.trim()) {\n      setValidationError(\"Please enter an invite code\");\n      return;\n    }\n\n    setValidationStatus(\"validating\");\n    setValidationError(\"\");\n\n    try {\n      const result = await validateInvite(codeToValidate.trim());\n      if (result.valid) {\n        setValidationStatus(\"valid\");\n        setInviteRole(result.role);\n      }\n    } catch (error) {\n      setValidationStatus(\"invalid\");\n      setValidationError(error.message || \"Invalid invite code\");\n    }\n  };\n\n  const handleGoogleSignIn = async () => {\n    setIsAuthenticating(true);\n    setAuthError(\"\");\n    try {\n      await signInWithGoogle();\n      const result = await consumeInvite(inviteCode.trim());\n      clearInviteFromUrl();\n      onSuccess?.(result.role);\n    } catch (error) {\n      setAuthError(error.message || \"Authentication failed\");\n      setIsAuthenticating(false);\n    }\n  };\n\n  const handleEmailAuth = async (e) => {\n    e.preventDefault();\n    setIsAuthenticating(true);\n    setAuthError(\"\");\n    try {\n      if (isNewUser) {\n        await signUpWithEmail(email, password);\n      } else {\n        await signInWithEmail(email, password);\n      }\n      const result = await consumeInvite(inviteCode.trim());\n      clearInviteFromUrl();\n      onSuccess?.(result.role);\n    } catch (error) {\n      let message = error.message || \"Authentication failed\";\n      if (error.code === \"auth/email-already-in-use\") {\n        message = \"Email already registered. Try signing in instead.\";\n        setIsNewUser(false);\n      } else if (error.code === \"auth/weak-password\") {\n        message = \"Password should be at least 6 characters.\";\n      } else if (error.code === \"auth/wrong-password\") {\n        message = \"Incorrect password. Try again.\";\n      }\n      setAuthError(message);\n      setIsAuthenticating(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-slate-950 flex items-center justify-center p-4\">\n      <div className=\"bg-slate-900 border border-slate-800 rounded-2xl p-8 max-w-md w-full shadow-2xl\">\n        {/* Header */}\n        <div className=\"text-center mb-6\">\n          <div className=\"w-16 h-16 bg-orange-600/20 rounded-full flex items-center justify-center mx-auto mb-4\">\n            <Icon name=\"key\" size={32} className=\"text-orange-500\" />\n          </div>\n          <h1 className=\"text-2xl font-bold text-white\">\n            Join UE5 Question Generator\n          </h1>\n          <p className=\"text-slate-400 text-sm mt-2\">\n            Enter your invite code to get started\n          </p>\n        </div>\n\n        <div className=\"space-y-4\">\n          {/* Invite Code Input */}\n          <div>\n            <label\n              htmlFor=\"invite-code\"\n              className=\"block text-sm font-medium text-slate-300 mb-2\"\n            >\n              Invite Code\n            </label>\n            <input\n              id=\"invite-code\"\n              type=\"text\"\n              value={inviteCode}\n              onChange={(e) => setInviteCode(e.target.value.toUpperCase())}\n              placeholder=\"Enter your invite code\"\n              className=\"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-orange-500 font-mono tracking-wider\"\n              disabled={validationStatus === \"valid\"}\n            />\n          </div>\n\n          {/* Status Messages */}\n          {validationStatus === \"validating\" && (\n            <div className=\"flex items-center gap-2 text-blue-400\">\n              <Icon name=\"loader\" size={16} className=\"animate-spin\" />\n              <span>Validating invite code...</span>\n            </div>\n          )}\n          {validationStatus === \"valid\" && (\n            <div className=\"flex items-center gap-2 text-green-400 bg-green-900/20 p-3 rounded-lg\">\n              <Icon name=\"check-circle\" size={16} />\n              <span>\n                Valid invite! Role: <strong>{inviteRole}</strong>\n              </span>\n            </div>\n          )}\n          {validationError && (\n            <div className=\"flex items-center gap-2 text-red-400 bg-red-900/20 p-3 rounded-lg\">\n              <Icon name=\"x-circle\" size={16} />\n              <span>{validationError}</span>\n            </div>\n          )}\n          {authError && (\n            <div className=\"flex items-center gap-2 text-red-400 bg-red-900/20 p-3 rounded-lg\">\n              <Icon name=\"alert-triangle\" size={16} />\n              <span>{authError}</span>\n            </div>\n          )}\n\n          {/* Actions */}\n          {validationStatus !== \"valid\" ? (\n            <button\n              onClick={() => handleValidate()}\n              disabled={validationStatus === \"validating\" || !inviteCode.trim()}\n              className=\"w-full py-3 bg-orange-600 hover:bg-orange-500 disabled:bg-slate-700 disabled:cursor-not-allowed text-white font-bold rounded-lg transition-colors\"\n            >\n              Validate Invite Code\n            </button>\n          ) : showEmailAuth ? (\n            /* Email/Password Form */\n            <form onSubmit={handleEmailAuth} className=\"space-y-3\">\n              <input\n                type=\"email\"\n                placeholder=\"Email address\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                className=\"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-orange-500\"\n                required\n              />\n              <input\n                type=\"password\"\n                placeholder=\"Password (6+ characters)\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                className=\"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-orange-500\"\n                required\n                minLength={6}\n              />\n              <button\n                type=\"submit\"\n                disabled={isAuthenticating}\n                className=\"w-full py-3 bg-orange-600 hover:bg-orange-500 disabled:opacity-50 text-white font-bold rounded-lg transition-colors\"\n              >\n                {isAuthenticating\n                  ? \"Please wait...\"\n                  : isNewUser\n                  ? \"Create Account\"\n                  : \"Sign In\"}\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setIsNewUser(!isNewUser)}\n                className=\"w-full text-sm text-slate-400 hover:text-white\"\n              >\n                {isNewUser\n                  ? \"Already have an account? Sign in\"\n                  : \"New user? Create account\"}\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setShowEmailAuth(false)}\n                className=\"w-full text-sm text-slate-500 hover:text-slate-300\"\n              >\n                ΓåÉ Back to sign-in options\n              </button>\n            </form>\n          ) : (\n            /* Auth Options */\n            <div className=\"space-y-3\">\n              <button\n                onClick={handleGoogleSignIn}\n                disabled={isAuthenticating}\n                className=\"w-full flex items-center justify-center gap-3 py-3 bg-white hover:bg-slate-100 text-slate-900 font-bold rounded-lg transition-colors disabled:opacity-50\"\n              >\n                {isAuthenticating ? (\n                  <Icon name=\"loader\" size={20} className=\"animate-spin\" />\n                ) : (\n                  <GoogleIcon />\n                )}\n                {isAuthenticating ? \"Signing in...\" : \"Continue with Google\"}\n              </button>\n              <div className=\"flex items-center gap-3 text-slate-500 text-sm\">\n                <div className=\"flex-1 h-px bg-slate-700\" />\n                <span>or</span>\n                <div className=\"flex-1 h-px bg-slate-700\" />\n              </div>\n              <button\n                onClick={() => setShowEmailAuth(true)}\n                className=\"w-full flex items-center justify-center gap-3 py-3 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-lg transition-colors border border-slate-700\"\n              >\n                <Icon name=\"mail\" size={20} />\n                Continue with Email\n              </button>\n              <p className=\"text-xs text-slate-500 text-center\">\n                Any Google or email account works. No Epic Games login required.\n              </p>\n            </div>\n          )}\n\n          {onCancel && !showEmailAuth && (\n            <button\n              onClick={onCancel}\n              className=\"w-full py-2 text-slate-400 hover:text-white transition-colors\"\n            >\n              Cancel\n            </button>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// Google icon component\nconst GoogleIcon = () => (\n  <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\">\n    <path\n      fill=\"currentColor\"\n      d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"\n    />\n    <path\n      fill=\"currentColor\"\n      d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"\n    />\n    <path\n      fill=\"currentColor\"\n      d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"\n    />\n    <path\n      fill=\"currentColor\"\n      d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"\n    />\n  </svg>\n);\n\nexport default InviteSignUp;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\LandingPage.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\MainContent.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\MainLayout.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\MetricsDashboard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\ModalWrapper.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\NameEntryModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\OmniWatchdog.jsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'index' is defined but never used. Allowed unused args must match /^_/u.","line":181,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":181,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"index"},"fix":{"range":[5119,5126],"text":""},"desc":"Remove unused variable 'index'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState } from \"react\";\nimport { auth } from \"./services/firebase\";\n\n/**\n * OmniWatchdog - Development-only HUD for runtime compliance monitoring\n *\n * Features:\n * - ≡ƒ¢í∩╕Å Security Scanner: Detects exposed API keys in DOM\n * - ΓÜí Waterfall Detector: Monitors for sequential fetch calls\n * - ≡ƒæñ Auth State: Shows current user role\n *\n * @returns {null|JSX.Element} HUD component (dev only)\n */\nconst OmniWatchdog = () => {\n  const [alerts, setAlerts] = useState([]);\n  const [waterfallWarnings, setWaterfallWarnings] = useState(0);\n  const [userRole, setUserRole] = useState(\"Anonymous\");\n  const [lastFetchTime, setLastFetchTime] = useState(null);\n\n  // ≡ƒ¢æ Production Safety: Check if we're in development\n  const isDev = import.meta.env.DEV;\n\n  useEffect(() => {\n    // Don't run in production\n    if (!isDev) return;\n\n    // ≡ƒ¢í∩╕Å Security Scanner: Check for exposed API keys\n    const scanForLeaks = () => {\n      const bodyHTML = document.body.innerHTML;\n      const apiKeyPatterns = [\n        /AIza[0-9A-Za-z_-]{35}/g, // Google/Gemini/Firebase\n        /sk-[a-zA-Z0-9]{48}/g, // OpenAI\n        /AKIA[0-9A-Z]{16}/g, // AWS\n        /ghp_[a-zA-Z0-9]{36}/g, // GitHub\n        /xox[baprs]-[0-9a-zA-Z-]{10,}/g, // Slack\n      ];\n\n      const foundLeaks = [];\n      apiKeyPatterns.forEach((pattern, index) => {\n        const matches = bodyHTML.match(pattern);\n        if (matches) {\n          const keyType = [\"Google/Gemini\", \"OpenAI\", \"AWS\", \"GitHub\", \"Slack\"][\n            index\n          ];\n          foundLeaks.push({\n            type: \"SECURITY\",\n            severity: \"CRITICAL\",\n            message: `≡ƒÜ¿ EXPOSED ${keyType} API KEY DETECTED IN DOM!`,\n            timestamp: Date.now(),\n          });\n        }\n      });\n\n      if (foundLeaks.length > 0) {\n        setAlerts((prev) => [...prev, ...foundLeaks]);\n      }\n    };\n\n    // Run security scan every 5 seconds\n    const securityInterval = setInterval(scanForLeaks, 5000);\n    scanForLeaks(); // Initial scan\n\n    // ≡ƒæñ Auth State Monitor\n    const unsubscribe = auth.onAuthStateChanged((user) => {\n      if (user) {\n        // Check if user is admin (you can customize this logic)\n        user\n          .getIdTokenResult()\n          .then((idTokenResult) => {\n            const role = idTokenResult.claims.admin ? \"Admin\" : \"User\";\n            setUserRole(`${role} (${user.email})`);\n          })\n          .catch(() => {\n            setUserRole(`User (${user.email})`);\n          });\n      } else {\n        setUserRole(\"Anonymous\");\n      }\n    });\n\n    // ΓÜí Waterfall Detector: Monkey-patch fetch\n    const originalFetch = window.fetch;\n    window.fetch = function (...args) {\n      const now = Date.now();\n\n      // Check if this fetch is happening too soon after the last one (< 50ms = likely sequential)\n      if (lastFetchTime && now - lastFetchTime < 50) {\n        setWaterfallWarnings((prev) => prev + 1);\n        setAlerts((prev) => [\n          ...prev,\n          {\n            type: \"PERFORMANCE\",\n            severity: \"WARNING\",\n            message: `≡ƒÉó WATERFALL DETECTED: Sequential fetch to ${args[0]}`,\n            timestamp: now,\n          },\n        ]);\n      }\n\n      setLastFetchTime(now);\n      return originalFetch.apply(this, args);\n    };\n\n    // Cleanup\n    return () => {\n      clearInterval(securityInterval);\n      unsubscribe();\n      window.fetch = originalFetch; // Restore original fetch\n    };\n  }, [isDev, lastFetchTime]);\n\n  // Auto-dismiss alerts after 10 seconds\n  useEffect(() => {\n    if (!isDev) return;\n    if (alerts.length > 0) {\n      const timer = setTimeout(() => {\n        setAlerts((prev) => prev.slice(1));\n      }, 10000);\n      return () => clearTimeout(timer);\n    }\n  }, [isDev, alerts]);\n\n  // Don't render in production\n  if (!isDev) return null;\n\n  return (\n    <div\n      style={{\n        position: \"fixed\",\n        top: 0,\n        right: 0,\n        zIndex: 9999,\n        fontFamily: \"monospace\",\n        fontSize: \"12px\",\n        pointerEvents: \"none\",\n      }}\n    >\n      {/* Auth State Badge */}\n      <div\n        style={{\n          background: userRole.includes(\"Admin\") ? \"#10b981\" : \"#3b82f6\",\n          color: \"white\",\n          padding: \"8px 12px\",\n          borderRadius: \"0 0 0 8px\",\n          boxShadow: \"0 2px 8px rgba(0,0,0,0.2)\",\n        }}\n      >\n        ≡ƒæñ {userRole}\n      </div>\n\n      {/* Waterfall Counter */}\n      {waterfallWarnings > 0 && (\n        <div\n          style={{\n            background: \"#f59e0b\",\n            color: \"white\",\n            padding: \"8px 12px\",\n            marginTop: \"4px\",\n            borderRadius: \"0 0 0 8px\",\n            boxShadow: \"0 2px 8px rgba(0,0,0,0.2)\",\n          }}\n        >\n          ≡ƒÉó Waterfalls: {waterfallWarnings}\n        </div>\n      )}\n\n      {/* Alert Stack */}\n      <div\n        style={{\n          position: \"fixed\",\n          top: \"50%\",\n          right: \"20px\",\n          transform: \"translateY(-50%)\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          gap: \"8px\",\n          maxWidth: \"400px\",\n          pointerEvents: \"auto\",\n        }}\n      >\n        {alerts.slice(-3).map((alert, index) => (\n          <div\n            key={alert.timestamp}\n            style={{\n              background: alert.severity === \"CRITICAL\" ? \"#ef4444\" : \"#f59e0b\",\n              color: \"white\",\n              padding: \"12px 16px\",\n              borderRadius: \"8px\",\n              boxShadow: \"0 4px 12px rgba(0,0,0,0.3)\",\n              animation: \"slideIn 0.3s ease-out\",\n              cursor: \"pointer\",\n            }}\n            onClick={() =>\n              setAlerts((prev) =>\n                prev.filter((a) => a.timestamp !== alert.timestamp)\n              )\n            }\n          >\n            <div style={{ fontWeight: \"bold\", marginBottom: \"4px\" }}>\n              {alert.type}\n            </div>\n            <div>{alert.message}</div>\n            <div style={{ fontSize: \"10px\", opacity: 0.8, marginTop: \"4px\" }}>\n              Click to dismiss\n            </div>\n          </div>\n        ))}\n      </div>\n\n      {/* Inline CSS for animations */}\n      <style>{`\n                @keyframes slideIn {\n                    from {\n                        transform: translateX(100%);\n                        opacity: 0;\n                    }\n                    to {\n                        transform: translateX(0);\n                        opacity: 1;\n                    }\n                }\n            `}</style>\n    </div>\n  );\n};\n\nexport default OmniWatchdog;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\PromptDialog.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\PromptPlayground.jsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'useAppConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"useAppConfig"},"fix":{"range":[181,234],"text":""},"desc":"Remove unused variable 'useAppConfig'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'onClose' is defined but never used. Allowed unused args must match /^_/u.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":10,"suggestions":[{"messageId":"removeVar","data":{"varName":"onClose"},"fix":{"range":[303,315],"text":""},"desc":"Remove unused variable 'onClose'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'handleResetToDefaults'. Either include it or remove the dependency array.","line":31,"column":6,"nodeType":"ArrayExpression","endLine":31,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [handleResetToDefaults]","fix":{"range":[1086,1088],"text":"[handleResetToDefaults]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\r\nimport { constructSystemPrompt } from \"../services/promptBuilder\";\r\nimport { generateContentSecure } from \"../services/geminiSecure\";\r\nimport { useAppConfig } from \"../hooks/useAppConfig\";\r\nimport Icon from \"./Icon\";\r\n\r\nconst PromptPlayground = ({\r\n  config,\r\n  onClose,\r\n  apiKeyReady,\r\n  effectiveApiKey,\r\n}) => {\r\n  // Local state for prompts and parameters\r\n  // Initialize with current config's system prompt\r\n  const [systemPrompt, setSystemPrompt] = useState(\"\");\r\n  const [userPrompt, setUserPrompt] = useState(\r\n    \"Generate a set of 3 questions about Nanite in Unreal Engine 5.\"\r\n  );\r\n  const [temperature, setTemperature] = useState(config.temperature || 0.7);\r\n  const [model, setModel] = useState(config.model || \"gemini-2.0-flash\");\r\n\r\n  // Execution state\r\n  const [output, setOutput] = useState(\"\");\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [status, setStatus] = useState(\"\");\r\n  const [error, setError] = useState(null);\r\n\r\n  // Initial load\r\n  useEffect(() => {\r\n    handleResetToDefaults();\r\n  }, []);\r\n\r\n  const handleResetToDefaults = () => {\r\n    // Construct prompt using current app config\r\n    // We pass empty file context for now as we're testing the core prompt\r\n    const prompt = constructSystemPrompt(config, \"\");\r\n    setSystemPrompt(prompt);\r\n  };\r\n\r\n  const handleExecute = async () => {\r\n    if (!import.meta.env.DEV && !apiKeyReady) {\r\n      setError(\"API Key required\");\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n    setError(null);\r\n    setStatus(\"Sending request...\");\r\n    setOutput(\"\");\r\n\r\n    try {\r\n      const result = await generateContentSecure(\r\n        effectiveApiKey,\r\n        systemPrompt,\r\n        userPrompt,\r\n        setStatus,\r\n        temperature,\r\n        model\r\n      );\r\n\r\n      setOutput(result);\r\n      setStatus(\"Complete\");\r\n    } catch (err) {\r\n      console.error(\"Playground error:\", err);\r\n      setError(err.message || \"Failed to generate content\");\r\n      setStatus(\"Failed\");\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex flex-col h-full bg-slate-950 text-slate-200\">\r\n      {/* Toolbar */}\r\n      <div className=\"flex items-center justify-between p-4 border-b border-slate-800 bg-slate-900\">\r\n        <div className=\"flex items-center gap-3\">\r\n          <div className=\"p-2 bg-purple-500/20 rounded-lg\">\r\n            <Icon name=\"terminal\" className=\"text-purple-400\" size={20} />\r\n          </div>\r\n          <div>\r\n            <h2 className=\"font-bold text-white\">Prompt Playground</h2>\r\n            <p className=\"text-xs text-slate-400\">\r\n              Test and iterate on system prompts\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-4\">\r\n          {/* Model Selector */}\r\n          <div className=\"flex items-center gap-2\">\r\n            <span className=\"text-xs text-slate-400 uppercase font-bold\">\r\n              Model\r\n            </span>\r\n            <select\r\n              value={model}\r\n              onChange={(e) => setModel(e.target.value)}\r\n              className=\"bg-slate-950 border border-slate-700 rounded px-2 py-1 text-xs outline-none focus:border-purple-500\"\r\n            >\r\n              <option value=\"gemini-2.0-flash\">Gemini 2.0 Flash</option>\r\n              <option value=\"gemini-1.5-pro\">Gemini 1.5 Pro</option>\r\n            </select>\r\n          </div>\r\n\r\n          {/* Temperature Slider */}\r\n          <div className=\"flex items-center gap-2 w-32\">\r\n            <span className=\"text-xs text-slate-400 uppercase font-bold\">\r\n              Temp: {temperature}\r\n            </span>\r\n            <input\r\n              type=\"range\"\r\n              min=\"0\"\r\n              max=\"1\"\r\n              step=\"0.1\"\r\n              value={temperature}\r\n              onChange={(e) => setTemperature(parseFloat(e.target.value))}\r\n              className=\"w-full accent-purple-500 h-1 bg-slate-700 rounded-lg appearance-none cursor-pointer\"\r\n            />\r\n          </div>\r\n\r\n          <button\r\n            onClick={handleResetToDefaults}\r\n            className=\"px-3 py-1.5 text-xs font-bold text-slate-400 hover:text-white bg-slate-800 hover:bg-slate-700 rounded border border-slate-700 transition-colors flex items-center gap-2\"\r\n            title=\"Reset to current app defaults\"\r\n          >\r\n            <Icon name=\"refresh-cw\" size={12} /> Reset\r\n          </button>\r\n\r\n          <button\r\n            onClick={handleExecute}\r\n            disabled={isLoading}\r\n            className={`px-4 py-2 text-sm font-bold text-white rounded flex items-center gap-2 transition-all shadow-lg ${\r\n              isLoading\r\n                ? \"bg-slate-700 cursor-not-allowed text-slate-500\"\r\n                : \"bg-purple-600 hover:bg-purple-500 shadow-purple-900/20 hover:scale-105 active:scale-95\"\r\n            }`}\r\n          >\r\n            {isLoading ? (\r\n              <Icon name=\"loader\" className=\"animate-spin\" size={16} />\r\n            ) : (\r\n              <Icon name=\"play\" size={16} />\r\n            )}\r\n            {isLoading ? \"Running...\" : \"Run Prompt\"}\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main Content Split View */}\r\n      <div className=\"flex-1 flex overflow-hidden\">\r\n        {/* Left Panel: Inputs */}\r\n        <div className=\"w-1/2 flex flex-col border-r border-slate-800\">\r\n          {/* System Prompt */}\r\n          <div className=\"flex-1 flex flex-col min-h-0 border-b border-slate-800\">\r\n            <div className=\"px-4 py-2 bg-slate-900/50 flex justify-between items-center\">\r\n              <span className=\"text-xs font-bold text-slate-400 uppercase\">\r\n                System Prompt\r\n              </span>\r\n              <span className=\"text-[10px] text-slate-500 font-mono\">\r\n                {systemPrompt.length} chars\r\n              </span>\r\n            </div>\r\n            <textarea\r\n              value={systemPrompt}\r\n              onChange={(e) => setSystemPrompt(e.target.value)}\r\n              className=\"flex-1 bg-slate-950 p-4 text-xs font-mono text-slate-300 resize-none outline-none focus:bg-slate-900/30 transition-colors\"\r\n              spellCheck={false}\r\n              placeholder=\"Enter system instructions here...\"\r\n            />\r\n          </div>\r\n\r\n          {/* User Prompt */}\r\n          <div className=\"h-1/3 flex flex-col min-h-0\">\r\n            <div className=\"px-4 py-2 bg-slate-900/50 flex justify-between items-center border-t border-slate-800\">\r\n              <span className=\"text-xs font-bold text-slate-400 uppercase\">\r\n                User Prompt\r\n              </span>\r\n            </div>\r\n            <textarea\r\n              value={userPrompt}\r\n              onChange={(e) => setUserPrompt(e.target.value)}\r\n              className=\"flex-1 bg-slate-950 p-4 text-sm text-slate-200 resize-none outline-none focus:bg-slate-900/30 transition-colors\"\r\n              placeholder=\"Enter your test input here...\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Right Panel: Output */}\r\n        <div className=\"w-1/2 flex flex-col bg-slate-900/30\">\r\n          <div className=\"px-4 py-2 bg-slate-900/50 flex justify-between items-center border-b border-slate-800\">\r\n            <span className=\"text-xs font-bold text-slate-400 uppercase\">\r\n              Model Output\r\n            </span>\r\n            {status && (\r\n              <span className=\"text-xs text-slate-500 italic\">{status}</span>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"flex-1 overflow-auto p-6\">\r\n            {error ? (\r\n              <div className=\"p-4 bg-red-900/20 border border-red-900/50 rounded-lg text-red-200 text-sm\">\r\n                <strong className=\"block mb-1\">Error</strong>\r\n                {error}\r\n              </div>\r\n            ) : output ? (\r\n              <div className=\"prose prose-invert prose-sm max-w-none\">\r\n                <pre className=\"whitespace-pre-wrap font-mono text-sm text-slate-300\">\r\n                  {output}\r\n                </pre>\r\n              </div>\r\n            ) : (\r\n              <div className=\"h-full flex flex-col items-center justify-center text-slate-600\">\r\n                <Icon name=\"terminal\" size={48} className=\"mb-4 opacity-50\" />\r\n                <p className=\"text-sm\">Ready to execute.</p>\r\n                <p className=\"text-xs mt-2\">\r\n                  Configure prompts on the left and click Run.\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PromptPlayground;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\QuestionItem.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\QuestionItem.test.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\QuestionItem\\CritiqueSection.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\QuestionItem\\ExplanationDisplay.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\QuestionItem\\LanguageControls.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\QuestionItem\\QuestionActions.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\QuestionItem\\QuestionContent.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\QuestionItem\\QuestionHeader.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\QuestionItem\\QuestionMenu.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\QuestionItem\\QuestionMetadata.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\QuestionItem\\SourceContextCard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\QuestionItem\\ValidationWarnings.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\QuestionList.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\QuestionVariationCarousel.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\ReviewMode.jsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'onStartTutorial' and 'questions.length'. Either include them or remove the dependency array. If 'onStartTutorial' changes too often, find the parent component that defines it and wrap that definition in useCallback.","line":31,"column":6,"nodeType":"ArrayExpression","endLine":31,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [onStartTutorial, questions.length]","fix":{"range":[821,823],"text":"[onStartTutorial, questions.length]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\ReviewModeBanner.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\ReviewProgressBar.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\ScormExportModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\SettingsModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\Sidebar.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\SignIn.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\TagManager.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\TermsOfUseModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\Toast.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\ToastContainer.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\TokenUsageDisplay.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\TutorialOverlay.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\UnsavedChangesDialog.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\ViewRouter.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\__tests__\\InviteSignUp.test.jsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'fireEvent' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":35,"suggestions":[{"messageId":"removeVar","data":{"varName":"fireEvent"},"fix":{"range":[196,207],"text":""},"desc":"Remove unused variable 'fireEvent'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * InviteSignUp Component Tests\n *\n * Following QA-Sentinel-Prime: \"IF IT ISN'T TESTED, IT DOESN'T EXIST\"\n * Using React Testing Library for behavior-based testing\n */\n\nimport { render, screen, fireEvent, waitFor } from \"@testing-library/react\";\nimport userEvent from \"@testing-library/user-event\";\nimport { describe, test, expect, vi, beforeEach } from \"vitest\";\nimport InviteSignUp from \"../InviteSignUp\";\nimport * as inviteService from \"../../services/inviteService\";\nimport * as firebase from \"../../services/firebase\";\n\n// Mock the services\nvi.mock(\"../../services/inviteService\");\nvi.mock(\"../../services/firebase\");\n\ndescribe(\"InviteSignUp Component\", () => {\n  const mockOnSuccess = vi.fn();\n  const mockOnCancel = vi.fn();\n\n  beforeEach(() => {\n    vi.clearAllMocks();\n    inviteService.getInviteFromUrl.mockReturnValue(null);\n  });\n\n  describe(\"Initial Render\", () => {\n    test(\"renders invite code input field\", () => {\n      render(<InviteSignUp onSuccess={mockOnSuccess} />);\n      expect(screen.getByLabelText(/invite code/i)).toBeInTheDocument();\n    });\n\n    test(\"renders validate button initially\", () => {\n      render(<InviteSignUp onSuccess={mockOnSuccess} />);\n      expect(\n        screen.getByRole(\"button\", { name: /validate invite code/i })\n      ).toBeInTheDocument();\n    });\n\n    test(\"renders cancel button when onCancel is provided\", () => {\n      render(\n        <InviteSignUp onSuccess={mockOnSuccess} onCancel={mockOnCancel} />\n      );\n      expect(\n        screen.getByRole(\"button\", { name: /cancel/i })\n      ).toBeInTheDocument();\n    });\n\n    test(\"does not render cancel button when onCancel is not provided\", () => {\n      render(<InviteSignUp onSuccess={mockOnSuccess} />);\n      expect(\n        screen.queryByRole(\"button\", { name: /cancel/i })\n      ).not.toBeInTheDocument();\n    });\n  });\n\n  describe(\"URL Invite Code Detection\", () => {\n    test(\"auto-populates invite code from URL\", async () => {\n      inviteService.getInviteFromUrl.mockReturnValue(\"ABC123XYZ789\");\n      inviteService.validateInvite.mockResolvedValue({\n        valid: true,\n        role: \"user\",\n      });\n\n      render(<InviteSignUp onSuccess={mockOnSuccess} />);\n\n      await waitFor(() => {\n        expect(screen.getByLabelText(/invite code/i)).toHaveValue(\n          \"ABC123XYZ789\"\n        );\n      });\n    });\n\n    test(\"auto-validates invite code from URL\", async () => {\n      inviteService.getInviteFromUrl.mockReturnValue(\"ABC123XYZ789\");\n      inviteService.validateInvite.mockResolvedValue({\n        valid: true,\n        role: \"admin\",\n      });\n\n      render(<InviteSignUp onSuccess={mockOnSuccess} />);\n\n      await waitFor(() => {\n        expect(inviteService.validateInvite).toHaveBeenCalledWith(\n          \"ABC123XYZ789\"\n        );\n      });\n    });\n  });\n\n  describe(\"Input Handling\", () => {\n    test(\"converts input to uppercase\", async () => {\n      render(<InviteSignUp onSuccess={mockOnSuccess} />);\n      const input = screen.getByLabelText(/invite code/i);\n\n      await userEvent.type(input, \"abc123xyz\");\n\n      expect(input).toHaveValue(\"ABC123XYZ\");\n    });\n\n    test(\"disables input after successful validation\", async () => {\n      inviteService.validateInvite.mockResolvedValue({\n        valid: true,\n        role: \"user\",\n      });\n\n      render(<InviteSignUp onSuccess={mockOnSuccess} />);\n      const input = screen.getByLabelText(/invite code/i);\n\n      await userEvent.type(input, \"VALID123CODE\");\n      await userEvent.click(screen.getByRole(\"button\", { name: /validate/i }));\n\n      await waitFor(() => {\n        expect(input).toBeDisabled();\n      });\n    });\n  });\n\n  describe(\"Validation Flow\", () => {\n    test(\"shows loading state during validation\", async () => {\n      inviteService.validateInvite.mockImplementation(\n        () =>\n          new Promise((resolve) =>\n            setTimeout(() => resolve({ valid: true }), 100)\n          )\n      );\n\n      render(<InviteSignUp onSuccess={mockOnSuccess} />);\n      await userEvent.type(\n        screen.getByLabelText(/invite code/i),\n        \"CODE12345678\"\n      );\n      await userEvent.click(screen.getByRole(\"button\", { name: /validate/i }));\n\n      expect(screen.getByText(/validating/i)).toBeInTheDocument();\n    });\n\n    test(\"shows success message for valid invite\", async () => {\n      inviteService.validateInvite.mockResolvedValue({\n        valid: true,\n        role: \"admin\",\n      });\n\n      render(<InviteSignUp onSuccess={mockOnSuccess} />);\n      await userEvent.type(\n        screen.getByLabelText(/invite code/i),\n        \"VALIDCODE123\"\n      );\n      await userEvent.click(screen.getByRole(\"button\", { name: /validate/i }));\n\n      await waitFor(() => {\n        expect(screen.getByText(/valid invite/i)).toBeInTheDocument();\n        expect(screen.getByText(/admin/i)).toBeInTheDocument();\n      });\n    });\n\n    test(\"shows error message for invalid invite\", async () => {\n      inviteService.validateInvite.mockRejectedValue(\n        new Error(\"Invalid invite code\")\n      );\n\n      render(<InviteSignUp onSuccess={mockOnSuccess} />);\n      await userEvent.type(\n        screen.getByLabelText(/invite code/i),\n        \"BADCODE12345\"\n      );\n      await userEvent.click(screen.getByRole(\"button\", { name: /validate/i }));\n\n      await waitFor(() => {\n        expect(screen.getByText(/invalid invite code/i)).toBeInTheDocument();\n      });\n    });\n\n    test(\"shows rate limit error when exceeded\", async () => {\n      inviteService.validateInvite.mockRejectedValue(\n        new Error(\"Too many failed attempts\")\n      );\n\n      render(<InviteSignUp onSuccess={mockOnSuccess} />);\n      await userEvent.type(\n        screen.getByLabelText(/invite code/i),\n        \"ANYCODE12345\"\n      );\n      await userEvent.click(screen.getByRole(\"button\", { name: /validate/i }));\n\n      await waitFor(() => {\n        expect(\n          screen.getByText(/too many failed attempts/i)\n        ).toBeInTheDocument();\n      });\n    });\n  });\n\n  describe(\"Authentication Flow\", () => {\n    test(\"shows Google sign-in button after valid invite\", async () => {\n      inviteService.validateInvite.mockResolvedValue({\n        valid: true,\n        role: \"user\",\n      });\n\n      render(<InviteSignUp onSuccess={mockOnSuccess} />);\n      await userEvent.type(\n        screen.getByLabelText(/invite code/i),\n        \"VALIDCODE123\"\n      );\n      await userEvent.click(screen.getByRole(\"button\", { name: /validate/i }));\n\n      await waitFor(() => {\n        expect(\n          screen.getByRole(\"button\", { name: /continue with google/i })\n        ).toBeInTheDocument();\n      });\n    });\n\n    test(\"calls onSuccess after successful sign-in and invite consumption\", async () => {\n      inviteService.validateInvite.mockResolvedValue({\n        valid: true,\n        role: \"admin\",\n      });\n      firebase.signInWithGoogle.mockResolvedValue({\n        user: { email: \"test@example.com\" },\n      });\n      inviteService.consumeInvite.mockResolvedValue({\n        success: true,\n        role: \"admin\",\n      });\n      inviteService.clearInviteFromUrl.mockImplementation(() => {});\n\n      render(<InviteSignUp onSuccess={mockOnSuccess} />);\n      await userEvent.type(\n        screen.getByLabelText(/invite code/i),\n        \"VALIDCODE123\"\n      );\n      await userEvent.click(screen.getByRole(\"button\", { name: /validate/i }));\n\n      await waitFor(() => {\n        expect(\n          screen.getByRole(\"button\", { name: /continue with google/i })\n        ).toBeInTheDocument();\n      });\n\n      await userEvent.click(\n        screen.getByRole(\"button\", { name: /continue with google/i })\n      );\n\n      await waitFor(() => {\n        expect(mockOnSuccess).toHaveBeenCalledWith(\"admin\");\n      });\n    });\n\n    test(\"shows error when authentication fails\", async () => {\n      inviteService.validateInvite.mockResolvedValue({\n        valid: true,\n        role: \"user\",\n      });\n      firebase.signInWithGoogle.mockRejectedValue(new Error(\"Auth cancelled\"));\n\n      render(<InviteSignUp onSuccess={mockOnSuccess} />);\n      await userEvent.type(\n        screen.getByLabelText(/invite code/i),\n        \"VALIDCODE123\"\n      );\n      await userEvent.click(screen.getByRole(\"button\", { name: /validate/i }));\n\n      await waitFor(() => {\n        expect(\n          screen.getByRole(\"button\", { name: /continue with google/i })\n        ).toBeInTheDocument();\n      });\n\n      await userEvent.click(\n        screen.getByRole(\"button\", { name: /continue with google/i })\n      );\n\n      await waitFor(() => {\n        expect(screen.getByText(/auth cancelled/i)).toBeInTheDocument();\n      });\n    });\n  });\n\n  describe(\"Cancel Flow\", () => {\n    test(\"calls onCancel when cancel button is clicked\", async () => {\n      render(\n        <InviteSignUp onSuccess={mockOnSuccess} onCancel={mockOnCancel} />\n      );\n\n      await userEvent.click(screen.getByRole(\"button\", { name: /cancel/i }));\n\n      expect(mockOnCancel).toHaveBeenCalled();\n    });\n  });\n\n  describe(\"Accessibility\", () => {\n    test(\"input has proper aria-labels\", () => {\n      render(<InviteSignUp onSuccess={mockOnSuccess} />);\n      const input = screen.getByLabelText(/invite code/i);\n\n      expect(input).toHaveAttribute(\"id\", \"invite-code\");\n    });\n\n    test(\"input shows aria-invalid when validation fails\", async () => {\n      inviteService.validateInvite.mockRejectedValue(new Error(\"Invalid\"));\n\n      render(<InviteSignUp onSuccess={mockOnSuccess} />);\n      await userEvent.type(\n        screen.getByLabelText(/invite code/i),\n        \"BADCODE12345\"\n      );\n      await userEvent.click(screen.getByRole(\"button\", { name: /validate/i }));\n\n      await waitFor(() => {\n        expect(screen.getByLabelText(/invite code/i)).toHaveAttribute(\n          \"aria-invalid\",\n          \"true\"\n        );\n      });\n    });\n  });\n});\n\n/**\n * Coverage Report (QA-Sentinel style):\n *\n * Happy Path:\n * Γ£à Valid invite code ΓåÆ Google sign-in ΓåÆ Success callback\n *\n * Edge Cases:\n * Γ£à Empty input handling\n * Γ£à URL parameter detection\n * Γ£à Uppercase conversion\n *\n * Error States:\n * Γ£à Invalid invite code\n * Γ£à Rate limit exceeded\n * Γ£à Authentication failure\n *\n * Accessibility:\n * Γ£à Proper labels and ARIA attributes\n * Γ£à aria-invalid for error states\n */\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\analytics\\DisciplineDetailPanel.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\analytics\\DistributionCharts.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\analytics\\EmptyState.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\analytics\\StatCard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\analytics\\TrendCharts.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\layout\\AppLayout.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\sidebar\\ActionFooter.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\sidebar\\BatchSizeControl.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\sidebar\\CoverageGapSuggester.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\sidebar\\CustomRules.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\sidebar\\GenerationSettings.jsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook React.useEffect has a missing dependency: 'showAdvanced'. Either include it or remove the dependency array.","line":98,"column":6,"nodeType":"ArrayExpression","endLine":98,"endColumn":41,"suggestions":[{"desc":"Update the dependencies array to be: [config.tags?.length, config.model, showAdvanced]","fix":{"range":[3501,3536],"text":"[config.tags?.length, config.model, showAdvanced]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\components\\sidebar\\ProgressStats.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\contexts\\ModalProvider.jsx","messages":[],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":6,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":6,"endColumn":22,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\generation\\useQuestionActions.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\generation\\useTranslation.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\generation\\utils\\questionConverter.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\useAppConfig.js","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'config.creatorName'. Either include it or remove the dependency array.","line":95,"column":6,"nodeType":"ArrayExpression","endLine":95,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [config.creatorName]","fix":{"range":[3772,3774],"text":"[config.creatorName]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\r\nimport { getSecureItem, setSecureItem } from \"../utils/secureStorage\";\r\n\r\nexport const useAppConfig = () => {\r\n  // Application mode: 'landing' (home screen), 'create' (generation mode), 'review' (review mode), 'database' (view all)\r\n  const [appMode, setAppMode] = useState(\"landing\");\r\n\r\n  // Check if running in internal Canvas environment (has auto-injected API key)\r\n  const isInternalEnvironment =\r\n    typeof window !== \"undefined\" && typeof window.__app_id !== \"undefined\";\r\n\r\n  // Authentication status - always ready for local/Sheets operations\r\n  const isAuthReady = true;\r\n\r\n  // SECURITY WARNING: Storing API keys in localStorage is insecure!\r\n  // This is a temporary solution. For production:\r\n  // 1. Move API calls to a backend proxy server\r\n  // 2. Never expose API keys in client-side code\r\n  // 3. Use server-side authentication with the Gemini API\r\n\r\n  // Main application configuration (persisted to localStorage)\r\n  const [config, setConfig] = useState(() => {\r\n    const saved = getSecureItem(\"ue5_gen_config\");\r\n    const defaults = {\r\n      discipline: \"Technical Art\",\r\n      batchSize: \"6\",\r\n      difficulty: \"Beginner\",\r\n      type: \"Multiple Choice\", // Explicit type selection (no Balanced mode)\r\n      language: \"English\",\r\n      creatorName: \"\",\r\n      reviewerName: \"\",\r\n      apiKey: \"\",\r\n      sheetUrl:\r\n        \"https://script.google.com/a/macros/epicgames.com/s/AKfycbxssaKhw3pOWkC9sPJE_6oMZuG66JYCgeEQFEHh010Q90wlHqH64oiVhFjE1JQkSTV6/exec\",\r\n      model: \"gemini-2.0-flash\",\r\n      tags: [], // Selected sub-topic tags\r\n    };\r\n\r\n    const initialConfig = saved ? { ...defaults, ...saved } : defaults;\r\n\r\n    // Ensure all required fields have default values\r\n    initialConfig.creatorName = initialConfig.creatorName || \"\";\r\n    initialConfig.reviewerName = initialConfig.reviewerName || \"\";\r\n    initialConfig.apiKey = initialConfig.apiKey || \"\";\r\n    initialConfig.sheetUrl = initialConfig.sheetUrl || defaults.sheetUrl;\r\n\r\n    // Reset deprecated difficulty setting\r\n    // if (initialConfig.difficulty === 'Balanced All') {\r\n    //     initialConfig.difficulty = 'Easy MC';\r\n    // }\r\n\r\n    return initialConfig;\r\n  });\r\n\r\n  // API key status computed values\r\n  // Cloud Functions are available when user is authenticated (checked via Firebase Auth in App.jsx)\r\n  // We'll accept auth status as a prop to determine if Cloud Functions are available\r\n  const hasClientKey = config.apiKey && config.apiKey.length > 5;\r\n  const isApiReady = isInternalEnvironment || hasClientKey || isAuthReady; // Cloud Functions count as \"ready\"\r\n  const effectiveApiKey = isInternalEnvironment ? \"\" : config.apiKey;\r\n\r\n  // Status priority: Internal > Cloud Functions > Client Key > Not Set\r\n  let apiKeyStatus;\r\n  if (isInternalEnvironment) {\r\n    apiKeyStatus = \"Auto-Injected\";\r\n  } else if (hasClientKey) {\r\n    apiKeyStatus = \"Loaded\";\r\n  } else if (isAuthReady) {\r\n    apiKeyStatus = \"Cloud Functions\"; // User is authenticated, can use server-side API\r\n  } else {\r\n    apiKeyStatus = \"Not Set\";\r\n  }\r\n\r\n  // DEBUG: Log the computed values\r\n  console.log(\"≡ƒöì [useAppConfig] API Status Debug:\", {\r\n    isInternalEnvironment,\r\n    hasClientKey,\r\n    isAuthReady,\r\n    isApiReady,\r\n    apiKeyStatus,\r\n  });\r\n\r\n  // UI States\r\n  const [showNameModal, setShowNameModal] = useState(false);\r\n  const [showGenSettings, setShowGenSettings] = useState(true);\r\n  const [showApiError, setShowApiError] = useState(false);\r\n  const [batchSizeWarning, setBatchSizeWarning] = useState(\"\");\r\n  const [showSettings, setShowSettings] = useState(false);\r\n  const [showApiKey, setShowApiKey] = useState(false);\r\n\r\n  // Effects\r\n   \r\n  useEffect(() => {\r\n    if (!config.creatorName) setShowNameModal(true);\r\n  }, []);\r\n  useEffect(() => {\r\n    setSecureItem(\"ue5_gen_config\", config);\r\n  }, [config]);\r\n\r\n  // Handlers\r\n  const handleLanguageSwitch = (lang) => {\r\n    setConfig((prev) => ({ ...prev, language: lang }));\r\n  };\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target;\r\n\r\n    // Validate batch size for Balanced All mode\r\n    if (name === \"batchSize\") {\r\n      if (config.difficulty === \"Balanced All\") {\r\n        const num = parseInt(value);\r\n        if (num % 6 !== 0) {\r\n          setBatchSizeWarning(\r\n            \"Batch size must be a multiple of 6 for Balanced Mode.\"\r\n          );\r\n        } else {\r\n          setBatchSizeWarning(\"\");\r\n        }\r\n      } else {\r\n        setBatchSizeWarning(\"\");\r\n      }\r\n    }\r\n\r\n    setConfig((prev) => ({ ...prev, [name]: value }));\r\n\r\n    if (name === \"language\") {\r\n      handleLanguageSwitch(value);\r\n    }\r\n    if (name === \"apiKey\") {\r\n      setShowApiError(false);\r\n    }\r\n  };\r\n\r\n  const handleNameSave = (name) => {\r\n    setConfig((prev) => ({ ...prev, creatorName: name, reviewerName: name }));\r\n    setShowNameModal(false);\r\n  };\r\n\r\n  return {\r\n    appMode,\r\n    setAppMode,\r\n    config,\r\n    setConfig,\r\n    isInternalEnvironment,\r\n    isAuthReady,\r\n    isApiReady,\r\n    effectiveApiKey,\r\n    apiKeyStatus,\r\n    showNameModal,\r\n    setShowNameModal,\r\n    showGenSettings,\r\n    setShowGenSettings,\r\n    showApiError,\r\n    setShowApiError,\r\n    batchSizeWarning,\r\n    setBatchSizeWarning,\r\n    showSettings,\r\n    setShowSettings,\r\n    showApiKey,\r\n    setShowApiKey,\r\n    handleChange,\r\n    handleNameSave,\r\n    handleLanguageSwitch,\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\useAppHandlers.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\useAuth.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\useAutoSave.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\useBulkSelection.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\useConnectionStatus.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\useCrashRecovery.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\useDatabaseActions.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\useExport.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\useFileHandler.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\useFiltering.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\useGeneration.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\useKeyboardShortcuts.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\useModalState.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\useNavigation.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\useProgressTracker.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\useQuestionManager.js","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'TARGET_PER_DIFFICULTY'. Either include it or remove the dependency array.","line":302,"column":6,"nodeType":"ArrayExpression","endLine":302,"endColumn":61,"suggestions":[{"desc":"Update the dependencies array to be: [TARGET_PER_DIFFICULTY, config.difficulty, difficultyTotals, isGlobalQuotaMet]","fix":{"range":[10388,10443],"text":"[TARGET_PER_DIFFICULTY, config.difficulty, difficultyTotals, isGlobalQuotaMet]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'TARGET_PER_DIFFICULTY'. Either include it or remove the dependency array.","line":322,"column":6,"nodeType":"ArrayExpression","endLine":328,"endColumn":4,"suggestions":[{"desc":"Update the dependencies array to be: [isGlobalQuotaMet, config.difficulty, approvedCounts, difficultyTotals, TARGET_PER_DIFFICULTY, totalApproved]","fix":{"range":[11266,11383],"text":"[isGlobalQuotaMet, config.difficulty, approvedCounts, difficultyTotals, TARGET_PER_DIFFICULTY, totalApproved]"}}]}],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'questions'. Either include it or remove the dependency array.","line":89,"column":6,"nodeType":"ArrayExpression","endLine":89,"endColumn":26,"suggestions":[{"desc":"Update the dependencies array to be: [config.creatorName, questions]","fix":{"range":[3028,3048],"text":"[config.creatorName, questions]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useMemo, useCallback } from \"react\";\r\nimport { getSecureItem, setSecureItem } from \"../utils/secureStorage\";\r\nimport { filterDuplicateQuestions } from \"../utils/questionHelpers\";\r\nimport {\r\n  CATEGORY_KEYS,\r\n  TARGET_PER_CATEGORY,\r\n  TARGET_TOTAL,\r\n} from \"../utils/constants\";\r\nimport {\r\n  saveQuestionToFirestore,\r\n  getQuestionsPaginated,\r\n} from \"../services/firebase\";\r\nimport { logQuestion } from \"../utils/analyticsStore\";\r\n\r\nexport const useQuestionManager = (config, showMessage) => {\r\n  // Current session questions\r\n  const [questions, setQuestions] = useState(() => {\r\n    const saved = getSecureItem(\"ue5_gen_questions\");\r\n    return saved || [];\r\n  });\r\n\r\n  // Historical questions\r\n  const [historicalQuestions, setHistoricalQuestions] = useState([]);\r\n\r\n  // Database view questions\r\n  const [databaseQuestions, setDatabaseQuestions] = useState([]);\r\n\r\n  // PERFORMANCE: Pagination state\r\n  const [isLoadingMore, setIsLoadingMore] = useState(false);\r\n  const [hasMore, setHasMore] = useState(true);\r\n  const [lastDoc, setLastDoc] = useState(null);\r\n\r\n  // Central question storage map\r\n  const [allQuestionsMap, setAllQuestionsMap] = useState(new Map());\r\n\r\n  // Delete confirmation state\r\n  const [deleteConfirmId, setDeleteConfirmId] = useState(null);\r\n  const [showClearModal, setShowClearModal] = useState(false);\r\n\r\n  // Persist session questions\r\n  useEffect(() => setSecureItem(\"ue5_gen_questions\", questions), [questions]);\r\n\r\n  // Sync questions across browser tabs via storage event\r\n  useEffect(() => {\r\n    const handleStorageChange = (e) => {\r\n      if (e.key === \"ue5_gen_questions\" && e.newValue) {\r\n        try {\r\n          const newQuestions = JSON.parse(e.newValue);\r\n          console.log(\r\n            `≡ƒöä Syncing ${newQuestions.length} questions from another tab...`\r\n          );\r\n          setQuestions(newQuestions);\r\n        } catch (err) {\r\n          console.error(\"Failed to sync questions from storage:\", err);\r\n        }\r\n      }\r\n    };\r\n\r\n    window.addEventListener(\"storage\", handleStorageChange);\r\n    return () => window.removeEventListener(\"storage\", handleStorageChange);\r\n  }, []);\r\n\r\n  // Backfill creatorName on questions missing it\r\n  useEffect(() => {\r\n    if (!config.creatorName) return; // No name to backfill with\r\n\r\n    const questionsNeedingBackfill = questions.filter(\r\n      (q) =>\r\n        !q.creatorName || q.creatorName === \"N/A\" || q.creatorName === \"Unknown\"\r\n    );\r\n    if (questionsNeedingBackfill.length > 0) {\r\n      console.log(\r\n        `≡ƒô¥ Backfilling creatorName on ${questionsNeedingBackfill.length} questions...`\r\n      );\r\n      setQuestions((prev) =>\r\n        prev.map((q) => {\r\n          if (\r\n            !q.creatorName ||\r\n            q.creatorName === \"N/A\" ||\r\n            q.creatorName === \"Unknown\"\r\n          ) {\r\n            return { ...q, creatorName: config.creatorName };\r\n          }\r\n          return q;\r\n        })\r\n      );\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [config.creatorName]); // Only run when creatorName changes\r\n\r\n  // Recompute allQuestionsMap - include databaseQuestions for inventory tracking\r\n  useEffect(() => {\r\n    const combined = [\r\n      ...questions,\r\n      ...historicalQuestions,\r\n      ...databaseQuestions,\r\n    ];\r\n    const newMap = new Map();\r\n    combined.forEach((q) => {\r\n      const id = q.uniqueId;\r\n      if (!newMap.has(id)) newMap.set(id, []);\r\n      // Dedupe by language within each uniqueId bucket to prevent double-counting\r\n      const variants = newMap.get(id);\r\n      const lang = q.language || \"English\";\r\n      if (!variants.some((v) => (v.language || \"English\") === lang)) {\r\n        variants.push(q);\r\n      }\r\n    });\r\n    setAllQuestionsMap(newMap);\r\n  }, [questions, historicalQuestions, databaseQuestions]);\r\n\r\n  // Translation Map\r\n  const translationMap = useMemo(() => {\r\n    const map = new Map();\r\n    Array.from(allQuestionsMap.keys()).forEach((uniqueId) => {\r\n      const variants = allQuestionsMap.get(uniqueId);\r\n      const langSet = new Set(variants.map((v) => v.language || \"English\"));\r\n      map.set(uniqueId, langSet);\r\n    });\r\n    return map;\r\n  }, [allQuestionsMap]);\r\n\r\n  // Helper to add questions with automatic cloud backup\r\n  const addQuestionsToState = useCallback(\r\n    async (newItems, isHistory = false, insertAfterId = null) => {\r\n      // Auto-save to Firestore for crash protection\r\n      if (newItems && newItems.length > 0) {\r\n        console.log(\r\n          `≡ƒÆ╛ Auto-saving ${newItems.length} questions to Firestore...`\r\n        );\r\n        const savePromises = newItems.map((q) =>\r\n          saveQuestionToFirestore(q).catch((err) => {\r\n            console.warn(`ΓÜá∩╕Å Failed to auto-save question ${q.uniqueId}:`, err);\r\n          })\r\n        );\r\n        await Promise.all(savePromises);\r\n        console.log(`Γ£ô Auto-saved ${newItems.length} questions to cloud`);\r\n      }\r\n\r\n      const targetSet = isHistory ? setHistoricalQuestions : setQuestions;\r\n      targetSet((prev) => {\r\n        const otherList = isHistory ? questions : historicalQuestions;\r\n        const uniqueNew = filterDuplicateQuestions(newItems, prev, otherList);\r\n\r\n        if (insertAfterId && uniqueNew.length > 0) {\r\n          // Find index to insert after\r\n          const idx = prev.findIndex(\r\n            (q) => q.id === insertAfterId || q.uniqueId === insertAfterId\r\n          );\r\n          if (idx !== -1) {\r\n            const newArr = [...prev];\r\n            newArr.splice(idx + 1, 0, ...uniqueNew);\r\n            return newArr;\r\n          }\r\n        }\r\n\r\n        return [...prev, ...uniqueNew];\r\n      });\r\n    },\r\n    [questions, historicalQuestions]\r\n  );\r\n\r\n  // Helper to update question\r\n  const updateQuestionInState = useCallback((id, updateFn) => {\r\n    let foundInQuestions = false;\r\n    setQuestions((prev) => {\r\n      const idx = prev.findIndex((q) => q.id === id);\r\n      if (idx === -1) return prev;\r\n      foundInQuestions = true;\r\n      const newArr = [...prev];\r\n      newArr[idx] = updateFn(newArr[idx]);\r\n      return newArr;\r\n    });\r\n\r\n    if (!foundInQuestions) {\r\n      setHistoricalQuestions((prev) => {\r\n        const idx = prev.findIndex((q) => q.id === id);\r\n        if (idx === -1) return prev;\r\n        const newArr = [...prev];\r\n        newArr[idx] = updateFn(newArr[idx]);\r\n        return newArr;\r\n      });\r\n    }\r\n  }, []);\r\n\r\n  // Status update handler - now accepts optional rejection reason\r\n  const handleUpdateStatus = useCallback(\r\n    (id, newStatus, rejectionReason = null) => {\r\n      updateQuestionInState(id, (q) => {\r\n        const updatedQ = {\r\n          ...q,\r\n          status: newStatus,\r\n          critique: newStatus === \"accepted\" ? null : q.critique,\r\n          // Store rejection reason if provided\r\n          rejectionReason: newStatus === \"rejected\" ? rejectionReason : null,\r\n          rejectedAt:\r\n            newStatus === \"rejected\" ? new Date().toISOString() : null,\r\n        };\r\n\r\n        // Sync to Firestore\r\n        saveQuestionToFirestore(updatedQ).catch((err) =>\r\n          console.error(\"Firestore sync failed:\", err)\r\n        );\r\n\r\n        return updatedQ;\r\n      });\r\n    },\r\n    [updateQuestionInState]\r\n  );\r\n\r\n  // Statistics - count both pending and accepted questions for generation target\r\n  const approvedCounts = useMemo(() => {\r\n    const counts = CATEGORY_KEYS.reduce(\r\n      (acc, key) => ({ ...acc, [key]: 0 }),\r\n      {}\r\n    );\r\n    const countedIds = new Set();\r\n\r\n    Array.from(allQuestionsMap.values()).forEach((variants) => {\r\n      const baseQ =\r\n        variants.find((v) => (v.language || \"English\") === \"English\") ||\r\n        variants[0];\r\n\r\n      // Count both pending and accepted questions for generation targets\r\n      // This ensures newly generated questions update the counter immediately\r\n      const isCountable =\r\n        baseQ &&\r\n        (baseQ.status === \"accepted\" ||\r\n          baseQ.status === \"pending\" ||\r\n          !baseQ.status) &&\r\n        !countedIds.has(baseQ.uniqueId) &&\r\n        baseQ.discipline === config.discipline;\r\n\r\n      if (isCountable) {\r\n        const typeAbbrev = baseQ.type === \"True/False\" ? \"T/F\" : \"MC\";\r\n        const key = `${baseQ.difficulty} ${typeAbbrev}`;\r\n        if (Object.prototype.hasOwnProperty.call(counts, key)) {\r\n          counts[key]++;\r\n          countedIds.add(baseQ.uniqueId);\r\n        }\r\n      }\r\n    });\r\n    return counts;\r\n  }, [allQuestionsMap, config.discipline]);\r\n\r\n  const allItems = useMemo(\r\n    () => [...questions, ...historicalQuestions],\r\n    [questions, historicalQuestions]\r\n  );\r\n\r\n  const approvedCount = useMemo(\r\n    () => allItems.filter((q) => q.status === \"accepted\").length,\r\n    [allItems]\r\n  );\r\n  const rejectedCount = useMemo(\r\n    () => allItems.filter((q) => q.status === \"rejected\").length,\r\n    [allItems]\r\n  );\r\n  const pendingCount = useMemo(\r\n    () => allItems.filter((q) => !q.status || q.status === \"pending\").length,\r\n    [allItems]\r\n  );\r\n\r\n  const totalApproved = useMemo(() => {\r\n    return CATEGORY_KEYS.reduce((sum, key) => sum + approvedCounts[key], 0);\r\n  }, [approvedCounts]);\r\n\r\n  const overallPercentage = useMemo(() => {\r\n    return Math.min(100, (totalApproved / TARGET_TOTAL) * 100);\r\n  }, [totalApproved]);\r\n\r\n  // Check if global quota is reached\r\n  const isGlobalQuotaMet = useMemo(() => {\r\n    return totalApproved >= TARGET_TOTAL;\r\n  }, [totalApproved]);\r\n\r\n  // Calculate per-difficulty totals (combining MC and T/F)\r\n  const difficultyTotals = useMemo(() => {\r\n    return {\r\n      Easy:\r\n        (approvedCounts[\"Easy MC\"] || 0) + (approvedCounts[\"Easy T/F\"] || 0),\r\n      Medium:\r\n        (approvedCounts[\"Medium MC\"] || 0) +\r\n        (approvedCounts[\"Medium T/F\"] || 0),\r\n      Hard:\r\n        (approvedCounts[\"Hard MC\"] || 0) + (approvedCounts[\"Hard T/F\"] || 0),\r\n    };\r\n  }, [approvedCounts]);\r\n\r\n  // Target per difficulty level (2 categories * TARGET_PER_CATEGORY = 66 per difficulty)\r\n  const TARGET_PER_DIFFICULTY = TARGET_PER_CATEGORY * 2; // 66\r\n\r\n  const isTargetMet = useMemo(() => {\r\n    // Always block if global quota is reached\r\n    if (isGlobalQuotaMet) return true;\r\n\r\n    if (config.difficulty === \"Balanced All\") return false;\r\n\r\n    // Check if this difficulty level is full (both MC + T/F combined)\r\n    const currentCount = difficultyTotals[config.difficulty] || 0;\r\n    return currentCount >= TARGET_PER_DIFFICULTY;\r\n  }, [config.difficulty, difficultyTotals, isGlobalQuotaMet]);\r\n\r\n  const maxBatchSize = useMemo(() => {\r\n    // If global quota is met, no generation allowed\r\n    if (isGlobalQuotaMet) return 0;\r\n\r\n    if (config.difficulty === \"Balanced All\") {\r\n      const maxRemaining = Math.max(\r\n        ...CATEGORY_KEYS.map((key) => TARGET_PER_CATEGORY - approvedCounts[key])\r\n      );\r\n      if (maxRemaining <= 0) return 0;\r\n      return Math.min(30, Math.floor(TARGET_TOTAL / 6) * 6);\r\n    } else {\r\n      // Calculate remaining for this difficulty level\r\n      const currentCount = difficultyTotals[config.difficulty] || 0;\r\n      const remaining = TARGET_PER_DIFFICULTY - currentCount;\r\n      // Also cap by remaining global quota\r\n      const globalRemaining = TARGET_TOTAL - totalApproved;\r\n      return Math.min(33, Math.max(0, remaining), Math.max(0, globalRemaining));\r\n    }\r\n  }, [\r\n    config.difficulty,\r\n    approvedCounts,\r\n    difficultyTotals,\r\n    isGlobalQuotaMet,\r\n    totalApproved,\r\n  ]);\r\n\r\n  // Delete Handlers\r\n  const handleDelete = (id) => setDeleteConfirmId(id);\r\n\r\n  const confirmDelete = (reason = \"Unknown\") => {\r\n    if (deleteConfirmId) {\r\n      // Find the question before deleting to log it\r\n      const questionToDelete =\r\n        allQuestionsMap.get(deleteConfirmId)?.[0] ||\r\n        questions.find((q) => q.id === deleteConfirmId) ||\r\n        historicalQuestions.find((q) => q.id === deleteConfirmId);\r\n\r\n      if (questionToDelete) {\r\n        logQuestion({\r\n          ...questionToDelete,\r\n          status: \"deleted\",\r\n          deletionReason: reason,\r\n          deletedAt: new Date().toISOString(),\r\n        });\r\n      }\r\n\r\n      console.log(`Deleting question ${deleteConfirmId}. Reason: ${reason}`);\r\n      setQuestions((prev) => prev.filter((q) => q.id !== deleteConfirmId));\r\n      setHistoricalQuestions((prev) =>\r\n        prev.filter((q) => q.id !== deleteConfirmId)\r\n      );\r\n      if (showMessage) showMessage(`Question deleted: ${reason}`, 2000);\r\n      setDeleteConfirmId(null);\r\n    }\r\n  };\r\n\r\n  const handleDeleteAllQuestions = () => {\r\n    setShowClearModal(false);\r\n    setQuestions([]);\r\n    setHistoricalQuestions([]);\r\n    if (showMessage) showMessage(\"Local session cleared.\", 3000);\r\n  };\r\n\r\n  const checkAndStoreQuestions = async (newQuestions) => {\r\n    return newQuestions;\r\n  };\r\n\r\n  // PERFORMANCE: Load more questions\r\n  const _loadMoreQuestions = useCallback(\r\n    async (userId) => {\r\n      if (!hasMore || isLoadingMore) return;\r\n\r\n      setIsLoadingMore(true);\r\n      try {\r\n        const {\r\n          questions: moreQuestions,\r\n          lastDoc: newLastDoc,\r\n          hasMore: moreAvailable,\r\n        } = await getQuestionsPaginated(userId, 20, lastDoc);\r\n\r\n        setDatabaseQuestions((prev) => [...prev, ...moreQuestions]);\r\n        setLastDoc(newLastDoc);\r\n        setHasMore(moreAvailable);\r\n      } catch (error) {\r\n        console.error(\"Failed to load more questions:\", error);\r\n      } finally {\r\n        setIsLoadingMore(false);\r\n      }\r\n    },\r\n    [hasMore, isLoadingMore, lastDoc]\r\n  );\r\n\r\n  return {\r\n    questions,\r\n    setQuestions,\r\n    historicalQuestions,\r\n    setHistoricalQuestions,\r\n    databaseQuestions,\r\n    setDatabaseQuestions,\r\n    allQuestionsMap,\r\n    translationMap,\r\n    addQuestionsToState,\r\n    updateQuestionInState,\r\n    handleUpdateStatus,\r\n    approvedCounts,\r\n    approvedCount,\r\n    rejectedCount,\r\n    pendingCount,\r\n    totalApproved,\r\n    overallPercentage,\r\n    isTargetMet,\r\n    maxBatchSize,\r\n    deleteConfirmId,\r\n    setDeleteConfirmId,\r\n    showClearModal,\r\n    setShowClearModal,\r\n    handleDelete,\r\n    confirmDelete,\r\n    handleDeleteAllQuestions,\r\n    checkAndStoreQuestions,\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\useReviewActions.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\useToast.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\hooks\\useTutorial.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\main.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\services\\cloudFunctions.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\services\\firebase.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\services\\gemini.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\services\\geminiSecure.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\services\\googleSheets.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\services\\googleSheets.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\services\\inviteService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\services\\promptBuilder.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\services\\scormExporter.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\setupTests.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\analyticsStore.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\answerValidator.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\constants.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\contextOptimizer.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\csrf.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\databaseCleanup.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'query' is defined but never used. Allowed unused vars must match /^_/u.","line":7,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":8,"suggestions":[{"messageId":"removeVar","data":{"varName":"query"},"fix":{"range":[65,74],"text":""},"desc":"Remove unused variable 'query'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'where' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":8,"suggestions":[{"messageId":"removeVar","data":{"varName":"where"},"fix":{"range":[74,83],"text":""},"desc":"Remove unused variable 'where'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\n  collection,\n  getDocs,\n  updateDoc,\n  deleteDoc,\n  doc,\n  query,\n  where,\n} from \"firebase/firestore\";\nimport { db } from \"../services/firebase\";\n\n/**\n * Production Database Cleanup Tool\n * Run this from the browser console in production to:\n * 1. Fix missing status fields\n * 2. Remove duplicates\n * 3. Remove excess questions beyond quota\n */\nexport const cleanupProductionDatabase = async () => {\n  console.log(\"≡ƒöì Starting database cleanup...\");\n\n  const questionsRef = collection(db, \"questions\");\n  const snapshot = await getDocs(questionsRef);\n\n  console.log(`≡ƒôè Found ${snapshot.size} total questions`);\n\n  // Step 1: Fix missing status\n  let statusFixed = 0;\n  const updatePromises = [];\n\n  snapshot.forEach((docSnap) => {\n    const data = docSnap.data();\n    if (!data.status || data.status === \"\") {\n      updatePromises.push(\n        updateDoc(doc(db, \"questions\", docSnap.id), { status: \"pending\" })\n      );\n      statusFixed++;\n    }\n  });\n\n  await Promise.all(updatePromises);\n  console.log(`Γ£à Fixed ${statusFixed} status fields`);\n\n  // Step 2: Remove duplicates\n  const uniqueMap = new Map();\n  snapshot.forEach((docSnap) => {\n    const data = docSnap.data();\n    const uniqueId = data.uniqueId || docSnap.id;\n\n    if (!uniqueMap.has(uniqueId)) {\n      uniqueMap.set(uniqueId, []);\n    }\n    uniqueMap.get(uniqueId).push({\n      id: docSnap.id,\n      dateAdded: data.dateAdded || \"\",\n      data,\n    });\n  });\n\n  let duplicatesRemoved = 0;\n  const deletePromises = [];\n\n  uniqueMap.forEach((variants) => {\n    if (variants.length > 1) {\n      // Sort by date (oldest first)\n      variants.sort((a, b) => a.dateAdded.localeCompare(b.dateAdded));\n      // Delete all except first\n      variants.slice(1).forEach((variant) => {\n        deletePromises.push(deleteDoc(doc(db, \"questions\", variant.id)));\n        duplicatesRemoved++;\n      });\n    }\n  });\n\n  await Promise.all(deletePromises);\n  console.log(`Γ£à Removed ${duplicatesRemoved} duplicates`);\n\n  // Step 3: Remove excess questions\n  const quotaMap = new Map();\n  const freshSnapshot = await getDocs(questionsRef);\n\n  freshSnapshot.forEach((docSnap) => {\n    const data = docSnap.data();\n    const discipline = data.discipline || \"Unknown\";\n    let difficulty = data.difficulty || \"Unknown\";\n    let qtype = data.type || \"Unknown\";\n\n    // Normalize\n    if (difficulty === \"Easy\") difficulty = \"Beginner\";\n    if (difficulty === \"Medium\") difficulty = \"Intermediate\";\n    if (difficulty === \"Hard\") difficulty = \"Expert\";\n    if (qtype === \"T/F\" || qtype === \"True/False\") qtype = \"T/F\";\n    else qtype = \"MC\";\n\n    const key = `${discipline}|${difficulty}|${qtype}`;\n    if (!quotaMap.has(key)) quotaMap.set(key, []);\n\n    quotaMap.get(key).push({\n      id: docSnap.id,\n      dateAdded: data.dateAdded || \"\",\n      status: data.status || \"pending\",\n    });\n  });\n\n  const QUOTA = 33;\n  let excessRemoved = 0;\n  const excessDeletePromises = [];\n\n  quotaMap.forEach((questions, key) => {\n    if (questions.length > QUOTA) {\n      const [discipline, difficulty, qtype] = key.split(\"|\");\n      console.log(\n        `ΓÜá∩╕Å ${discipline} ${difficulty} ${qtype}: ${questions.length} (quota: ${QUOTA})`\n      );\n\n      // Sort: accepted first, then by date\n      questions.sort((a, b) => {\n        if (a.status === \"accepted\" && b.status !== \"accepted\") return -1;\n        if (a.status !== \"accepted\" && b.status === \"accepted\") return 1;\n        return a.dateAdded.localeCompare(b.dateAdded);\n      });\n\n      // Delete excess (from end)\n      questions.slice(QUOTA).forEach((q) => {\n        excessDeletePromises.push(deleteDoc(doc(db, \"questions\", q.id)));\n        excessRemoved++;\n      });\n    }\n  });\n\n  await Promise.all(excessDeletePromises);\n  console.log(`Γ£à Removed ${excessRemoved} excess questions`);\n\n  console.log(`\\n≡ƒÄë Cleanup complete!`);\n  console.log(`   Status fixes: ${statusFixed}`);\n  console.log(`   Duplicates: ${duplicatesRemoved}`);\n  console.log(`   Excess: ${excessRemoved}`);\n  console.log(`   Total: ${statusFixed + duplicatesRemoved + excessRemoved}`);\n\n  return {\n    statusFixed,\n    duplicatesRemoved,\n    excessRemoved,\n    total: statusFixed + duplicatesRemoved + excessRemoved,\n  };\n};\n\n// Make it available globally in production\nif (typeof window !== \"undefined\") {\n  window.cleanupProductionDatabase = cleanupProductionDatabase;\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\dateHelpers.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\exportUtils.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\exportUtils.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\fileProcessor.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\fileProcessor.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\helpers.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\metricsUtils.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\questionFilters.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\questionFilters.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\questionHelpers.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\questionHistory.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\questionValidator.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\quotaEnforcement.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\rateLimitState.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\sanitize.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\secureStorage.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\security.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\stringHelpers.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\tagTaxonomy.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\tokenCounter.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\tokenCounter.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\tutorialSteps.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\urlValidator.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\src\\utils\\validation.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\temp_scorm12_extract\\game.js","messages":[{"ruleId":"prefer-const","severity":1,"message":"'debugAccessState' is never reassigned. Use 'const' instead.","line":11,"column":9,"nodeType":"Identifier","messageId":"useConst","endLine":11,"endColumn":25,"fix":{"range":[561,679],"text":"const debugAccessState = {\n        passwordModalVisible: false // Tracks if the password input is currently shown\n    };"}},{"ruleId":"no-unused-vars","severity":1,"message":"'headerControls' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":17,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'ticketViewColumn' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":17,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":54},{"ruleId":"no-unused-vars","severity":1,"message":"'reason' is assigned a value but never used. Allowed unused args must match /^_/u.","line":123,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":123,"endColumn":35,"suggestions":[{"messageId":"removeVar","data":{"varName":"reason"},"fix":{"range":[4910,4921],"text":""},"desc":"Remove unused variable 'reason'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":168,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":168,"endColumn":15},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":168,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":168,"endColumn":19,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[6950,6950],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":440,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":440,"endColumn":23},{"ruleId":"prefer-const","severity":1,"message":"'totalLoggedTime' is never reassigned. Use 'const' instead.","line":496,"column":17,"nodeType":"Identifier","messageId":"useConst","endLine":496,"endColumn":32,"fix":{"range":[18898,18998],"text":"const totalLoggedTime = Object.values(initialScenarioState).reduce((acc, s) => acc + s.loggedTime, 0);"}},{"ruleId":"no-unused-vars","severity":1,"message":"'isTestRunning' is defined but never used. Allowed unused vars must match /^_/u.","line":537,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":537,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"isTestRunning"},"fix":{"range":[20802,20953],"text":""},"desc":"Remove unused variable 'isTestRunning'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'resetAllScenarioState' is defined but never used. Allowed unused vars must match /^_/u.","line":699,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":699,"endColumn":35,"suggestions":[{"messageId":"removeVar","data":{"varName":"resetAllScenarioState"},"fix":{"range":[26925,27281],"text":""},"desc":"Remove unused variable 'resetAllScenarioState'."}]},{"ruleId":"prefer-const","severity":1,"message":"'totalLoggedTime' is never reassigned. Use 'const' instead.","line":1056,"column":17,"nodeType":"Identifier","messageId":"useConst","endLine":1056,"endColumn":32,"fix":{"range":[40787,40880],"text":"const totalLoggedTime = Object.values(scenarioState).reduce((acc, s) => acc + s.loggedTime, 0);"}},{"ruleId":"no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":1212,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":1212,"endColumn":15},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":1212,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":1212,"endColumn":19,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[47513,47513],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":3,"source":"// Wait for the DOM to be fully loaded before running the game logic\ndocument.addEventListener('DOMContentLoaded', () => {\n\n    // --- GLOBAL CONFIGURATION ---\n    const TOTAL_TEST_TIME_SECONDS = 30 * 60; // Total 30 minutes for the assessment countdown timer\n    const LOW_TIME_WARNING_SECONDS = 5 * 60; // Time remaining threshold to trigger pulsing red timer\n    const PASS_THRESHOLD = 0.80; // Pass if (Ideal Time / Logged Time) >= 80%\n    const DEBUG_PASSWORD = 'IloveUnreal'; // Secret password to enable Debug Mode\n\n    // --- DEBUG ACCESS STATE ---\n    let debugAccessState = {\n        passwordModalVisible: false // Tracks if the password input is currently shown\n    };\n\n    // --- DOM ELEMENT CACHE ---\n    // Note: Removed unused variables related to audit features and hard reset UI.\n    let headerControls, backlogList, ticketViewColumn, ticketPlaceholder, \n        ticketContent, ticketTitle, ticketDescription, ticketStepContent,\n        debugToggle, countdownTimer, jiraBoard, timesUpScreen, \n        debugDropdown; \n    \n    let timerContainer; // Parent container for the countdown timer\n\n    // --- CORE GAME STATE ---\n    let scenarioState = {}; // Stores progress, time logged, and choices for each scenario (Ticket)\n    let currentScenarioId = null; // Key of the scenario currently displayed (e.g., 'golem')\n    let currentStepId = null; // Key of the current question step within the scenario\n    let interruptedSteps = {}; // Stores the last active step for non-completed scenarios\n    let isDebugMode = false; // Flag for debug visualization/controls\n    let mainTimerInterval = null; // ID for the setInterval used for the 30-minute countdown\n    \n    let timeRemaining = TOTAL_TEST_TIME_SECONDS; // Remaining time on the countdown timer// === SCORM 1.2 INTEGRATION (LMS Bridge) ===\nconst LMS = {\n    enabled: false,\n    sessionStart: Date.now(),\n    lastHeartbeat: 0\n};\ntry {\n    if (window.SCORM12 && window.SCORM12.init()) {\n        LMS.enabled = true;\n        // If LMS has a saved location, optionally use it\n        // We'll rely on suspend_data for full state recovery\n    }\n} catch (e) { console.warn(\"SCORM init failed or not present.\", e); }\n\n// Base64 decode utility (Unicode-safe)\nfunction base64DecodeUnicode(str) {\n    try {\n        const binary = atob(str);\n        const utf8 = Array.prototype.map.call(binary, c => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)).join('');\n        return decodeURIComponent(utf8);\n    } catch (e) {\n        console.warn(\"Failed to decode base64 suspend_data:\", e);\n        return \"\";\n    }\n}\n\n// Build a compact object we can store in cmi.suspend_data (max ~4KB in SCORM 1.2)\nfunction lmsBuildSuspendObj() {\n    const compact = { v: 1, t: timeRemaining, i: interruptedSteps || {}, a: null, s: {} };\n    if (currentScenarioId && currentStepId) {\n        compact.a = { s: currentScenarioId, st: currentStepId };\n    }\n    // Only store minimal state: completed flag + choicesMade for each scenario\n    Object.keys(scenarioState || {}).forEach(id => {\n        const st = scenarioState[id] || {};\n        compact.s[id] = { c: !!st.completed, ch: st.choicesMade || {} };\n    });\n    return compact;\n}\n\nfunction lmsPackSuspendData() {\n    const json = JSON.stringify(lmsBuildSuspendObj());\n    return base64EncodeUnicode(json);\n}\n\nfunction lmsUnpackSuspendData() {\n    if (!LMS.enabled) return null;\n    const raw = window.SCORM12.getValue(\"cmi.suspend_data\") || \"\";\n    if (!raw) return null;\n    try {\n        const json = base64DecodeUnicode(raw);\n        return JSON.parse(json);\n    } catch (e) {\n        console.warn(\"Bad suspend_data JSON:\", e);\n        return null;\n    }\n}\n\nfunction lmsApplySuspendDataIfAvailable() {\n    if (!LMS.enabled) return;\n    const data = lmsUnpackSuspendData();\n    if (!data) return;\n    // Restore time remaining if present\n    if (typeof data.t === 'number' && isFinite(data.t)) {\n        timeRemaining = Math.max(0, Math.floor(data.t));\n    }\n    // Restore interrupted steps\n    if (data.i && typeof data.i === 'object') {\n        interruptedSteps = data.i;\n    }\n    // Restore scenario state (choices + completed)\n    if (data.s && typeof data.s === 'object') {\n        Object.keys(data.s).forEach(id => {\n            if (!scenarioState[id]) {\n                scenarioState[id] = { completed: false, loggedTime: 0, choicesMade: {} };\n            }\n            const rec = data.s[id];\n            scenarioState[id].completed = !!rec.c;\n            scenarioState[id].choicesMade = rec.ch || {};\n        });\n        // Recompute loggedTime from choices (existing helper already does that on load, but recompute for safety)\n        saveScenarioState(); // persist changes locally too\n    }\n    // Restore active\n    if (data.a && data.a.s && data.a.st) {\n        currentScenarioId = data.a.s;\n        currentStepId = data.a.st;\n    }\n}\n\nlet lmsCommitTimer = null;\nfunction lmsSchedulePersist(reason = \"\") {\n    if (!LMS.enabled) return;\n    if (lmsCommitTimer) return; // coalesce bursts\n    lmsCommitTimer = setTimeout(() => {\n        try {\n            const packed = lmsPackSuspendData();\n            // Hard guard for SCORM 1.2 size limits (~4096). If too big, drop active pointers but keep essentials.\n            if (packed.length > 3900) {\n                const minimal = { v:1, t: timeRemaining, s: {} };\n                Object.keys(scenarioState).forEach(id => {\n                    const st = scenarioState[id];\n                    minimal.s[id] = { c: !!st.completed }; // omit choices if too large\n                });\n                const fallback = base64EncodeUnicode(JSON.stringify(minimal));\n                window.SCORM12.setValue(\"cmi.suspend_data\", fallback);\n            } else {\n                window.SCORM12.setValue(\"cmi.suspend_data\", packed);\n            }\n            window.SCORM12.setValue(\"cmi.core.lesson_location\", currentScenarioId ? (currentScenarioId + \"|\" + (currentStepId || \"\")) : \"\");\n            window.SCORM12.commit();\n        } catch (e) {\n            console.warn(\"LMS persist failed:\", e);\n        } finally {\n            lmsCommitTimer = null;\n        }\n    }, 1200);\n}\n\n// On unload, write session time and finalize connection\nwindow.addEventListener('beforeunload', () => {\n    try {\n        const elapsedSec = Math.max(0, Math.floor((Date.now() - LMS.sessionStart) / 1000));\n        if (LMS.enabled) {\n            window.SCORM12.setSessionTimeSeconds(elapsedSec);\n            // If not finished, indicate suspend\n            const allComplete = Object.values(scenarioState || {}).every(s => s.completed);\n            if (!allComplete) {\n                window.SCORM12.setValue(\"cmi.core.exit\", \"suspend\");\n            } else {\n                window.SCORM12.setValue(\"cmi.core.exit\", \"\");\n            }\n            window.SCORM12.setValue(\"cmi.suspend_data\", lmsPackSuspendData());\n            window.SCORM12.commit();\n            window.SCORM12.finish();\n        }\n    } catch (e) {}\n});\n\n\n    \n\t// --- ENCODING UTILITIES (Restored for Test Key Generation) ---\n    /**\n     * Encodes a string to a Unicode-safe Base64 string.\n     * @param {string} str - The string to encode.\n     * @returns {string} The Base64 encoded string.\n     */\n    function base64EncodeUnicode(str) {\n        const utf8Bytes = encodeURIComponent(str).replace(/%([0-9A-F]{2})/g,\n            function(match, p1) {\n                return String.fromCharCode('0x' + p1);\n            });\n            return btoa(utf8Bytes);\n    }\n    \n\t// --- TIMER & TIME UTILITIES ---\n    \n    /**\n     * Converts total seconds into MM:SS format for display.\n     * @param {number} totalSeconds - Total seconds remaining.\n     * @returns {string} Formatted time string (MM:SS).\n     */\n    function formatTime(totalSeconds) {\n        const minutes = Math.floor(totalSeconds / 60);\n        const seconds = Math.floor(totalSeconds % 60);\n        return `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;\n    }\n\n    /**\n     * Calculates the time cost in hours based on the choice type.\n     * @param {string} type - 'correct', 'partial', 'misguided', 'wrong'.\n     * @returns {number} Time cost in hours.\n     */\n    function getTimeCostForChoice(type) {\n        switch (type) {\n            case 'correct':\n                return 0.5; // Optimal\n            case 'partial':\n                return 1.0; // Standard\n            case 'misguided':\n                return 1.5; // Extended\n            case 'wrong':\n                return 2.0; // Maximum\n            default:\n                return 0;\n        }\n    }\n\n    // --- TIMER LOGIC ---\n    \n    /**\n     * Updates the main timer display, applies visual cues, and handles expiry.\n     */\n    function updateMainTimerDisplay() {\n        // 1. Update Display\n        countdownTimer.textContent = formatTime(timeRemaining);\n        \n        // 2. Update Color/Pulse based on time left\n        countdownTimer.classList.remove('pulse-red', 'text-blue-300', 'text-yellow-400', 'text-orange-400', 'text-green-500');\n        if (timeRemaining <= LOW_TIME_WARNING_SECONDS && timeRemaining > 0) {\n            countdownTimer.classList.add('text-yellow-400', 'pulse-red');\n        } else if (timeRemaining > 0) {\n            countdownTimer.classList.add('text-blue-300');\n        }\n\n        // 3. Time's Up Check\n        if (timeRemaining <= 0) {\n            endGameByTime();\n            return;\n        }\n\n        // 4. Decrement\n        timeRemaining--;\n        \n        // 5. Save remaining time to Local Storage\n        // Throttled persistence (every ~15s) and LMS commit coalesced\nif (LMS.enabled) {\n    lmsSchedulePersist(\"heartbeat\");\n} else {\n    if (!window.__timerPersistCounter) window.__timerPersistCounter = 0;\n    window.__timerPersistCounter++;\n    if (window.__timerPersistCounter % 15 === 0) {\n        localStorage.setItem('ue5ScenarioTimer', timeRemaining.toString());\n    }\n}\n    }\n\n    /**\n     * Starts the main 30-minute countdown timer.\n     */\n    function startMainTimer(isInitialStart = false) {\n        // Load time state\nif (isInitialStart) {\n    timeRemaining = TOTAL_TEST_TIME_SECONDS;\n    if (!LMS.enabled) {\n        localStorage.removeItem('ue5ScenarioTimer');\n    }\n} else {\n    if (LMS.enabled) {\n        const d = lmsUnpackSuspendData();\n        if (d && typeof d.t === 'number') {\n            timeRemaining = Math.max(0, Math.floor(d.t));\n        } else {\n            timeRemaining = TOTAL_TEST_TIME_SECONDS;\n        }\n    } else {\n        const savedTime = localStorage.getItem('ue5ScenarioTimer');\n        if (savedTime !== null) {\n            timeRemaining = parseInt(savedTime, 10);\n        } else {\n            timeRemaining = TOTAL_TEST_TIME_SECONDS;\n        }\n    }\n}\n\n            // CRITICAL FIX: Ensure timer container is visible if time is > 0\n        if (timerContainer && timeRemaining > 0) {\n            timerContainer.classList.remove('hidden');\n        }\n\n        if (mainTimerInterval) clearInterval(mainTimerInterval);\n        \n        if (timeRemaining > 0) {\n             updateMainTimerDisplay(); // Initial display update\n             mainTimerInterval = setInterval(updateMainTimerDisplay, 1000); // Start the 1-second interval\n        } else {\n             endGameByTime(); // Time already ran out\n        }\n    }\n    \n    /**\n     * Pauses the countdown timer without clearing state.\n     */\n    function pauseMainTimer() {\n        if (mainTimerInterval) {\n            clearInterval(mainTimerInterval);\n            mainTimerInterval = null;\n        }\n    }\n    \n    /**\n     * Resumes the countdown timer only if the assessment is incomplete.\n     */\n    function resumeMainTimer() {\n        if (!mainTimerInterval) {\n            const allComplete = Object.values(scenarioState).every(state => state.completed);\n            if (!allComplete) {\n                mainTimerInterval = setInterval(updateMainTimerDisplay, 1000);\n            }\n        }\n    }\n\n    // --- CORE GAME INITIALIZATION ---\n\n    /**\n     * Toggles the Debug Mode state and updates the UI visibility.\n     */\n    function toggleDebugMode(forceDisable = false) {\n        if (forceDisable) {\n            isDebugMode = false;\n        } else {\n            isDebugMode = !isDebugMode;\n        }\n        \n        // Manually toggle UI state\n        if (debugDropdown) {\n            debugDropdown.classList.toggle('hidden', !isDebugMode);\n        }\n        \n        // Update internal logic based on new mode\n        if (isDebugMode) {\n            pauseMainTimer();\n            // Allow copying/inspection in debug mode\n            document.body.classList.remove('unselectable');\n        } else {\n            resumeMainTimer();\n            // Re-enable security when exiting debug mode\n            document.body.classList.add('unselectable');\n        }\n        \n        // Update the visual status of the hidden toggle (for consistency)\n        if (debugToggle) {\n            debugToggle.checked = isDebugMode;\n        }\n        \n        // Re-render current step to show/hide hints if a ticket is open\n        if (currentScenarioId && currentStepId) {\n            renderStep(currentScenarioId, currentStepId);\n        }\n    }\n\n    /**\n     * Shows the password input modal when the secret key combination is pressed.\n     */\n    function showPasswordModal() {\n        if (debugAccessState.passwordModalVisible) return;\n        debugAccessState.passwordModalVisible = true;\n\n        const modalHtml = `\n            <div id=\"password-modal\" class=\"fixed inset-0 bg-gray-900 bg-opacity-75 z-[999] flex items-center justify-center\">\n                <div class=\"bg-gray-800 p-8 rounded-xl shadow-2xl text-center max-w-sm w-full\">\n                    <h3 class=\"text-xl font-bold text-blue-400 mb-4\">Administrator Access Required</h3>\n                    <p class=\"text-gray-300 mb-6\">Enter the password to enable Debug Mode:</p>\n                    <input type=\"password\" id=\"password-input\" placeholder=\"Password...\" \n                           class=\"w-full p-3 rounded-lg bg-gray-700 border border-gray-600 text-yellow-300 focus:ring-blue-500 focus:border-blue-500 text-center mb-4\">\n                    <div class=\"flex justify-around space-x-3\">\n                        <button id=\"submit-password\" class=\"flex-1 bg-green-600 hover:bg-green-700 text-white font-semibold py-2 rounded-lg transition-all duration-200\">\n                            Enable\n                        </button>\n                        <button id=\"cancel-password\" class=\"flex-1 bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 rounded-lg transition-all duration-200\">\n                            Cancel\n                        </button>\n                    </div>\n                </div>\n            </div>\n        `;\n        \n        document.body.insertAdjacentHTML('beforeend', modalHtml);\n\n        const modal = document.getElementById('password-modal');\n        const input = document.getElementById('password-input');\n        \n        input.focus();\n\n        const cleanup = () => {\n            modal.remove();\n            debugAccessState.passwordModalVisible = false;\n        };\n\n        const checkPassword = () => {\n            if (input.value === DEBUG_PASSWORD) {\n                toggleDebugMode(); // Enable Debug Mode\n                cleanup();\n            } else {\n                input.value = '';\n                input.placeholder = 'Incorrect Password!';\n                input.classList.add('ring-2', 'ring-red-500');\n                setTimeout(() => {\n                    input.classList.remove('ring-2', 'ring-red-500');\n                }, 1000);\n            }\n        };\n\n        document.getElementById('submit-password').addEventListener('click', checkPassword);\n        document.getElementById('cancel-password').addEventListener('click', cleanup);\n        input.addEventListener('keydown', (e) => {\n            if (e.key === 'Enter') {\n                checkPassword();\n            } else if (e.key === 'Escape') {\n                cleanup();\n            }\n        });\n    }\n\n\n    /**\n     * The primary entry point for setting up the game state.\n     */\n    function initializeApp() {\n        \n        // 1. --- AGGRESSIVE STATE CHECK AND RESET (Fixes infinite modal loop) ---\n        const savedStateJSON = localStorage.getItem('ue5ScenarioState');\n        let initialScenarioState = {};\n        let allCompleteOnLoad = false;\n        \n        if (savedStateJSON) {\n            try {\n                initialScenarioState = JSON.parse(savedStateJSON);\n            } catch (e) {\n                console.error(\"Initial load failed, resetting saved state.\");\n            }\n        }\n        \n        // Determine completion state based on potentially loaded data\n        if (Object.keys(initialScenarioState).length > 0) {\n             allCompleteOnLoad = Object.values(initialScenarioState).every(s => s.completed);\n        }\n        \n        // CRITICAL FIX: If completed, clear the state immediately so the next load starts clean.\n        let showCompletionModal = false;\n        if (allCompleteOnLoad) {\n            // We set a flag to show the modal *this time*\n            showCompletionModal = true;\n            \n            // Then, we clear the data immediately so the next load gets a clean start.\n            localStorage.removeItem('ue5ScenarioState'); // Clears the completion status\n            localStorage.removeItem('ue5InterruptedSteps');\n            localStorage.removeItem('ue5ActiveScenario');\n            localStorage.removeItem('ue5ActiveStep');\n            localStorage.removeItem('ue5ScenarioTimer'); \n        }\n        // --- END AGGRESSIVE STATE CHECK ---\n\n        // 2. Load data from local storage (this loads a default clean state if the state was just cleared above)\n        loadScenarioState();\n        loadInterruptedSteps();\n        // Apply LMS suspend_data state if available\n        lmsApplySuspendDataIfAvailable();\n\n        \n        // 3. Check for crash recovery / active scenario\n        const activeScenarioId = localStorage.getItem('ue5ActiveScenario');\n        const activeStepId = localStorage.getItem('ue5ActiveStep');\n        \n        // 4. Start the timer (handles loading saved time or 30:00)\n        startMainTimer();\n\n        // 5. Render the backlog\n        renderBacklog();\n        \n        // 6. Recover the active ticket view if the state was saved\n        if (activeScenarioId && activeStepId) {\n             selectScenario(activeScenarioId, activeStepId);\n        }\n        \n        // 7. If completed on load, stop the timer and show the final modal immediately.\n        if (showCompletionModal) { \n            if (timerContainer) {\n                timerContainer.classList.add('hidden');\n            }\n            toggleDebugMode(true); // Ensure debug mode is off\n            stopTimerOnComplete();\n            \n            // Use the initial state's data (which still holds the score) to show the final modal\n            let totalLoggedTime = Object.values(initialScenarioState).reduce((acc, s) => acc + s.loggedTime, 0);\n\n            showAssessmentModal('complete', totalLoggedTime, initialScenarioState); \n        }\n\n        // 8. Initialize debug UI state (Dropdown is always hidden on start)\n        if (debugDropdown) {\n             debugDropdown.classList.add('hidden');\n        }\n    }\n\t\n    // --- CORE INITIALIZATION HELPERS ---\n    \n    /**\n     * Finds and assigns all necessary DOM elements to global variables.\n     */\n    function cacheDOMElements() {\n        headerControls = document.getElementById('header-controls');\n        backlogList = document.getElementById('backlog-list');\n        ticketViewColumn = document.getElementById('ticket-view-column');\n        ticketPlaceholder = document.getElementById('ticket-placeholder');\n        ticketContent = document.getElementById('ticket-content');\n        ticketTitle = document.getElementById('ticket-title');\n        ticketDescription = document.getElementById('ticket-description');\n        ticketStepContent = document.getElementById('ticket-step-content');\n        debugToggle = document.getElementById('debug-toggle'); \n        countdownTimer = document.getElementById('countdown-timer');\n        jiraBoard = document.getElementById('jira-board');\n        timesUpScreen = document.getElementById('times-up-screen');\n        // 'restartTimerBtn' was unused and removed.\n        debugDropdown = document.getElementById('debug-dropdown'); \n        // 'testKeyInput', 'loadKeyBtn', 'hardResetBtn' were unused and removed.\n        \n        // Cache the timer's parent div for visibility control\n        timerContainer = countdownTimer ? countdownTimer.parentElement : null; \n    }\n    \n    /**\n     * Checks if the test is currently running (i.e., not fully completed).\n     * @returns {boolean} True if the assessment is not yet fully complete.\n     */\n    function isTestRunning() {\n        const allComplete = Object.values(scenarioState).every(state => state.completed);\n        return !allComplete;\n    }\n    \n    /**\n     * Attaches all primary event listeners.\n     */\n    function attachEventListeners() {\n        const hardResetBtn = document.getElementById('hard-reset-btn'); // Local variable for local usage\n        \n        // --- ADMIN ACCESS (CTRL + SHIFT + DELETE + Password Gate) ---\n        document.addEventListener('keydown', (e) => {\n            // Check for the combination: CTRL + SHIFT + DELETE (KeyCode 46 is Delete on most systems)\n            if (e.ctrlKey && e.shiftKey && (e.key === 'Delete' || e.keyCode === 46)) {\n                e.preventDefault();\n                // If Debug Mode is already on, the combination turns it off without a password\n                if (isDebugMode) {\n                    toggleDebugMode(true); // Force Disable\n                } else if (!debugAccessState.passwordModalVisible) {\n                    showPasswordModal();\n                }\n            }\n        });\n        \n        // --- SECURITY (Disable Right-Click Menu) ---\n        document.body.addEventListener('contextmenu', (e) => {\n            // Only block right-click if Debug Mode is OFF\n            if (!isDebugMode) {\n                 e.preventDefault(); \n            }\n        });\n        \n        // Debug: Hard Reset button handler (Wipes all local storage)\n        if (hardResetBtn) {\n            hardResetBtn.addEventListener('click', () => {\n                if (!confirm(\"WARNING: This will clear ALL progress, including saved completion data and the timer. Are you sure you want to restart the assessment completely?\")) return;\n\n                localStorage.removeItem('ue5ScenarioTimer');\n                localStorage.removeItem('ue5ScenarioState');\n                localStorage.removeItem('ue5InterruptedSteps');\n                localStorage.removeItem('ue5ActiveScenario');\n                localStorage.removeItem('ue5ActiveStep');\n                \n                location.reload();\n            });\n        }\n    }\n    \n    /**\n     * Calculates the total ideal time (0.5 hours per step) across all scenarios.\n     * @returns {{totalSteps: number, idealTotalTime: number}} The calculated totals.\n     */\n    function calculateTotalIdealTime() {\n        let totalSteps = 0;\n        \n        Object.values(window.SCENARIOS).forEach(scenario => {\n            if (scenario.steps) {\n                // Counting all steps, including dead ends, as they all represent an \"ideal\" 0.5hr time cost for a correct answer.\n                totalSteps += Object.keys(scenario.steps).length;\n            }\n        });\n        return {\n            totalSteps: totalSteps,\n            idealTotalTime: totalSteps * 0.5 \n        };\n    }\n\n    /**\n     * Serializes scenario choices into a compact, stable Base64 JSON string.\n     * @param {object} [stateToSerialize=scenarioState] - The state to serialize.\n     * @returns {string} The Base64 encoded test key.\n     */\n    function generateTestKey(stateToSerialize = scenarioState) {\n        const compactData = {};\n        \n        Object.keys(stateToSerialize).forEach(scenarioId => {\n            const state = stateToSerialize[scenarioId];\n            if (Object.keys(state.choicesMade).length > 0) {\n                // choicesMade contains the original (unshuffled) index, ensuring stability.\n                compactData[scenarioId] = state.choicesMade;\n            }\n        });\n        \n        if (Object.keys(compactData).length === 0) {\n            return \"No Choices Recorded\";\n        }\n\n        try {\n            const jsonString = JSON.stringify(compactData);\n            return base64EncodeUnicode(jsonString);\n        } catch (e) {\n            console.error(\"Failed to generate test key:\", e);\n            return \"ERROR_SERIALIZING_CHOICES\";\n        }\n    }\n\n\n    // --- STATE MANAGEMENT ---\n\n    /**\n     * Loads game state from localStorage, ensuring cleanup of old penalty/corrupted keys.\n     */\n    function loadScenarioState() {\n        const savedStateJSON = localStorage.getItem('ue5ScenarioState');\n        let savedState = {};\n\n        if (savedStateJSON) {\n            try {\n                savedState = JSON.parse(savedStateJSON);\n            } catch (e) {\n                console.error(\"Failed to parse saved state, resetting.\", e);\n                savedState = {}; \n            }\n        }\n\n        const newScenarioState = {};\n        \n        Object.keys(window.SCENARIOS).forEach(scenarioId => {\n            const defaultState = {\n                completed: false,\n                loggedTime: 0,\n                choicesMade: {}\n            };\n\n            newScenarioState[scenarioId] = {\n                ...defaultState,\n                ...(savedState[scenarioId] || {})\n            };\n            \n            // Recalculate logged time based on choicesMade to ensure consistency \n            let recalculateTime = 0;\n            if (newScenarioState[scenarioId].choicesMade) {\n                const scenario = window.SCENARIOS[scenarioId];\n                if (scenario) {\n                    Object.keys(newScenarioState[scenarioId].choicesMade).forEach(stepId => {\n                        const originalIndex = newScenarioState[scenarioId].choicesMade[stepId];\n                        if (scenario.steps[stepId] && scenario.steps[stepId].choices.length > originalIndex) {\n                            recalculateTime += getTimeCostForChoice(scenario.steps[stepId].choices[originalIndex].type);\n                        }\n                    });\n                }\n            }\n            newScenarioState[scenarioId].loggedTime = recalculateTime;\n        });\n        \n        scenarioState = newScenarioState;\n        saveScenarioState();\n    }\n\n    /**\n     * Saves the current game state to localStorage.\n     */\n    function saveScenarioState() {\n        localStorage.setItem('ue5ScenarioState', JSON.stringify(scenarioState));\n        if (LMS.enabled) lmsSchedulePersist('saveScenarioState');\n\n    }\n\n    /**\n     * Resets all scenario progress to default values.\n     */\n    function resetAllScenarioState() {\n        scenarioState = {};\n        Object.keys(window.SCENARIOS).forEach(scenarioId => {\n            scenarioState[scenarioId] = {\n                completed: false,\n                loggedTime: 0,\n                choicesMade: {}\n            };\n        });\n        interruptedSteps = {};\n        saveScenarioState();\n    }\n\n    /**\n     * Loads the interrupted steps map from localStorage.\n     */\n    function loadInterruptedSteps() {\n        const savedInterruptedJSON = localStorage.getItem('ue5InterruptedSteps');\n        if (savedInterruptedJSON) {\n            try {\n                interruptedSteps = JSON.parse(savedInterruptedJSON);\n            } catch (e) {\n                console.error(\"Failed to parse interrupted steps state, resetting.\", e);\n                interruptedSteps = {}; \n            }\n        }\n    }\n    \n    /**\n     * Saves the currently active ticket state and the multi-ticket progress map.\n     */\n    function saveCurrentTicketState() {\n        if (currentScenarioId && currentStepId) {\n            localStorage.setItem('ue5ActiveScenario', currentScenarioId);\n            localStorage.setItem('ue5ActiveStep', currentStepId);\n        } else {\n            localStorage.removeItem('ue5ActiveScenario');\n            localStorage.removeItem('ue5ActiveStep');\n        }\n\n        localStorage.setItem('ue5InterruptedSteps', JSON.stringify(interruptedSteps));\n        if (LMS.enabled) lmsSchedulePersist('saveCurrentTicketState');\n\n    }\n\n    // --- UI RENDERING & FLOW ---\n\n    /**\n     * Determines the color class for time logged vs. estimate.\n     * @param {number} logged - Logged hours.\n     * @param {number} estimate - Estimated hours.\n     * @returns {string} Tailwind CSS class for color.\n     */\n    function getLoggedTimeColorClass(logged, estimate) {\n        if (logged <= estimate) {\n            return 'text-green-400';\n        } \n        \n        const overBudgetRatio = logged / estimate;\n        \n        if (overBudgetRatio <= 1.20) { \n            return 'text-yellow-400';\n        } else if (overBudgetRatio <= 1.40) {\n            return 'text-orange-400';\n        } else { \n            return 'text-red-400';\n        }\n    }\n\n    /**\n     * Renders the list of tickets in the backlog (left column).\n     */\n    function renderBacklog() {\n        backlogList.innerHTML = '';\n        \n        const scenarioKeys = Object.keys(window.SCENARIOS);\n        \n        const validScenarios = scenarioKeys\n            .map(id => ({ id, data: window.SCENARIOS[id] }))\n            .filter(item => \n                item.data && \n                item.data.meta && \n                item.data.meta.title &&\n                typeof item.data.meta.estimateHours !== 'undefined'\n            );\n\n        validScenarios.forEach(item => {\n            const scenarioId = item.id;\n            const scenario = item.data;\n            const state = scenarioState[scenarioId];\n\n            const meta = scenario.meta;\n            const title = meta.title;\n            const description = meta.description ? meta.description.substring(0, 70) + '...' : \"No description available.\";\n            \n            let estimate = parseFloat(meta.estimateHours); \n            if (isNaN(estimate)) {\n                estimate = 0;\n            }\n            \n            const card = document.createElement('div');\n            const isActive = currentScenarioId === scenarioId && !state.completed;\n            \n            card.className = `p-4 rounded-lg border-l-4 cursor-pointer transition-all duration-200 ${\n                state.completed \n                    ? 'bg-gray-700/50 border-green-600' \n                    : isActive\n                        ? 'bg-blue-900/40 border-blue-400 ring-2 ring-blue-400' \n                        : 'bg-gray-700 hover:bg-gray-600/80 border-blue-500'\n            }`;\n            card.dataset.scenarioId = scenarioId;\n\n            let statusSpan;\n            let loggedTimeDisplay = '';\n            const logged = state.loggedTime;\n            const loggedColorClass = getLoggedTimeColorClass(logged, estimate);\n\n\n            if (state.completed) {\n                statusSpan = `<span class=\"text-xs font-semibold text-green-400\">COMPLETED</span>`;\n                loggedTimeDisplay = `\n                    <div class=\"text-sm text-gray-300\">\n                        Logged: <span class=\"font-bold ${loggedColorClass}\">${logged.toFixed(1)} hrs</span> / \n                        Est: <span class=\"font-bold text-green-400\">${estimate.toFixed(1)} hrs</span>\n                    </div>\n                `;\n            } else {\n                 const savedStepId = interruptedSteps[scenarioId];\n                 \n                 if (savedStepId && savedStepId !== scenario.start) {\n                     statusSpan = `<span class=\"text-xs font-semibold text-yellow-400\">IN PROGRESS</span>`;\n                     loggedTimeDisplay = `\n                        <div class=\"text-sm text-gray-400\">\n                            Logged: <span class=\"font-bold ${loggedColorClass}\">${logged.toFixed(1)} hrs</span> / \n                            Est: <span class=\"font-bold text-green-400\">${estimate.toFixed(1)} hrs</span>\n                        </div>\n                    `;\n                 } else {\n                     statusSpan = `<span class=\"text-xs font-semibold text-blue-400\">NOT STARTED</span>`;\n                     loggedTimeDisplay = `\n                        <div class=\"text-sm text-gray-400\">\n                            Est. Time: <span class=\"font-bold text-green-400\">${estimate.toFixed(1)} hrs</span>\n                        </div>\n                    `;\n                 }\n            }\n            \n            const html = `\n                <h4 class=\"font-bold ${state.completed ? 'text-gray-400 line-through' : 'text-gray-100'}\">${title}</h4>\n                <p class=\"text-xs text-gray-400 mt-1\">${description}</p>\n                <div class=\"mt-3 pt-3 border-t border-gray-600\">\n                    ${statusSpan}\n                    ${loggedTimeDisplay}\n                </div>\n            `;\n\n\n            card.innerHTML = html;\n            \n            if (!state.completed) {\n                card.addEventListener('click', () => selectScenario(scenarioId));\n            }\n\n            backlogList.appendChild(card);\n        });\n    }\n    \n    /**\n     * Renders a specific step (prompt and choices) of a scenario.\n     * @param {string} scenarioId - The ID of the scenario.\n     * @param {string} stepId - The ID of the step to render.\n     */\n    function renderStep(scenarioId, stepId) {\n        const scenario = window.SCENARIOS[scenarioId];\n        const step = scenario.steps[stepId];\n        \n        if (!step) {\n            console.error(`Step \"${stepId}\" not found in scenario \"${scenarioId}\"`);\n            return;\n        }\n        \n        // 1. Update the active ticket references\n        currentScenarioId = scenarioId;\n        currentStepId = stepId;\n\n        // Save the progress of the currently active ticket in the interrupted map\n        interruptedSteps[currentScenarioId] = currentStepId;\n        saveCurrentTicketState();\n\n        // 2. Resume timer if not in debug mode\n        if (!isDebugMode) {\n            resumeMainTimer();\n        }\n\n        // 3. Shuffle choices \n        const shuffledChoices = [...step.choices].sort(() => Math.random() - 0.5);\n\n        // 4. Determine Step Number for display\n        const stepKeys = Object.keys(scenario.steps);\n        const stepIndex = stepKeys.indexOf(stepId);\n        const stepNumber = stepIndex !== -1 ? stepIndex + 1 : 1;\n        const totalSteps = stepKeys.length;\n\n        // Conditionally generate the step count prefix (visible only in debug mode)\n        const stepCountPrefix = isDebugMode \n            ? `Step ${stepNumber} / ${totalSteps}: ` \n            : '';\n\n        // 5. Build the Step Prompt and Choices\n        const stepHtml = `\n            <div id=\"ticket-step-prompt\" class=\"mb-6\">\n                <h5 class=\"text-xl font-bold text-gray-200 mb-4\">${stepCountPrefix}${step.title}</h5>\n                <div class=\"prose prose-sm prose-invert text-gray-300\">${step.prompt}</div>\n            </div>\n            <div id=\"ticket-step-choices\" class=\"space-y-3\"></div>\n        `;\n\n        ticketStepContent.innerHTML = stepHtml;\n\n        const choicesContainer = ticketStepContent.querySelector('#ticket-step-choices');\n\n        // 6. Create Choice Buttons\n        // Map original index to shuffled button for time tracking stability\n        shuffledChoices.forEach((choice) => {\n            const timeCost = getTimeCostForChoice(choice.type);\n            const isCorrect = choice.type === 'correct';\n\n            const btn = document.createElement('button');\n            \n            // Determine button styling (Debug Mode only shows hint colors)\n            let debugClass = '';\n            if (isDebugMode) {\n                if (isCorrect) {\n                     debugClass = 'border-green-600 debug-correct';\n                } else if (choice.type === 'partial') {\n                     debugClass = 'border-yellow-600';\n                } else if (choice.type === 'misguided') {\n                     debugClass = 'border-orange-600';\n                } else {\n                     debugClass = 'border-red-600';\n                }\n            } else {\n                debugClass = 'border-gray-600 hover:border-blue-500';\n            }\n            \n            // Apply unselectable class to choices\n            btn.className = `block w-full text-left p-4 bg-gray-700 hover:bg-gray-600 rounded-lg border transition-all duration-150 focus:outline-none focus:ring-2 focus:ring-blue-500 unselectable ${debugClass}`;\n            \n            btn.innerHTML = `<span class=\"font-bold\">${choice.text}</span>`; \n\n            // Attach minimal data to dataset\n            btn.dataset.choiceNext = choice.next;\n            btn.dataset.choiceTimeCost = timeCost;\n            \n            // CRITICAL: Store the original index from the SCENARIOS array for stable score tracking\n            // We need to find the original index in the unshuffled array\n            const originalIndexInChoices = step.choices.indexOf(choice);\n            if (originalIndexInChoices !== -1) {\n                btn.dataset.originalIndex = originalIndexInChoices;\n            } else {\n                console.error(\"Could not find choice in original array for stable index mapping.\");\n                btn.dataset.originalIndex = -1; // Fallback to -1 if mapping fails\n            }\n\n            btn.addEventListener('click', () => handleChoice(btn));\n            choicesContainer.appendChild(btn);\n        });\n        \n        renderBacklog();\n    }\n\n    /**\n     * Called when a user clicks an answer choice.\n     * @param {HTMLElement} choiceButton - The clicked button element.\n     */\n    function handleChoice(choiceButton) {\n        const { choiceNext, choiceTimeCost, originalIndex } = choiceButton.dataset;\n        const timeCost = parseFloat(choiceTimeCost);\n        const index = parseInt(originalIndex, 10);\n        \n        // 1. Log the time cost (updates global state)\n        const state = scenarioState[currentScenarioId];\n        state.loggedTime += timeCost;\n        \n        // 2. Record the original index of the choice made\n        state.choicesMade[currentStepId] = index;\n\n        saveScenarioState();\n\n        // 3. Check for scenario conclusion\n        if (choiceNext === 'conclusion') {\n            finishScenario();\n        } else {\n            // 4. Move to the next step immediately \n            currentStepId = choiceNext;\n            renderStep(currentScenarioId, currentStepId);\n        }\n    }\n\n    /**\n     * Called when a user clicks a scenario card from the backlog.\n     * @param {string} scenarioId - The ID of the scenario selected.\n     * @param {string|null} startStepId - Optional ID for the step to start at.\n     */\n    function selectScenario(scenarioId, startStepId = null) {\n        \n        // Save previous ticket's progress before switching\n        if (currentScenarioId && currentStepId && currentScenarioId !== scenarioId) {\n            interruptedSteps[currentScenarioId] = currentStepId;\n            localStorage.removeItem('ue5ActiveScenario');\n            localStorage.removeItem('ue5ActiveStep');\n            saveCurrentTicketState(); \n        }\n        \n        const scenario = window.SCENARIOS[scenarioId];\n        \n        // Determine starting step: 1. Passed in ID, 2. Interrupted map, 3. Scenario start\n        currentStepId = startStepId \n            || interruptedSteps[scenarioId] \n            || scenario.start; \n        \n        // Update ticket header\n        ticketTitle.textContent = scenario.meta.title;\n        ticketDescription.textContent = scenario.meta.description;\n\n        // Show ticket content, hide placeholder\n        ticketPlaceholder.classList.add('hidden');\n        ticketContent.classList.remove('hidden');\n\n        // Render the chosen step\n        renderStep(scenarioId, currentStepId);\n        \n        // Update the global active ticket tracking\n        currentScenarioId = scenarioId;\n    }\n    \n    /**\n     * Called when the user completes the final step of a scenario.\n     */\n    function finishScenario() {\n        // Mark as completed\n        const state = scenarioState[currentScenarioId];\n        state.completed = true;\n        \n        // Clear its step from the interrupted map since it's done\n        if (interruptedSteps[currentScenarioId]) {\n            delete interruptedSteps[currentScenarioId];\n        }\n\n        saveScenarioState();\n        saveCurrentTicketState();\n        renderBacklog();\n        \n        // Check if all scenarios are done (triggers final modal)\n        const allComplete = Object.values(scenarioState).every(s => s.completed);\n        \n        if (allComplete) {\n            let totalLoggedTime = Object.values(scenarioState).reduce((acc, s) => acc + s.loggedTime, 0);\n            stopTimerOnComplete(); \n            // Pass the calculated time to the modal\n            showAssessmentModal('complete', totalLoggedTime);\n        } else {\n             // Show the individual ticket conclusion inline\n            pauseMainTimer();\n            renderSingleTicketConclusion();\n        }\n    }\n    \n    /**\n     * Renders the final summary screen for a completed scenario directly into the ticket panel.\n     */\n    function renderSingleTicketConclusion() {\n        \n        const state = scenarioState[currentScenarioId];\n        const scenario = window.SCENARIOS[currentScenarioId];\n        const estimateHours = scenario.meta.estimateHours;\n        const loggedHours = state.loggedTime;\n        \n        const timeColorClass = getLoggedTimeColorClass(loggedHours, estimateHours);\n\n        // Calculate overrun/underrun\n        const timeDifference = (loggedHours - estimateHours);\n        const diffColorClass = timeDifference > 0 ? 'text-red-400' : 'text-green-400';\n        const diffLabel = timeDifference > 0 ? 'Over' : 'Under';\n        const diffValue = Math.abs(timeDifference);\n        \n        let summaryMessage;\n        if (loggedHours <= estimateHours) {\n            summaryMessage = \"Excellent outcome! The solution was found well within the estimated time.\";\n        } else if (loggedHours <= estimateHours * 1.5) {\n            summaryMessage = \"Solid work. The solution was delivered, requiring a moderate but acceptable amount of time.\";\n        } else {\n            summaryMessage = \"Ticket resolved. The issue was complex, resulting in a higher time log than originally estimated.\";\n        }\n        \n        const buttonText = \"Back to Backlog\";\n        const buttonId = \"close-scenario-btn\";\n        \n        const conclusionHtml = `\n            <div class=\"text-center p-8\">\n                <h3 class=\"text-3xl font-bold ${timeColorClass} mb-6\">Ticket Resolved</h3>\n                <p class=\"text-lg text-gray-300 mb-8\">${summaryMessage}</p>\n\n                <div class=\"max-w-md mx-auto bg-gray-700/50 p-6 rounded-lg\">\n                    <h4 class=\"text-xl font-semibold text-gray-100 mb-4\">Ticket Time Breakdown (Step Cost)</h4>\n                    <div class=\"space-y-3 text-left\">\n                        <div class=\"flex justify-between text-gray-300\">\n                            <span>Logged Fix Time:</span>\n                            <span class=\"font-bold\">${loggedHours.toFixed(1)} hrs</span>\n                        </div>\n                        <div class=\"flex justify-between text-gray-300\">\n                            <span>Original Estimate:</span>\n                            <span class=\"font-bold text-green-400\">${estimateHours.toFixed(1)} hrs</span>\n                        </div>\n                        <div class=\"flex justify-between text-lg text-white border-t border-gray-500 pt-3 mt-3\">\n                            <span class=\"font-bold\">${diffLabel} Budget By:</span>\n                            <span class=\"font-bold ${diffColorClass}\">${diffValue.toFixed(1)} hrs</span>\n                        </div>\n                    </div>\n                </div>\n\n                <button id=\"${buttonId}\" class=\"mt-8 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-8 rounded-lg shadow-md transition-all duration-200\">\n                    ${buttonText}\n                </button>\n            </div>\n        `;\n        \n        ticketStepContent.innerHTML = conclusionHtml;\n        \n        // Add event listener to the close button\n        document.getElementById(buttonId).addEventListener('click', () => {\n            // Reset UI to placeholder state\n            ticketContent.classList.add('hidden');\n            ticketPlaceholder.classList.remove('hidden');\n            \n            currentScenarioId = null;\n            currentStepId = null;\n            \n            saveCurrentTicketState(); \n\n            renderBacklog();\n            \n            // Resume the timer now that the user is selecting the next task\n            resumeMainTimer();\n        });\n    }\n\n    /**\n     * Stops the game when the timer runs out. \n     */\n    function endGameByTime() {\n        clearInterval(mainTimerInterval);\n        localStorage.removeItem('ue5ScenarioTimer'); \n        \n        if (timerContainer) {\n            timerContainer.classList.add('hidden');\n        }\n\n        countdownTimer.classList.remove('pulse-red', 'text-blue-300', 'text-yellow-400');\n        countdownTimer.classList.add('text-orange-400');\n        countdownTimer.textContent = \"00:00\";\n        \n        // Show \"Time's Up\" modal\n        showAssessmentModal('timeout'); \n    }\n    \n    /**\n     * Stops the timer when all scenarios are completed.\n     */\n    function stopTimerOnComplete() {\n        clearInterval(mainTimerInterval);\n        localStorage.removeItem('ue5ScenarioTimer'); \n        \n        // HIDE THE TIMER DISPLAY ENTIRELY\n        if (timerContainer) {\n            timerContainer.classList.add('hidden');\n        }\n\n        // Ensure no low-time colors here\n        countdownTimer.classList.remove('pulse-red', 'text-blue-300', 'text-yellow-400', 'text-orange-400');\n        countdownTimer.classList.add('text-green-500');\n        countdownTimer.textContent = \"Complete!\";\n    }\n\n    /**\n     * Assessment modal rendering function (ONLY for final, global status).\n     * @param {string} status - 'timeout' or 'complete'.\n     * @param {number|null} [totalLoggedTime=null] - Total simulated time in hours.\n     * @param {object} [stateToUse=scenarioState] - The state object to use for generating the key.\n     */\n    function showAssessmentModal(status, totalLoggedTime = null, stateToUse = scenarioState) {\n        pauseMainTimer(); // Ensure timer stops when the modal appears\n\n        let mainTitle, subText, mainTitleColor;\n        let finalStatsHtml = '';\n        let buttonHtml = ''; \n        \n        // Determine completion based on the state that was passed in\n        const allScenariosComplete = Object.values(stateToUse).every(s => s.completed);\n\n        if (status === 'timeout') {\n            // TIME'S UP status\n            mainTitle = \"Time's Up!\";\n            subText = \"The assessment period has ended. Assessment incomplete.\";\n            mainTitleColor = \"text-orange-400\";\n            \n            // --- LMS: mark as incomplete + suspend on timeout\nif (LMS.enabled) {\n    try {\n        window.SCORM12.setValue(\"cmi.core.lesson_status\", \"incomplete\");\n        window.SCORM12.setValue(\"cmi.core.exit\", \"suspend\");\n        window.SCORM12.setValue(\"cmi.suspend_data\", lmsPackSuspendData());\n        window.SCORM12.commit();\n    } catch (e) {}\n}buttonHtml = `\n                <p class=\"text-sm text-gray-400 mt-4\">This assessment is incomplete.</p>\n            `;\n            \n        } else if (allScenariosComplete || totalLoggedTime !== null) { \n            // ASSESSMENT COMPLETE status \n            \n            // 1. Calculate final scores\n            if (totalLoggedTime === null) {\n                // If the time is null (e.g., loaded from a cleared state), recalculate from the passed state\n                totalLoggedTime = Object.values(stateToUse).reduce((acc, s) => acc + s.loggedTime, 0);\n            }\n            \n            // Note: calculateTotalIdealTime correctly uses the global SCENARIOS data\n            const { idealTotalTime } = calculateTotalIdealTime();\n            const efficiencyScore = totalLoggedTime > 0 ? (idealTotalTime / totalLoggedTime) : 0;\n            const finalEfficiencyPercent = Math.round(efficiencyScore * 100);\n            const passed = efficiencyScore >= PASS_THRESHOLD;// --- LMS: write score and status\nif (LMS.enabled) {\n    try {\n        window.SCORM12.setScoreRaw(finalEfficiencyPercent, 0, 100);\n        window.SCORM12.setValue(\"cmi.core.lesson_status\", passed ? \"passed\" : \"failed\");\n        window.SCORM12.setValue(\"cmi.core.exit\", \"\"); // finished attempt\n        window.SCORM12.setValue(\"cmi.suspend_data\", lmsPackSuspendData());\n        window.SCORM12.commit();\n    } catch (e) { console.warn(\"SCORM score/status update failed\", e); }\n}\n            \n            // 2. Generate Test Key (Using the state that was passed in)\n            const testKey = generateTestKey(stateToUse);\n\n            mainTitle = passed ? \"Assessment Passed\" : \"Assessment Completed\";\n            mainTitleColor = passed ? \"text-green-500\" : \"text-yellow-500\";\n            subText = passed \n                ? \"Congratulations! Your results are logged based on efficient problem-solving.\"\n                : \"You completed all tickets. Review the details below.\";\n            \n            // 4. Assemble Final Stats HTML (Reproducible Key added back)\n            finalStatsHtml = `\n                <div class=\"mt-4 border-t border-gray-600 pt-4\">\n                    <h4 class=\"text-xl font-bold ${mainTitleColor} mb-3\">Final Time Report</h4>\n                    <div class=\"space-y-2 text-left max-w-sm mx-auto\">\n                        <div class=\"flex justify-between text-sm text-gray-200\">\n                            <span>Total Optimal Time (0.5h/step):</span>\n                            <span class=\"font-bold\">${idealTotalTime.toFixed(1)} hrs</span>\n                        </div>\n                         <div class=\"flex justify-between text-sm text-gray-200\">\n                            <span>Total Simulated Time (Choice Cost):</span>\n                            <span class=\"font-bold text-sm\">${totalLoggedTime.toFixed(1)} hrs</span>\n                        </div>\n                        <div class=\"flex justify-between text-lg text-white border-t border-gray-500 pt-3\">\n                            <span class=\"font-bold\">Efficiency Score:</span>\n                            <span class=\"font-bold ${mainTitleColor}\">${finalEfficiencyPercent}%</span>\n                        </div>\n                        <p class=\"text-xs text-gray-400 text-center\">(Pass Threshold: ${PASS_THRESHOLD * 100}%)</p>\n                    </div>\n                </div>\n                \n                <div class=\"mt-4 border-t border-gray-600 pt-4\">\n                    <h4 class=\"text-xl font-bold text-gray-100 mb-3\">Reproducible Test Key</h4>\n                    <p class=\"text-sm text-gray-400 mb-2\">Copy this key to recreate this exact test path and results.</p>\n                    \n                    <div class=\"flex justify-center\">\n                        <span id=\"test-key-display\" class=\"font-mono text-xs md:text-sm bg-gray-700/70 p-3 rounded-lg break-all max-w-full inline-block text-yellow-300\">\n                            ${testKey}\n                        </span>\n                    </div>\n                    \n                    <button id=\"copy-key-btn\" class=\"mt-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg text-sm transition-all duration-200\">\n                        Copy Key\n                    </button>\n                </div>\n            `;\n            \n            buttonHtml = `\n                <p class=\"text-sm text-gray-400 mt-4\">This assessment is complete.</p>\n            `;\n        }\n\n        // --- Render Modal ---\n        const modalContentHtml = `\n            <div id=\"final-modal-content\" class=\"bg-gray-800 p-6 rounded-xl shadow-2xl text-center max-w-lg w-full max-h-[90vh] overflow-y-auto\">\n                <h2 class=\"text-3xl font-extrabold ${mainTitleColor} mb-2\">${mainTitle}</h2>\n                <p class=\"text-base text-gray-300 mb-2\">${subText}</p>\n                \n                ${finalStatsHtml}\n\n                ${buttonHtml}\n            </div>\n        `;\n\n        timesUpScreen.innerHTML = modalContentHtml;\n        jiraBoard.classList.add('hidden');\n        timesUpScreen.classList.remove('hidden');\n\n        // Attach Copy button listener\n        if (allScenariosComplete || totalLoggedTime !== null) {\n            const copyButton = document.getElementById('copy-key-btn');\n            const keyDisplay = document.getElementById('test-key-display');\n            \n            if (copyButton && keyDisplay) {\n                copyButton.addEventListener('click', () => {\n                    const keyToCopy = keyDisplay.textContent; \n                    \n                    // Use document.execCommand('copy') for better compatibility in iframe environments\n                    const tempInput = document.createElement('textarea');\n                    tempInput.value = keyToCopy;\n                    document.body.appendChild(tempInput);\n                    tempInput.select();\n                    document.execCommand('copy');\n                    document.body.removeChild(tempInput);\n\n                    copyButton.textContent = 'Copied!';\n                    setTimeout(() => {\n                        copyButton.textContent = 'Copy Key';\n                    }, 2000);\n                });\n            }\n        }\n    }\n\n\n    // --- Entry Point ---\n    cacheDOMElements();\n    attachEventListeners();\n    initializeApp();\n\n});","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\temp_scorm12_extract\\questions.js","messages":[{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":59,"column":205,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":59,"endColumn":206,"suggestions":[{"messageId":"removeEscape","fix":{"range":[3221,3222],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[3221,3221],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":70,"column":1477,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":70,"endColumn":1478,"suggestions":[{"messageId":"removeEscape","fix":{"range":[7289,7290],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[7289,7289],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":73,"column":532,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":73,"endColumn":533,"suggestions":[{"messageId":"removeEscape","fix":{"range":[7931,7932],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[7931,7931],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":73,"column":559,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":73,"endColumn":560,"suggestions":[{"messageId":"removeEscape","fix":{"range":[7958,7959],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[7958,7958],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":73,"column":820,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":73,"endColumn":821,"suggestions":[{"messageId":"removeEscape","fix":{"range":[8219,8220],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[8219,8219],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":78,"column":1255,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":78,"endColumn":1256,"suggestions":[{"messageId":"removeEscape","fix":{"range":[10582,10583],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[10582,10582],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":78,"column":1269,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":78,"endColumn":1270,"suggestions":[{"messageId":"removeEscape","fix":{"range":[10596,10597],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[10596,10596],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":78,"column":1601,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":78,"endColumn":1602,"suggestions":[{"messageId":"removeEscape","fix":{"range":[10928,10929],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[10928,10928],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":91,"column":666,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":91,"endColumn":667,"suggestions":[{"messageId":"removeEscape","fix":{"range":[19409,19410],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[19409,19409],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":91,"column":1299,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":91,"endColumn":1300,"suggestions":[{"messageId":"removeEscape","fix":{"range":[20042,20043],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[20042,20042],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":92,"column":1019,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":92,"endColumn":1020,"suggestions":[{"messageId":"removeEscape","fix":{"range":[21395,21396],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[21395,21395],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":93,"column":1645,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":93,"endColumn":1646,"suggestions":[{"messageId":"removeEscape","fix":{"range":[23666,23667],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[23666,23666],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":93,"column":1710,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":93,"endColumn":1711,"suggestions":[{"messageId":"removeEscape","fix":{"range":[23731,23732],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[23731,23731],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":98,"column":688,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":98,"endColumn":689,"suggestions":[{"messageId":"removeEscape","fix":{"range":[25610,25611],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[25610,25610],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":104,"column":1027,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":104,"endColumn":1028,"suggestions":[{"messageId":"removeEscape","fix":{"range":[32838,32839],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[32838,32838],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":107,"column":692,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":107,"endColumn":693,"suggestions":[{"messageId":"removeEscape","fix":{"range":[34196,34197],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[34196,34196],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":107,"column":962,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":107,"endColumn":963,"suggestions":[{"messageId":"removeEscape","fix":{"range":[34466,34467],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[34466,34466],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":107,"column":1303,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":107,"endColumn":1304,"suggestions":[{"messageId":"removeEscape","fix":{"range":[34807,34808],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[34807,34807],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":108,"column":961,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":108,"endColumn":962,"suggestions":[{"messageId":"removeEscape","fix":{"range":[36113,36114],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[36113,36113],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":169,"column":1648,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":169,"endColumn":1649,"suggestions":[{"messageId":"removeEscape","fix":{"range":[79725,79726],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[79725,79725],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]}],"suppressedMessages":[],"errorCount":20,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ============================================================================\n// === QUESTIONS DATA: SCENARIOS ==============================================\n// ============================================================================\n// This file defines all of the scenario data used by the UE5 Scenario Tracker.\n// Each key in the SCENARIOS object represents an interactive debugging \"ticket\"\n// in a Jira-style format.\n// ----------------------------------------------------------------------------\n// STRUCTURE OVERVIEW:\n//\n// SCENARIO {\n//   meta: { \n//     title: string, \n//     description: string, \n//     estimateHours: number // Target completion time for efficiency score\n//   },\n//   start: \"step-id\", // The key of the first step to display\n//   steps: {\n//     'step-id': {\n//       isTask: true | false, // True if a core problem/False if a dead-end follow-up\n//       skill: 'category',    // Used for tracking skill focus (e.g., 'rep', 'anim')\n//       title: 'Step Title',\n//       prompt: '<p>HTML prompt text...</p>',\n//       choices: [\n//         {\n//           text: 'The choice text.',\n//           type: 'correct' | 'partial' | 'misguided' | 'wrong', // Maps to time cost (0.5, 1.0, 1.5, 2.0 hrs)\n//           feedback: '<p>HTML feedback text with points/time cost...</p>',\n//           next: 'next-step-id' | 'conclusion' // ID of the next step or 'conclusion' to finish the ticket\n//         },\n//         // ... other choices\n//       ]\n//     }\n//   }\n// }\n// ----------------------------------------------------------------------------\n\nwindow.SCENARIOS = {\n  // --------------------------------------------------------------------------\n  // GOLEM SCENARIO: A deep dive into multiple systems (Compilation, Anim, VFX, Perf, Rep)\n  // --------------------------------------------------------------------------\n  golem: {\n    meta: {\n      title: \"BP_GuardianGolem is Non-Functional: Full Debug Hunt\",\n      description:\n        \"Critical enemy asset fails to spawn, T-poses, leaks VFX memory, and breaks on the network.\",\n      estimateHours: 14.0 // Adjusted for increased debugging complexity and dead ends\n    },\n    start: \"step-1\",\n    steps:\n      {\n        // === 1. COMPILATION & CLASS ABSTRACTION ISSUES ===\n        'step-1': {\n          isTask: true, \n          skill:'compile',\n          title:'Abstract Class Error',\n          prompt:\"<p>You try to place <code>BP_GuardianGolem</code> in the level, but nothing happens. The <strong>Output Log</strong> shows: <code>Error: Could not create actor... The class is abstract and must be subclassed.</code></p><strong>What is the cause of this abstract class error in Blueprints?</strong>\",\n          choices:[\n            {text:\"Implement the required unimplemented function inherited from the parent C++ class.\",type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> The Blueprint is abstract because it inherits an unimplemented event, often marked with an error in the My Blueprint panel.</p>\",next:'step-2'},\n            {text:'Delete the asset and re-create it, hoping the corruption clears.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> This is a destructive action that won\\'t solve the root inheritance problem.</p>\",next:'step-1W'},\n            {text:'Check the Blueprint\\'s variables for an unchecked <code>Expose on Spawn</code> property.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> <code>Expose on Spawn</code> is related to spawning but does not make a class abstract. This fix is misguided and wastes time.</p>\",next:'step-1M'},\n            {text:'Recompile the parent C++ code without making any changes.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> This is an indirect approach. You need to investigate the inherited functions.</p>\",next:'step-3'}\n          ]\n        },\n        \n        'step-1W': {isTask: false, skill:'compile',title:'Asset Deletion Wastes Time',prompt:\"<p>Deleting and recreating the asset failed to fix the error because the problem is inherited from the parent class. You must now find the function.</p><strong>How do you find the unimplemented function?</strong>\",choices:[{text:'In the My Blueprint panel, right-click the parent function name and select \"Implement function\".',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> Re-focusing on the correct workflow. The editor guides you to implement required functions.</p>\",next:'step-3'},{text:'Open the parent C++ class and remove the \"BlueprintImplementableEvent\" tag.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> Dangerous code change that breaks the game systems relying on this event.</p>\",next:'step-3'}]},\n        \n        'step-1M': {isTask: false, skill:'compile',title:'Misguided Variable Check Failure',prompt:\"<p>Checking the <code>Expose on Spawn</code> property did not resolve the abstract class error. This property only affects variables passed during the <code>Spawn Actor</code> node and is not the cause of an abstract class definition.</p><strong>You realize this was a dead end. What should you do next to address the abstract class error?</strong>\",choices:[{text:'Go back and investigate the inherited functions in the My Blueprint panel.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> Returning to the correct path, you realize the error is caused by an unimplemented inherited function.</p>\",next:'step-3'},{text:'Try recompiling the parent C++ code again (Partial answer from Step 1).',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> You are still avoiding the direct investigation, wasting more time on indirect fixes.</p>\",next:'step-3'}]},\n\n        // === 2. ANIMATION & DATA FLOW ISSUES ===\n        'step-2': {isTask: true, skill:'anim',title:'The Runtime T-Pose',prompt:\"<p>The Golem now spawns, but is stuck in a T-Pose. The AnimBP preview is working, but the in-game character is frozen.</p><strong>Where is the most likely data disconnect preventing animation playback?</strong>\",choices:[{text:\"Trace the AnimBP's Event Graph logic to ensure data variables (like Speed) are being updated from the main Golem Blueprint (Cast failure).\",type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> The <code>AnimBP</code> is a separate machine that relies on data from the character. If the <code>Cast</code> fails, the <code>State Machine</code> defaults to its entry pose (T-Pose).</p>\",next:'step-3'},{text:'Change the Skeletal Mesh Component\\'s \"Animation Mode\" to \"Use Animation Asset\".',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> This would play a single animation, not result in a T-Pose, suggesting the <code>AnimBP</code> is assigned but not driven.</p>\",next:'step-3'},{text:'Reimport the Skeletal Mesh and all associated animations.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> The preview works, confirming the asset is fine. The problem is runtime logic.</p>\",next:'step-2W'},{text:'Check if the character\\'s physics asset is blocking movement.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> You think this is a physics issue and check the Golem\\'s Physics Asset.</p>\",next:'step-2M'}]},\n        \n        // Dead-end: Mistaking T-pose for asset corruption\n        'step-2W': {isTask: false, skill:'anim',title:'Asset Reimport Was Useless',prompt:\"<p>You wasted maximum time re-importing the Golem mesh and animations. The issue persists. Since the animation preview works, the issue is clearly runtime logic, not asset corruption.</p><strong>Where must the core data flow failure lie?</strong>\",choices:[{text:'Check the data casting between the AnimBP and the main Golem Blueprint.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> You correctly refocused on the AnimBP\\'s dependency on the Golem\\'s runtime data.</p>\",next:'step-3'},{text:'Check the Golem\\'s <code>Movement Mode</code>, maybe it\\'s set to <code>None</code>.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> This is an unrelated fix. Movement mode doesn\\'t affect the AnimBP ticking logic.</p>\",next:'step-3'}]},\n\n        // Dead-end: Mistaking T-pose for physics issues\n        'step-2M': {isTask: false, skill:'anim',title:'Physics Asset Investigation (Dead End)',prompt:\"<p>You spent extended time reviewing and simplifying the Golem's <code>Physics Asset</code>. While optimization is good, it had no effect on the T-pose because the character's animation system runs separately from the physics simulation.</p><strong>You realize the problem must be in the AnimBP's initialization. What is the next step?</strong>\",choices:[{text:'Check the data casting between the AnimBP and the main Golem Blueprint.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> Correctly identifying the AnimBP's dependency on character data as the root cause.</p>\",next:'step-3'},{text:'Check if the Golem\\'s <code>Skeletal Mesh Component</code> is set to <code>Visible</code>.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> The Golem is visible, just T-posing. This is an obviously wrong check.</p>\",next:'step-3'}]},\n        \n        'step-3': {isTask: true, skill:'anim',title:'Tracing the Data Flow Failure',prompt:\"<p>You find the AnimBP's <code>Cast to BP_GuardianGolem</code> node fails immediately on <code>Event Blueprint Update Animation</code> due to a timing issue.</p><strong>What is the standard, robust pattern to fix this AnimBP casting failure?</strong>\",choices:[{text:\"Use <code>Event Blueprint Initialize Animation</code> to establish a solid reference to the Golem once, avoiding the per-frame cast and potential timing issues.\",type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> Initializing the reference once at the correct time is far more efficient than casting every frame on Update Animation.</p>\",next:'step-4'},{text:'Add an <code>IsValid</code> check after the Cast. Only update variables if the Cast succeeds.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> This prevents crashes but causes a jarring pop-in (visual technical debt) as the character T-poses until the Cast succeeds.</p>\",next:'step-4'},{text:'Add a 0.2 second Delay before the Cast to ensure the character is fully possessed.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> This is a brittle, \\'magic number\\' fix prone to failing on different machine speeds or during hitches.</p>\",next:'step-4'},{text:'Move the Cast logic to the Golem Blueprint and send the data back to the AnimBP via a variable binding.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> This inverts the data flow complexity and doesn\\'t solve the core timing issue.</p>\",next:'step-4'}]},\n        'step-4': {isTask: true, skill:'anim',title:'The T-Pose Visual Tech Debt',prompt:\"<p>You choose the <strong>Partial</strong> answer (the <code>IsValid</code> check). The Golem animates, but QA reports the Golem \\\"snaps\\\" from a T-pose when it first spawns. The lead asks you to move on, but you know this is bad practice.</p><strong>What do you call the best practice pattern you should have used?</strong>\",choices:[{text:\"The robust, event-driven reference initialization pattern (using <code>Initialize Animation</code>).\",type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> Acknowledging the tech debt and remembering the best practice. This is the correct soft skill.</p>\",next:'step-5'},{text:'The <code>Character Movement Component</code> has its <code>Default Land Movement Mode</code> set to None.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> Unrelated to the animation initialization issue.</p>\",next:'step-5'},{text:'The AnimBP is overriding the wrong function, it should use <code>Post Update Animation</code>.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> <code>Update Animation</code> is the correct place to update variables.</p>\",next:'step-5'},{text:'The delay node was still the better solution for reliability.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> Still believing in the fragile delay solution shows a lack of understanding of event-driven reliability.</p>\",next:'step-5'}]},\n        \n        // === 3. VFX, SOUND, & ACTOR LIFECYCLE ISSUES ===\n        'step-5': {isTask: true, skill:'vfx',title:'The Missing Anim Notify',prompt:\"<p>The Golem animates, but a crucial ground-shatter VFX is missing during the Slam Attack. The VFX is triggered by an <code>Anim Notify</code> called <code>FX_SlamImpact</code>.</p><strong>What is your primary check when debugging a failing Anim Notify?</strong>\",choices:[{text:\"Open the Animation Sequence (A_Golem_Slam) and verify the <code>FX_SlamImpact</code> notify exists on the <code>Notify Track</code> and is correctly placed/spelled.\",type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> The <code>Anim Notify</code> asset and its timeline placement are the source. Missing or misspelled notifies are the most common cause.</p>\",next:'step-6'},{text:'Place a breakpoint on the corresponding event in the AnimBP\\'s <code>Event Graph</code>.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> This is a good second step, but if the notify is missing from the timeline, the breakpoint will never be hit, wasting time tracing the wrong component.</p>\",next:'step-6'},{text:'Check the <code>Niagara System</code> asset to ensure it is not compiled with errors.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> You have no evidence the <code>Niagara System</code> is the problem yet; the issue points to the trigger mechanism.</p>\",next:'step-6'},{text:'Change the notify\\'s timing in the Montage instead of the <code>Anim Sequence</code>.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> <code>Anim Notifies</code> are placed on the base sequence, not the montage layer.</p>\",next:'step-6'}]},\n        'step-6': {isTask: true, skill:'vfx',title:'The Emitter Spawns at Origin',prompt:\"<p>You fix a typo in the <code>Anim Notify</code> name, and the VFX plays, but it always spawns at the world origin (0,0,0) instead of under the Golem's foot.</p><strong>How do you fix the VFX spawn location?</strong>\",choices:[{text:'Use <code>Spawn Emitter Attached</code> and provide the Golem\\'s mesh and a foot socket name as the attach point.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> Attaching ensures the effect tracks the skeletal mesh, using relative transforms for the most accurate and robust positioning.</p>\",next:'step-7'},{text:'Use <code>Get Socket Location</code> on the mesh and feed that world location into <code>Spawn Emitter at Location</code>.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> This works, but is less robust. If the Golem moves rapidly, the location could be slightly off before the next tick updates the position.</p>\",next:'step-7'},{text:\"Manually add the Golem's world location to a hard-coded offset vector.\",type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> Brittle fix that breaks if the Golem's location or rotation changes dramatically.</p>\",next:'step-7'},{text:'The <code>Niagara System</code> needs its <code>Local Space</code> flag enabled.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> You are attempting to fix the world-space location with a local-space particle setting.</p>\",next:'step-6W'}]},\n        \n        // Dead-end: Mismatching world vs local space settings for spawn\n        'step-6W': {isTask: false, skill:'vfx',title:'Local Space Confusion (Dead End)',prompt:\"<p>You tried enabling <code>Local Space</code> in the <code>Niagara System</code>, but it had no effect on the emitter's spawn location. <code>Local Space</code> only controls whether the particles move with the emitter's parent. The issue is where the emitter's *container* is spawned in the world.</p><strong>What is the correct way to handle spatial relationships for spawning emitters?</strong>\",choices:[{text:'Use <code>Spawn Emitter Attached</code> and provide the Golem\\'s mesh and a socket name as the attach point.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> The correct approach is always to attach the emitter to the skeletal mesh for reliable tracking.</p>\",next:'step-7'},{text:'Set the <code>Spawn Emitter at Location</code> node to use the character\\'s world <code>Root Component</code> location.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> This is a step up, but it still lacks the precision of a dedicated foot socket.</p>\",next:'step-7'}]},\n\n        'step-7': {isTask: true, skill:'vfx',title:'Leaking VFX Actors',prompt:\"<p>The VFX plays correctly, but after a few attacks, the frame rate dips. <code>obj list class=NiagaraActor</code> shows hundreds of <code>Niagara actors</code> still in memory.</p><strong>What is causing this memory leak?</strong>\",choices:[{text:\"Check the <code>Spawn Emitter Attached</code> node to ensure the <code>Auto Destroy</code> checkbox is checked.\",type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> The actor container must explicitly be marked for destruction via <code>Auto Destroy</code> or a manual <code>Destroy Actor</code> node after the effect is complete.</p>\",next:'step-8'},{text:'Manually call <code>Destroy Actor</code> on the emitter reference after a Delay node matching the effect\\'s duration.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> This achieves cleanup but is less efficient and more error-prone than using the built-in <code>Auto Destroy</code> flag.</p>\",next:'step-8'},{text:'Reduce the particle count in the <code>Niagara System</code> to lessen memory pressure.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> This addresses symptoms but not the root cause (actor lifecycle management).</p>\",next:'step-8'},{text:'Wait for the <code>Garbage Collector</code> to run; it will eventually clean up unused actors.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> The <code>Garbage Collector</code> only cleans up unreferenced memory, not actors that are still referenced or not explicitly marked for destruction.</p>\",next:'step-8'}]},\n        \n        // === 4. MATERIAL & RENDERING OPTIMIZATION ISSUES ===\n        'step-8': {isTask: true, skill:'material',title:'Unlit Gray VFX',prompt:\"<p>The memory leak is fixed, but the VFX looks flat, gray, and unlit instead of a fiery explosion. The Material uses a <code>Particle Color</code> node multiplied by a texture, but the result is black (0,0,0).</p><strong>What is the best fix to correctly drive the Material?</strong>\",choices:[{text:'In the Niagara emitter, add or adjust the <code>Scale Color</code> module to output the necessary color data for the Material to use.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> The Material expects particle color data, but the <code>Niagara system</code> wasn\\'t providing it. Fix the data flow from the particle system to the shader.</p>\",next:'step-9'},{text:\"Delete the <code>Particle Color</code> node and connect the texture directly to the material's <code>Emissive</code> output.\",type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> This makes it visible but removes particle system control (fading/lifetime color changes), breaking the intended look.</p>\",next:'step-9'},{text:'Change the material\\'s <code>Blend Mode</code> from Opaque to Additive.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> This changes the blend, but doesn\\'t fix the unlit black result, and risks severe overdraw.</p>\",next:'step-9'},{text:'Reimport the texture files used by the material.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> The black output is a logical flaw in the shader graph/data flow, not a texture import error.</p>\",next:'step-9'}]},\n        'step-9': {isTask: true, skill:'perf',title:'Overdraw Crisis (Visual Tech Debt)',prompt:\"<p>You chose the <strong>Partial</strong> answer (deleting the <code>Particle Color</code> node). The VFX is now visible, but it looks terrible and performance dips because the material is set to <strong>Translucent</strong>.</p><strong>What optimization should you perform immediately to resolve the Translucent/Overdraw issue?</strong>\",choices:[{text:'Change the material\\'s <code>Blend Mode</code> from <code>Translucent</code> to a more performant option like <code>Additive</code> or <code>Masked</code>.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> <code>Translucency</code> is extremely costly when multiple particles overlap. Changing the blend mode fixes the overdraw issue.</p>\",next:'step-10'},{text:'Reduce the size of the particle sprites in the <code>Niagara system</code>.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> Reduces the severity of overdraw but doesn\\'t fix the fundamental performance cost of the <code>Translucent</code> blend mode.</p>\",next:'step-10'},{text:'Enable the <code>Use Ray Tracing</code> flag on the material.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> <code>Ray Tracing</code> is a high-end feature that adds significant cost; it will not fix the overdraw issue.</p>\",next:'step-10'},{text:'Wait for the rendering team to provide a better shader.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> Blaming another team for a basic setup error is not a solution.</p>\",next:'step-10'}]},\n        'step-10': {isTask: true, skill:'perf',title:'The Draw Call Spike (Mass Placement)',prompt:\"<p>The lead places 50 Golems in the level for a stress test. The frame rate drops significantly, and the profiler flags <code>Draw Calls</code> and the <code>Render Thread</code> as the bottleneck.</p><strong>What common material setup is most likely causing excessive draw calls across all Golems?</strong>\",choices:[{text:'Check if the Golem\\'s eye glow or another feature is generating a unique <code>Dynamic Material Instance (DMI)</code> per Golem, thus breaking instancing.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> <code>DMIs</code> force unique <code>draw calls</code>, which is the classic cause of a <code>draw call spike</code> when actors should be instanced.</p>\",next:'step-11'},{text:'The VFX material is still causing complexity issues.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> Complexity affects shader time, not <code>draw call</code> count. You misidentified the bottleneck, but the area of investigation is material related.</p>\",next:'step-11'},{text:'The Golem <code>Skeletal Mesh</code> has too many material slots (<code>sub-meshes</code>).',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> This fix is misguided as the issue is DMI instantiation, not sub-mesh count.</p>\",next:'step-10M'},{text:'The <code>Tick</code> function is too heavy, starving the <code>Render Thread</code>.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> The profiler points specifically to the <code>Render Thread</code>\\'s <code>draw call</code> cost, not the <code>Game Thread</code>\\'s <code>Tick</code> cost.</p>\",next:'step-11'}]},\n        \n        // Dead-end: Mesh optimization doesn't fix instancing break\n        'step-10M': {isTask: false, skill:'perf',title:'Merging Mesh Slots (Dead End)',prompt:\"<p>You spent extended time optimizing the Golem mesh by combining its material slots (sub-meshes). While this reduced the base draw calls per Golem from 3 to 2, the **draw call spike** on the `Render Thread` persists when 50 Golems are placed.</p><strong>You realize the problem is still related to the material's instance parameters. What is the root cause?</strong>\",choices:[{text:'The eye glow is generating a unique <code>Dynamic Material Instance (DMI)</code> per Golem, thus breaking instancing.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> Correctly identifying the DMI as the sole cause of the draw call spike.</p>\",next:'step-11'},{text:'The mesh is using <code>World Position Offset</code>, which prevents instancing.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> <code>WPO</code> can be instanced if not using per-instance parameters. This is a common confusion point.</p>\",next:'step-11'}]},\n\n        'step-11': {isTask: true, skill:'material',title:'The DMI Refactor',prompt:\"<p>You confirm the Golem's eye material uses a <code>Dynamic Material Instance (DMI)</code> to drive the 'Enraged Glow' color per instance.</p><strong>What is the best alternative to <code>DMIs</code> for performant, instance-specific material parameters?</strong>\",choices:[{text:'Refactor the eye material to use a <code>Material Parameter Collection (MPC)</code>, which is a global data asset that can be updated in a single render pass.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> <code>MPCs</code> are the standard solution for globally synchronized material changes that don\\'t break instancing, saving hundreds of <code>draw calls</code>.</p>\",next:'step-12'},{text:'Use a <code>Per-Instance Custom Data</code> node in the material, driven by C++ code.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> Highly performant, but <code>MPCs</code> are generally easier to implement in <code>Blueprint-heavy</code> projects.</p>\",next:'step-12'},{text:'Remove the <code>DMI</code> and simplify the material until it no longer needs instance-specific parameters.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> This forces an unnecessary design change; the requirement is to *keep* the per-instance glow but make it performant.</p>\",next:'step-12'},{text:'Set the material to <code>Unlit</code>, as <code>unlit</code> materials are inherently faster to draw.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> The lit/unlit state does not affect whether the renderer can instance the material.</p>\",next:'step-12'}]},\n        'step-12': {isTask: true, skill:'material',title:'MPC Naming Conflict',prompt:\"<p>You implement the <code>MPC</code> glow, but when you test, the Golem's eyes are always the wrong color (e.g., green) regardless of the Golem's state.</p><strong>What is the most likely cause of your <code>MPC</code> value being ignored or overwritten?</strong>\",choices:[{text:'Another system in the level is also writing to the same <code>MPC</code> parameter every frame, causing a <code>naming collision</code> and overwriting your value.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> This is a classic 'battle of the systems' bug since <code>MPCs</code> are global. Parameter names must be unique to the feature.</p>\",next:'step-13'},{text:\"The Material assigned to the eye doesn't actually reference the <code>MPC</code>.\",type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> Plausible, but the eye color would likely be default (black), not a specific wrong color like green.</p>\",next:'step-13'},{text:'The Golem Blueprint is setting the <code>MPC</code> value on <code>Event BeginPlay</code>, which is too early.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> Timing is less of an issue here than the constant frame-by-frame overwrite.</p>\",next:'step-13'},{text:'You must call <code>Apply Changes</code> after setting an <code>MPC</code> value.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> No such node exists; the update is immediate.</p>\",next:'step-13'}]},\n        \n        // === 5. NETWORKING & REPLICATION ISSUES ===\n        'step-13': {isTask: true, skill:'rep',title:'Multilayer Glow Failure',prompt:\"<p>You rename your <code>MPC</code> parameter, and the glow works in single-player. But in multiplayer, client Golems don't glow when enraged. The server Golem glows correctly.</p><strong>What is the standard, efficient fix for replicating cosmetic state changes like the eye color?</strong>\",choices:[{text:\"Change the <code>IsEnraged</code> boolean variable's replication type to <code>RepNotify</code> and place the visual update logic in the generated <code>OnRep_IsEnraged</code> function.\",type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> <code>RepNotify</code> is efficient, event-driven, and correctly handles late joiners by ensuring the visual update runs reliably on clients when the variable state changes.</p>\",next:'step-14'},{text:'Create a <code>Multicast RPC</code> that runs the visual update logic on all clients whenever the state changes.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> A <code>Multicast</code> works for existing clients but fails for late joiners, who will never receive the <code>RPC</code>, causing desync.</p>\",next:'step-14'},{text:'Run the visual update logic on the client\\'s <code>Event Tick</code>, checking for the server-replicated variable change.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> Polling on <code>Tick</code> is highly inefficient, wasting CPU cycles checking a state that changes infrequently.</p>\",next:'step-14'},{text:'Enable the \"Replicates\" flag on the <code>Material Parameter Collection</code> asset itself.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> Data assets do not replicate; only actors and their properties do.</p>\",next:'step-14'}]},\n        'step-14': {isTask: true, skill:'rep',title:'Multilayer Animation Desync',prompt:\"<p>The glow replicates. However, when the Golem attacks, the server Golem plays the slam montage perfectly, but client Golems slide without the animation.</p><strong>How must the montage playback be replicated to clients?</strong>\",choices:[{text:\"Place the <code>Play Anim Montage</code> node inside a reliable <code>Multicast RPC</code>, ensuring all clients are explicitly told to run the cosmetic animation.\",type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> One-shot cosmetic events (like Montages or <code>VFX playback</code>) must be explicitly <code>Multicast</code> to all clients, as they are not automatically replicated with movement.</p>\",next:'step-15'},{text:'Change the <code>montage trigger variable</code> to a <code>RepNotify</code>.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> This is an indirect way that adds unnecessary state management complexity when a direct <code>Multicast RPC</code> is the cleaner pattern for one-shot events.</p>\",next:'step-15'},{text:'Increase the replication rate settings on the Golem\\'s <code>Skeletal Mesh Component</code>.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> Increasing the rate helps smooth movement but does not resolve the logical issue that the engine was never told to play the animation on the client.</p>\",next:'step-15'},{text:'Set the <code>Anim Montage</code> asset\\'s \"Replicate\" property to true.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> <code>Anim Montage</code> assets do not have a simple replication flag.</p>\",next:'step-15'}]},\n        'step-15': {isTask: true, skill:'rep',title:'Input Lockout Bug',prompt:\"<p>After being attacked by the Golem, players sometimes lose the ability to jump or use their secondary attack. Their primary attack still works.</p><strong>What is the most likely cause of this partial input lockout?</strong>\",choices:[{text:'A logic path is enabling a <code>Gameplay Ability</code> input or setting a <code>Gameplay Tag</code> on the character, but the corresponding disabling logic is failing to run.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> <code>Partial lockouts</code> are almost always tied to <code>Gameplay Tags</code> or the <code>Ability System</code> failing to remove an active state that is blocking specific input bindings.</p>\",next:'step-16'},{text:'The <code>character movement component</code> is disabled, preventing only movement-related inputs.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> The primary attack works, so the <code>movement component</code> isn\\'t the primary cause. The problem is selective input processing.</p>\",next:'step-16'},{text:'The <code>player controller</code> is losing its input focus (<code>Unpossessed</code>).',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> If <code>unpossessed</code>, the player would lose all input, including primary attack.</p>\",next:'step-16'},{text:'The <code>input mapping context</code> is corrupted.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> Corruption would cause a persistent, non-conditional failure.</p>\",next:'step-16'}]},\n        \n        // === 6. FINAL CLEANUP & BUILD ISSUES ===\n        'step-16': {isTask: true, skill:'perf',title:'Collision Snagging',prompt:\"<p>QA reports one last bug: \\\"The Golem sometimes gets stuck on small bits of rubble on the ground.\\\"</p><strong>What is the first and most direct thing to check to debug character movement snagging?</strong>\",choices:[{text:\"Select the Golem's <code>CapsuleComponent</code> in its Blueprint and check its size and position. Use the <code>p.ShowCollision</code> console command in-game to visualize it.\",type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> A character's movement is almost always governed by its root capsule. Visualizing the collision in-game is the fastest way to confirm if it\\'s too wide or low.</p>\",next:'step-17'},{text:\"Open the Golem's <code>Physics Asset</code> and simplify the collision bodies on its legs and feet.\",type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> This affects physical interactions, but the character\\'s primary *movement* collision is the capsule. Check the capsule first.</p>\",next:'step-17'},{text:'Increase the <code>Max Step Height</code> in the <code>Character Movement Component</code>.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> This can help the character walk over small ledges, but doesn\\'t solve the problem if the capsule is fundamentally too large.</p>\",next:'step-17'},{text:\"Increase the Golem's mass in its <code>Character Movement Component</code>.\",type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> Mass affects physics pushback, not basic collision shape for walking.</p>\",next:'step-17'}]},\n        'step-17': {isTask: true, skill:'material',title:'Build Packaging Failure',prompt:\"<p>The Golem is now working. You start the packaging process, but it fails with an error in the log: <code>Error: Found editor-only material expression DebugFloat3Values in /Game/Golems/Materials/M_Golem_Eye. Disallowed for cook.</code></p><strong>What does this mean?</strong>\",choices:[{text:'A <code>debug node</code> was left in the eye material. These nodes are not allowed in packaged builds and must be removed.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> The cooker strips out anything meant only for the editor. Leaving temporary <code>debug nodes</code> in the material graph causes this specific cook error.</p>\",next:'step-18'},{text:\"The material has a compile error that only shows up during cooking.\",type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> It is a compile error, but the log message is very specific. It\\'s not a general error, but one caused by a specific type of node.</p>\",next:'step-18'},{text:'You need to install the <code>Material Debugging Utilities</code> plugin for the packaged game.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> Debugging tools are explicitly meant for the editor only.</p>\",next:'step-18'},{text:'The material needs to be saved with the <code>Shipping Build</code> flag enabled.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> No such flag exists for individual material assets.</p>\",next:'step-18'}]},\n        'step-18': {isTask: true, skill:'material',title:'Cleaning the Shader',prompt:\"<p>You remove the offending <code>debug node</code> and re-save the material. You restart the packaging process. It fails again with a different, more general error regarding the Golem mesh.</p><strong>What common material error prevents a mesh from being included in a packaged build?</strong>\",choices:[{text:'The <code>Collision Hull</code> for the mesh is missing or the <code>LODs</code> were imported incorrectly, causing a <code>static mesh validation error</code> during cook.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> Complex meshes, especially <code>skeletal meshes</code>, must pass cook-time validation, which often fails due to missing <code>collision geometry</code> or malformed <code>LODs</code>.</p>\",next:'conclusion'},{text:'The material is still using a <code>virtual texture asset</code>.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> While <code>virtual textures</code> require proper setup, this is usually a separate warning, not a hard cook failure on a <code>static mesh component</code>.</p>\",next:'conclusion'},{text:'You forgot to set the <code>Skeletal Mesh Component</code> to \"Hidden In Game\".',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> Hiding actors does not affect cook validation.</p>\",next:'conclusion'},{text:'The issue is actually with the AnimBP, which must be compiled for the target platform.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> The error points to the mesh component itself, not the <code>AnimBP</code> logic.</p>\",next:'conclusion'}]}\n      }\n  },\n  // --------------------------------------------------------------------------\n  // DASH SCENARIO: Focus on Character Input, Movement, and Networking Authority\n  // --------------------------------------------------------------------------\n  dash: {\n    meta: {\n      title: \"Player Dash Ability is Broken\",\n      description:\n        \"Traversal ability unresponsive. Covers input setup, cooldowns, movement, effects, and replication.\",\n      estimateHours: 16.0 // Adjusted for a more realistic, yet efficient, completion target\n    },\n    start: \"step-1\",\n    steps:\n      {\n        // === 1. INPUT & CORE MECHANICS (Input Mapping, Movement, Cooldowns) ===\n        'step-1': {isTask: true, skill:'input',title:'The Unresponsive Dash',prompt:\"<p>You've set up an Enhanced Input Action for a player dash, but pressing the button does nothing. The <code>OnStarted</code> event never fires in your Character Blueprint.</p><strong>What is the most common reason for an Enhanced Input Action to fail?</strong>\",choices:[{text:'The <code>Input Mapping Context</code> containing the dash action has not been added to the <code>Player Controller</code> at runtime.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> Enhanced Input requires you to explicitly add your mapping contexts to the player's subsystem, usually on <code>BeginPlay</code>. Without this step, the system has no registered actions to listen for.</p>\",next:'step-2'},{text:'The input event is being consumed by another Blueprint.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> This is a possible issue, but the mapping context not being added is a more fundamental setup error that would prevent the input from ever being processed in the first place.</p>\",next:'step-2'},{text:'The <code>Input Action</code> asset has <code>Consume Input</code> unchecked.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> This setting controls whether the input continues down the stack *after* it fires. It doesn't prevent the initial event from firing.</p>\",next:'step-2'},{text:'The <code>Character Movement Component</code> is blocking the input.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> The movement component handles movement logic; it does not block raw input action events from firing.</p>\",next:'step-1W'}]},\n        'step-1W': {isTask: false, skill:'input',title:'Wrong Subsystem',prompt:\"<p>You search your Character Blueprint's <code>BeginPlay</code> but can't find where to add the mapping context. You try adding it to the Game Instance instead, but it still doesn't work.</p><strong>Where is the correct place to add an Input Mapping Context?</strong>\",choices:[{text:'Get the <code>Player Controller</code>, get its <code>Enhanced Input Local Player Subsystem</code>, and call <code>Add Mapping Context</code>.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> You've found the correct execution path. Input is managed by a player-specific subsystem, which is accessed through the <code>Player Controller</code>.</p>\",next:'step-2'},{text:'Add it in the <code>Project Settings</code> under <code>Input</code>.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> That section is for the legacy input system. Enhanced Input is configured via its own assets and must be added at runtime.</p>\",next:'step-2'},{text:'The <code>Level Blueprint</code> must add it for all players.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> While this might work for a single-player game, it's bad practice. Input is player-specific and should be handled in a player-specific class like the Player Controller or Pawn.</p>\",next:'step-2'},{text:'You have to cast to the specific pawn from the <code>Player Controller</code> first.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> The subsystem exists on the Local Player, which is accessible directly from the Player Controller. You don't need a reference to the pawn for this step.</p>\",next:'step-2'}]},\n        \n        // --- Core Movement Logic ---\n        'step-2': {isTask: true, skill:'movement',title:'Movement Without Motion',prompt:\"<p>The input now fires! Your logic calls a <code>Launch Character</code> node to propel the player forward. You use a <code>Print String</code> to confirm the node is executing, but your character doesn't move at all.</p><strong>What is the most likely reason for <code>Launch Character</code> to do nothing?</strong>\",choices:[{text:'The <code>Launch Velocity</code> input is <code>(0,0,0)</code>, or the player is already moving at max speed and the current velocity is not being overridden.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> A zero-vector launch will have no effect. You must calculate a velocity based on the character's forward direction. Also, ensure the <code>XYOverride</code> and <code>ZOverride</code> booleans are checked to ignore current velocity.</p>\",next:'step-3'},{text:'The <code>Character Movement Component</code> has <code>Simulate Physics</code> enabled.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> <code>Launch Character</code> is designed to work with the Character Movement Component's standard (non-physics-simulating) movement modes.</p>\",next:'step-3'},{text:'The player is blocked by a small object on the floor.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> If the player were blocked, you would typically see a small nudge or collision effect. A complete lack of any motion points to a zero-velocity input.</p>\",next:'step-2M'},{text:'The <code>Event Tick</code> on the character is disabled.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> <code>Launch Character</code> is an impulse and does not depend on the actor's Tick being enabled to function.</p>\",next:'step-3'}]},\n        \n        'step-2M': {isTask: false, skill:'movement',title:'Adjusting Walk Speed (Dead End)',prompt:\"<p>You decide the character is too heavy and try increasing the <code>Max Walk Speed</code> and <code>Braking Deceleration</code> on the <code>Character Movement Component</code>.</p><p>This is a dead end! <code>Max Walk Speed</code> and <code>Braking Deceleration</code> only affect ground movement and are irrelevant to the <code>Launch Character</code> node. The character still doesn't move.</p><strong>What must you check next?</strong>\",choices:[{text:'Check the <code>Launch Velocity</code> input for a zero vector, and check the <code>XYOverride</code>/<code>ZOverride</code> booleans.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> Returning to the core issue. The problem is with the launch parameters, not the character's standard locomotion settings.</p>\",next:'step-3'},{text:'Delete the <code>Launch Character</code> node and replace it with <code>Add Force</code>.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> <code>Add Force</code> requires simulating physics and is completely inappropriate for Character movement.</p>\",next:'step-3'},{text:'Check if the character\\'s mesh has <code>No Collision</code> set.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> Collision prevents motion, but not *absence* of motion. You are wasting time on unrelated settings.</p>\",next:'step-3'}]},\n\n        // --- Cooldown and Resource Management ---\n        'step-3': {isTask: true, skill:'systems',title:'Infinite Dashes',prompt:\"<p>You fix the velocity calculation and the dash works! However, the player can spam the dash button infinitely without any limitation. The dash is supposed to have a 2-second cooldown.</p><strong>What is the standard way to implement a cooldown for an ability?</strong>\",choices:[{text:'Use a boolean like <code>bIsDashOnCooldown</code>, set it to true after dashing, and use a <code>Set Timer by Event</code> node with a 2-second delay to call an event that sets it back to false.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> This is a robust and common pattern. The boolean acts as a gate for the ability, and the timer reliably re-opens the gate after the specified duration.</p>\",next:'step-4'},{text:'On dash, record the <code>Get Game Time in Seconds</code> and, on the next attempt, check if the current time is greater than the recorded time plus 2.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> This works, but it's less efficient than a timer because it requires you to run this check every time the input is pressed. The boolean gate is a cleaner, more performant approach.</p>\",next:'step-4'},{text:'Add a <code>Delay</code> node for 2 seconds at the end of the dash logic.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> This is a critical error. A Delay node will freeze the entire execution chain. If the player presses the button during the delay, the input will be ignored. It does not prevent the initial logic from running again.</p>\",next:'step-4'},{text:'Create a <code>Timeline</code> that is 2 seconds long and only allow dashing when it is finished.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> Timelines are for updating values over time (like a fade or a pulse), not for simple cooldown timers. A Timer is the correct and more lightweight tool for this job.</p>\",next:'step-4'}]},\n        'step-4': {isTask: true, skill:'systems',title:'Free Stamina',prompt:\"<p>The cooldown works. Now, the dash is supposed to cost 25 stamina, but the player's stamina bar doesn't decrease. You have a \\\"Stamina\\\" float variable on your Character Blueprint.</p><strong>The dash logic includes a node that subtracts 25 from the \\\"Stamina\\\" variable. Why might the value not be changing?</strong>\",choices:[{text:'The logic checks if the player has <strong>enough</strong> stamina <strong>before</strong> subtracting, but the initial check is failing, preventing the subtraction from ever running.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> This is a common logic flow error. You put a guard clause (e.g., <code>Branch: Stamina >= 25</code>) at the start, but if the player's stamina is, for example, 24.9, the subtraction logic is never reached.</p>\",next:'step-5'},{text:'The <code>Stamina</code> variable is not marked as <code>Instance Editable</code>.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> This setting only affects whether you can change the variable's default value from the level editor. It has no impact on changing the value at runtime via Blueprint nodes.</p>\",next:'step-5'},{text:'The subtraction is happening, but another node on <code>Event Tick</code> is resetting the stamina back to full every frame.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> This is a plausible and frustrating bug, but it's a good practice to first check the logic immediately surrounding the ability call before hunting for unrelated logic on the Tick event.</p>\",next:'step-5'},{text:'You are trying to subtract from a local variable that was copied from the real Stamina variable, instead of the actual class member variable.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> While this is a common error in text-based programming, in Blueprints you typically drag the variable directly from the \\\"My Blueprint\\\" panel, ensuring you're modifying the correct one.</p>\",next:'step-5'}]},\n        \n        // === 2. VFX, SOUND, & CAMERA ISSUES (Cosmetics) ===\n        'step-5': {isTask: true, skill:'vfx',title:'The Silent Whoosh',prompt:\"<p>The stamina cost is now correctly applied. A 'whoosh' sound is supposed to play during the dash via a <code>Play Sound at Location</code> node. The node is executing, but no sound is heard.</p><strong>What is the most fundamental reason for this node to fail to produce sound?</strong>\",choices:[{text:'The <code>Sound</code> input pin on the node is not assigned to a <code>Sound Wave</code> or <code>Sound Cue</code> asset.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> Just like many other nodes, if the primary asset input is <code>None</code>, the node will execute silently but do nothing. This is always the first thing to check.</p>\",next:'step-6'},{text:'The <code>Location</code> input is <code>(0,0,0)</code> and the player is far away from the world origin.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> This would also result in silence, but a missing sound asset is a more common and basic setup error.</p>\",next:'step-6'},{text:\"The sound's <code>Attenuation</code> settings have a radius of zero.\",type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> This is a plausible cause, but it's a data issue within the sound asset itself. You should first verify that the Blueprint node is even configured with an asset to play.</p>\",next:'step-6'},{text:'You are using <code>Play Sound at Location</code> instead of <code>Play Sound 2D</code>.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> A dash sound is spatialized and should emanate from the player, so <code>Play Sound at Location</code> is the correct node to use. <code>Play Sound 2D</code> is for non-spatial UI sounds.</p>\",next:'step-6'}]},\n        'step-6': {isTask: true, skill:'vfx',title:'The Invisible Trail',prompt:\"<p>The dash sound now plays correctly. A Niagara particle system is supposed to create a trail effect, but no particles appear. You've added a Niagara Component to your Character Blueprint.</p><strong>What is the most common reason for a Niagara Component to not play its effect at runtime?</strong>\",choices:[{text:'The component\\'s <code>Auto Activate</code> property is set to false, and you have not explicitly called the <code>Activate</code> node on the component in your dash logic.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> For performance, it's common practice to disable auto-activation for effects that only play on demand. You must manually trigger them with an <code>Activate</code> node when the ability is used.</p>\",next:'step-7'},{text:'The Niagara System asset itself has a compile error.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> This is possible, but you should always check your Blueprint activation logic first. A missing <code>Activate</code> call is far more common than a broken asset.</p>\",next:'step-7'},{text:'The material used by the particles is transparent, making them invisible.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> While a bad material could cause issues, it's highly unlikely to be completely invisible. It's more probable that the system isn't being told to run at all.</p>\",next:'step-7'},{text:'The <code>Niagara Component</code> must be the root component of the <code>Blueprint</code>.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> Particle components are meant to be attached to other components (like the character's mesh) and should almost never be the root.</p>\",next:'step-7'}]},\n        \n        // === 3. NETWORKING & REPLICATION ISSUES (Cosmetics & Authority) ===\n        'step-7': {isTask: true, skill:'rep',title:'The Invisible Dash',prompt:\"<p>The dash now works perfectly for you. In multiplayer, however, you can see your own dash effect, but you can't see other players dashing. They just teleport from point A to B.</p><strong>Why are the cosmetic parts of the dash (sound, VFX) not visible on other clients?</strong>\",choices:[{text:'The events that trigger the cosmetics are only running on the server and the local client. They need to be called from a <code>Multicast</code> RPC to execute on all clients.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> The server handles the authoritative movement (the teleport), which everyone sees. But cosmetic effects must be explicitly told to play for all observers via a Multicast event.</p>\",next:'step-8'},{text:'The <code>Niagara System</code> asset needs its <code>Replicates</code> flag checked.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> Assets do not have replication flags. Their *execution* must be controlled by replicated logic.</p>\",next:'step-8'},{text:'The other clients are too far away to see the effect.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> This is a logic replication issue, not a distance or culling problem. The clients are not being told to play the effect at all.</p>\",next:'step-8'},{text:'The logic should be in a <code>Run on Owning Client</code> RPC instead.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> This would make the effect visible to the player who is dashing (which it already is), but other players still wouldn't see it. A Multicast is needed to show it to everyone.</p>\",next:'step-8'}]},\n        \n        // --- Movement Authority and Synchronization ---\n        'step-8': {isTask: true, skill:'rep',title:'The Snap-Back',prompt:\"<p>You've multicast the cosmetic effects. Now, clients report that when they dash, they move smoothly for a moment and then snap back to their starting position.</p><strong>What causes this classic client-server desynchronization?</strong>\",choices:[{text:\"The dash logic (e.g., <code>Launch Character</code>) is only being executed on the client. The server, which has authority, doesn't know the dash occurred and corrects the client's position.\",type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> This is a fundamental networking concept. Any action that changes an actor's position must be executed on the server. The client's input should trigger a <code>Run on Server</code> RPC that contains the movement logic.</p>\",next:'step-9'},{text:'The client\\'s network connection is lagging.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> Lag will make the snap-back more noticeable, but the root cause is the logical error of not running the movement code on the server.</p>\",next:'step-9'},{text:'The <code>Character Movement Component</code> has <code>Allow Client-Side Prediction</code> disabled.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> Client-side prediction is what allows clients to feel responsive. You try enabling it to fix the snap-back.</p>\",next:'step-8M'},{text:'The Multicast event for the VFX is interfering with the movement.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> Cosmetic events and character movement are handled by separate systems and do not interfere with each other. This is a complete distraction.</p>\",next:'step-8W'}]},\n        \n        // Dead-end: Client Prediction Failure\n        'step-8M': {isTask: false, skill:'rep',title:'Client Prediction Failure (Dead End)',prompt:\"<p>You enabled <code>Allow Client-Side Prediction</code>, but the character still snaps back. Client-side prediction helps smooth *movement interpolation*, but it relies on the server validating and accepting the input, which isn't happening because the dash isn't running on the server.</p><strong>What is the next logical step to ensure the dash is acknowledged by the server?</strong>\",choices:[{text:'The client\\'s input must trigger a <code>Run on Server</code> RPC that contains the movement logic.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> You correctly identified the need for server authority over movement, not just client-side prediction.</p>\",next:'step-9'},{text:'Check the <code>Is Authority</code> node before the launch and branch the logic.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> Checking authority is often a good practice, but it doesn't solve the core problem of getting the client input to execute the authoritative action on the server.</p>\",next:'step-9'},{text:'Increase the <code>Network Update Frequency</code> on the character.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> This just increases the rate of the snap-back, not preventing the server from correcting the move.</p>\",next:'step-9'}]},\n        \n        // Dead-end: Irrelevant Authority Check\n        'step-8W': {isTask: false, skill:'rep',title:'Irrelevant Authority Check (Dead End)',prompt:\"<p>You waste time checking the relationship between the cosmetic multicast and character movement. This is a false lead; they are handled separately.</p><strong>What fundamental networking principle are you overlooking regarding player movement?</strong>\",choices:[{text:\"The client's input must trigger a <code>Run on Server</code> RPC that contains the movement logic.\",type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> Client-driven movement must always be executed by the server to maintain network authority and synchronization.</p>\",next:'step-9'},{text:'Check the <code>Is Valid</code> node before the launch and branch the logic.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> Irrelevant to network authority.</p>\",next:'step-9'},{text:'Increase the size of the <code>Replicated Movement</code> property struct.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> Incorrectly looking for a setting that doesn't exist to solve a logic error.</p>\",next:'step-9'}]},\n\n        // === 4. ANIMATION & COLLISION REFINEMENT ===\n        'step-9': {isTask: true, skill:'collision',title:'Dashing Through Walls',prompt:\"<p>You've moved the dash logic to a server RPC and it replicates correctly. However, QA reports that if they dash at a thin wall, they sometimes pass right through it.</p><strong>What feature of the Character Movement Component is designed to prevent this?</strong>\",choices:[{text:'Enabling <code>Sweep</code> on the movement call (e.g., <code>Set Actor Location</code>) or using a movement component function that sweeps automatically, like <code>Add Movement Input</code>.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> A 'teleport' without a sweep will not check for collisions between the start and end points. Enabling sweeping treats the movement as a continuous motion and respects collision, preventing tunneling.</p>\",next:'step-10'},{text:'Increasing the character\\'s capsule radius.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> While a larger capsule makes collision more likely, it doesn't solve the underlying issue of teleporting through objects without checking the path taken.</p>\",next:'step-10'},{text:'Enabling <code>Continuous Collision Detection</code> (CCD) on the capsule component.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> CCD is for physics-simulating objects to prevent tunneling at high speeds. For Character Movement, which is not a true physics simulation, sweeping is the correct and more performant solution.</p>\",next:'step-10'},{text:'Increasing the mass of the character.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> Mass has no effect on the kinematic movement of the Character Movement Component.</p>\",next:'step-10'}]},\n        'step-10': {isTask: true, skill:'animation',title:'The Static Dash',prompt:\"<p>The dash is mechanically sound. Now for the animation. You have a dash animation montage, but when you call <code>Play Anim Montage</code>, the character remains in their idle/run pose.</p><strong>What is a common setup error that prevents an Anim Montage from playing?</strong>\",choices:[{text:\"The <code>Anim BP's AnimGraph</code> is missing a <code>Slot</code> node. Montages need a named slot to play into, which overrides the base animation from the state machine.\",type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> The <code>AnimGraph</code> is a flow of poses. A <code>Slot</code> node acts as an injection point where a montage can temporarily take over the final animation pose.</p>\",next:'step-11'},{text:'The montage asset has not been saved.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> An unsaved asset would likely result in a <code>None</code> reference and a warning in the output log. If the node is executing without warnings, the problem is likely in the Anim BP setup.</p>\",next:'step-11'},{text:'The character is not in the correct <code>Movement Mode</code> (e.g., <code>Falling</code>).',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> Montages can be played regardless of the character's movement mode.</p>\",next:'step-11'},{text:'You must use <code>Play Animation</code> instead of <code>Play Anim Montage</code>.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> <code>Play Animation</code> is for simple, single-asset playback. Montages are specifically designed for layered, temporary animations like attacks or abilities, and <code>Play Anim Montage</code> is the correct node.</p>\",next:'step-11'}]},\n        'step-11': {isTask: true, skill:'animation',title:'The Blending Snap',prompt:\"<p>You add a Slot node and the dash montage now plays. However, it snaps into the animation and snaps back out instantly, which looks very jarring.</p><strong>What controls the smooth transition into and out of a montage?</strong>\",choices:[{text:'The <code>Blend In</code> and <code>Blend Out</code> time settings within the <code>Anim Montage</code> asset itself.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> These properties, found in the montage's details panel, control the duration over which the engine will interpolate from the base animation pose to the montage pose, and vice-versa.</p>\",next:'step-12'},{text:'The <code>Interpolation</code> settings on the <code>Blendspace</code> used in the <code>State Machine</code>.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> Blendspace interpolation affects transitions *within* the state machine (e.g., from idle to run), not how a montage blends on top of it.</p>\",next:'step-12'},{text:'A \"Montage Blend\" node in the Anim BP event graph.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> No such node exists. Blending is controlled by the montage asset's data.</p>\",next:'step-12'},{text:'The <code>Play Rate</code> input on the <code>Play Anim Montage</code> node.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> Play Rate controls the speed of the animation's playback, not the smoothness of the transition into it.</p>\",next:'step-12'}]},\n        'step-12': {isTask: true, skill:'animation',title:'The Root Motion Problem',prompt:\"<p>The blending is now smooth. However, the dash is now moving the player almost twice as far as intended. It seems like two systems are applying motion.</p><strong>What is the cause of this \\\"double movement\\\"?</strong>\",choices:[{text:'The animation has <code>Root Motion</code>, and you are also applying movement with a <code>Launch Character</code> node. You should do one or the other, not both.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> <code>Root Motion</code> extracts movement from the animation itself and applies it to the character. If you're also applying a manual launch, you're applying two sources of velocity. You should either disable <code>Root Motion</code> or remove the <code>Launch Character</code> call.</p>\",next:'step-13'},{text:'The animation\\'s <code>Play Rate</code> is set to 2.0.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> A faster play rate would make the animation finish faster, but it wouldn't double the distance of a separate <code>Launch Character</code> call.</p>\",next:'step-13'},{text:'The server is correcting the client\\'s position, causing an overshoot.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> A server correction would typically cause a snap-back, not a consistent doubling of movement distance.</p>\",next:'step-13'},{text:'The character\\'s <code>Max Walk Speed</code> is too high.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> Max Walk Speed applies to standard ground movement and does not affect the velocity applied by a launch or root motion.</p>\",next:'step-13'}]},\n        \n        // --- UI & Rendering Polish ---\n        'step-13': {isTask: true, skill:'ui',title:'Stale Stamina Bar',prompt:\"<p>You decide to use <code>Launch Character</code> and disable <code>Root Motion</code>. The movement is now correct. However, the UI's stamina bar does not update immediately after a dash. It only updates after the next time the player jumps or sprints.</p><strong>What causes this kind of delayed UI update?</strong>\",choices:[{text:'The UI is not being notified of the change. The stamina bar\\'s value is probably only being updated by other events (like jumping) and not by the dash event.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> This indicates that your UI update logic is not centralized. A robust solution is to use an <code>Event Dispatcher</code> or an <code>interface call</code> whenever stamina changes, which the UI can bind to and update itself accordingly.</p>\",next:'step-14'},{text:'The stamina bar widget has <code>Is Volatile</code> set to false.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> <code>Is Volatile</code> forces the widget to be redrawn every frame, which is bad for performance and doesn't solve the underlying problem that the data it's trying to draw is stale.</p>\",next:'step-14'},{text:'The widget has its <code>Tick</code> disabled.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> While you could update the UI on Tick, this is inefficient (\\\"polling\\\"). An event-driven approach where the UI is told when to update is far better.</p>\",next:'step-14'},{text:'The player\\'s stamina variable is not replicated.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> If the variable isn't replicated, clients' UI would be out of sync with the server. However, the problem describes a delayed update even for the local player, which points to a logic flow issue, not a replication one.</p>\",next:'step-14'}]},\n        'step-14': {isTask: true, skill:'render',title:'The Missing Blur',prompt:\"<p>The dash is supposed to trigger a radial blur Post Process effect. You have a Post Process Component on your character, and your logic is setting its parameters, but nothing happens to the screen.</p><strong>Why would setting parameters on a Post Process Component have no visible effect?</strong>\",choices:[{text:'The component is not enabled. You need to set its <code>Enabled</code> property to true at the start of the dash and false at the end.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> Just like particle systems, Post Process Components can be enabled and disabled for performance. Simply changing their parameters won't do anything if the component itself is not active.</p>\",next:'step-15'},{text:'The <code>Blend Weight</code> of the component is set to 0.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> A blend weight of 0 would also make the effect invisible. However, the enabled/disabled state is a more common and fundamental gate for the entire component's influence.</p>\",next:'step-15'},{text:'The level already has an Unbound <code>Post Process Volume</code> with a higher priority.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> While priority matters for blending, even a low-priority component would have *some* visible effect unless its blend weight was zero or it was disabled.</p>\",next:'step-15'},{text:'The material used for the effect has a compile error.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> A material error would likely show up as the default grid material on screen, not a complete lack of any effect.</p>\",next:'step-15'}]},\n        'step-15': {isTask: true, skill:'camera',title:'The Static Camera',prompt:\"<p>The dash is supposed to briefly increase the camera's Field of View (FOV) for a sense of speed. Your logic calls <code>Set Field of View</code> on the player's camera, but the FOV remains unchanged.</p><strong>What is the most likely reason the camera's properties are not being updated?</strong>\",choices:[{text:'You are getting a reference to the wrong camera. You might be modifying the default Camera Component instead of the active one, especially if you are using a system like a spring arm.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> A common error is to have multiple camera components (e.g., one for first-person, one for third-person) and get a reference to the inactive one. You must ensure you are targeting the currently active player camera.</p>\",next:'step-16'},{text:'The <code>Camera Manager</code> is overriding your settings.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> The Player Camera Manager is the final authority on camera settings. If it's running a camera shake or another effect, it could be overwriting your FOV change. However, getting a bad reference to the camera itself is a more basic error.</p>\",next:'step-16'},{text:'The \"Lock Camera\" setting is enabled on the character.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> No such setting exists. Camera control is managed through the Player Controller and Camera Manager.</p>\",next:'step-16'},{text:'You cannot change the <code>FOV</code> at runtime; it must be set in the <code>Blueprint</code> defaults.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> The FOV is designed to be changed dynamically at runtime for effects like sprinting, aiming, and dashing.</p>\",next:'step-16'}]},\n        \n        // === 5. COLLISION, PHYSICS & MOVEMENT REFINEMENT ===\n        'step-16': {isTask: true, skill:'physics',title:'The Immovable Crate',prompt:\"<p>Dashing into a physics-simulating crate is supposed to send it flying. Instead, it just stops your dash. Your overlap logic calls an <code>Add Impulse</code> node on the crate.</p><strong>Why would <code>Add Impulse</code> fail to move an object that is simulating physics?</strong>\",choices:[{text:'The impulse strength is too low compared to the mass of the object, or the crate has its <code>Lock Position</code> constraint enabled in its physics settings.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> Physics calculations are a balance of forces. If the impulse is too weak or the object's mass is astronomical, there will be no visible movement. Locked constraints would also prevent any movement.</p>\",next:'step-17'},{text:'The <code>Velocity Change</code> boolean on the <code>Add Impulse</code> node is unchecked.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> Checking this box makes the impulse ignore the object's mass, which can be a good way to guarantee movement. However, the root cause is still likely an imbalance of mass and force.</p>\",next:'step-17'},{text:'The crate is not a child of a Voxel Physics object.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> This is not a concept in standard Unreal Engine physics. Any component with <code>Simulate Physics</code> enabled can receive an impulse.</p>\",next:'step-17'},{text:'The server is rejecting the physics interaction.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> While physics replication can be complex, a basic impulse call that fails to move an object locally points to a physics properties issue, not a networking one.</p>\",next:'step-17'}]},\n        'step-17': {isTask: true, skill:'collision',title:'Dashing Off Ledges',prompt:\"<p>A new design requires an aerial dash. If the player dashes while in the air, they should move forward, not fall. Currently, they dash forward but still fall due to gravity.</p><strong>What setting in the <code>Launch Character</code> node can be used to achieve this?</strong>\",choices:[{text:'Check the <code>Z Override</code> boolean. This will make the Z component of your launch velocity replace the character\\'s current vertical velocity (i.e., gravity).',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> This is precisely what Z Override is for. By providing a Z velocity of 0 and overriding, you are effectively canceling out gravity for the duration of the launch, resulting in a horizontal air dash.</p>\",next:'step-18'},{text:'Set the <code>Character Movement Component\\'s Gravity Scale</code> to 0 before the dash.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> This would work, but it's a \\\"leaky\\\" abstraction. You would need to remember to set it back to 1.0 after the dash. The <code>Launch Character</code> node's built-in override is a cleaner, more self-contained solution.</p>\",next:'step-18'},{text:'Set the <code>Movement Mode</code> to <code>Flying</code> before the dash.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> While this would negate gravity, it's a heavy-handed state change that has many other side effects. It's not the intended way to implement an air dash.</p>\",next:'step-18'},{text:'The Z value of the <code>Launch Velocity</code> needs to be a large positive number.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> This would launch the character upwards, not create a level horizontal dash. To cancel falling, you need to override the existing downward velocity.</p>\",next:'step-18'}]},\n        'step-18': {isTask: true, skill:'systems',title:'Dashing While Stunned',prompt:\"<p>The player can still dash even when a 'stunned' gameplay effect is active. The stun effect is supposed to block all abilities.</p><strong>What is the best-practice way to have systems like stuns block abilities like the dash?</strong>\",choices:[{text:'Use <code>Gameplay Tags</code>. The stun effect should grant the player a <code>State.Stunned</code> tag, and the dash ability logic should have a check for <code>Has Tag: State.Stunned</code> at the very beginning.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> <code>Gameplay Tags</code> are the ideal, data-driven way to manage states and abilities. It's scalable, decoupled, and makes it easy to see what states an actor is in and what abilities are blocked by those states.</p>\",next:'step-19'},{text:'Create a <code>bIsStunned</code> boolean on the Player Character and check it before dashing.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> This works for one or two states, but it's not scalable. What if you add a \\\"rooted\\\" state, a \\\"silenced\\\" state, etc.? You'll end up with a messy pile of booleans. Tags are designed to solve this problem cleanly.</p>\",next:'step-19'},{text:'From the stun logic, call <code>Disable Input</code> on the <code>Player Controller</code>.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> This is a sledgehammer approach. It would block *all* input, including looking around or opening the menu. A proper stun should only block specific actions, which tags allow you to do.</p>\",next:'step-19'},{text:'The dash logic should get all actors with a \"stun\" component and check if the player is one of them.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> This inverts the dependency and is very inefficient. The player should know their own state; they shouldn't have to search the entire world to find out if they are stunned.</p>\",next:'step-19'}]},\n        'step-19': {isTask: true, skill:'collision',title:'The Trace Check',prompt:\"<p>To prevent dashing into walls, you add a capsule trace before the launch to see if the path is clear. However, the trace immediately hits your own character, and the dash always fails.</p><strong>How do you prevent a trace from hitting the actor that initiated it?</strong>\",choices:[{text:'Add your character to the <code>Actors to Ignore</code> array pin on the trace node.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> This is the most direct and explicit way to solve the problem. The trace will then ignore the specified actor and correctly check the environment beyond it.</p>\",next:'step-20'},{text:'In your character\\'s collision settings, set the <code>Trace Response</code> channel to <code>Ignore</code>.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> This would make your character ignore *all* traces of that type, which could have unintended side effects for other systems (like AI visibility checks or weapon targeting).</p>\",next:'step-20'},{text:'Set the <code>Trace Complexity</code> to <code>Simple Collision</code>.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> This determines whether the trace uses the simple physics body or the complex per-poly mesh. It doesn't affect which actors are hit.</p>\",next:'step-20'},{text:'Start the trace from a location far in front of the character.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> This is a common but flawed workaround. It creates a \\\"dead zone\\\" right in front of the player where obstacles won\\'t be detected. Using \\\"Actors to Ignore\\\" is the correct solution.</p>\",next:'step-20'}]},\n        \n        // === 6. PERFORMANCE & FINAL GAS REFACTOR ===\n        'step-20': {isTask: true, skill:'perf',title:'The Cost of Dashing',prompt:\"<p>The game runs smoothly, but a profiler reveals that every time a dash occurs, there is a small but noticeable garbage collection (GC) hitch. The dash logic itself doesn't seem to be creating actors.</p><strong>What non-obvious part of Blueprint can create objects and trigger GC?</strong>\",choices:[{text:'Using <code>Format Text</code> nodes or string <code>Append</code> nodes. These create new <code>FString</code> objects in memory that the garbage collector eventually needs to clean up.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> This is a common hidden performance cost. For frequently updated debug text or UI, these nodes can generate a lot of temporary string objects. In performance-critical code, it's better to avoid them.</p>\",next:'step-21'},{text:'Calling a pure function.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> Pure functions are just functions that don't modify state; they do not inherently create objects or cause GC hitches.</p>\",next:'step-21'},{text:'Using a <code>For Each Loop</code> node.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> Loops iterate over existing memory; they do not allocate new objects for each iteration.</p>\",next:'step-21'},{text:'Creating a local variable inside a function.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> Local variables are allocated on the stack and are cleaned up when the function returns. They are not managed by the garbage collector and do not cause GC hitches.</p>\",next:'step-21'}]},\n        'step-21': {isTask: true, skill:'audio',title:'The Abrupt Sound Cutoff',prompt:\"<p>The dash sound effect has a nice, fading tail. However, if the player dashes again quickly, the tail of the previous sound cuts off instantly to play the new one.</p><strong>How do you allow multiple instances of a sound to overlap and play out fully?</strong>\",choices:[{text:'In the <code>Sound Cue</code> or <code>Sound Wave</code> asset, adjust the <code>Concurrency</code> settings to allow more than one instance of the sound to play at once.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> Concurrency settings manage how many instances of a sound can be active. By increasing the \\\"Max Count\\\", you allow new sounds to play without stopping the old ones.</p>\",next:'step-22'},{text:'Use \"Spawn Sound Attached\" instead of \"Play Sound at Location\".',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> Both nodes are affected by the asset's concurrency settings. Changing the node won't solve the underlying data limitation.</p>\",next:'step-22'},{text:'Add a <code>Fade Out</code> node before playing the new sound.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> This would make the problem sound smoother, but it wouldn't solve the core issue of allowing the sounds to overlap naturally.</p>\",next:'step-22'},{text:'In the <code>Project Settings</code>, increase the <code>Max Audio Channels</code>.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> While a very low number of max channels could cause sounds to be culled, the Concurrency setting on the asset itself is the direct and intended control for this specific behavior.</p>\",next:'step-22'}]},\n        \n        // --- Gameplay Ability System (GAS) Conversion ---\n        'step-22': {isTask: true, skill:'systems',title:'The State Machine Conflict (GAS)',prompt:\"<p>You refactor your dash logic to use a Gameplay Ability from the Gameplay Ability System (GAS). When you try to activate the ability, it fails silently.</p><strong>What is a common reason for a Gameplay Ability to fail to activate?</strong>\",choices:[{text:'The ability is being blocked by another tag. The <code>Blocked by Tags</code> property on the ability is preventing it from running while the character has a tag like <code>State.Sprinting</code>.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> <code>GAS</code> uses <code>Gameplay Tags</code> extensively for control flow. An ability can have tags that block it, and it can be blocked by tags that the character currently possesses. This is the first place to check for an activation failure.</p>\",next:'step-23'},{text:'The <code>Ability System Component</code> is not on the <code>Player State</code>.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> While the ASC is often on the Player State, it can also be on the Character. The location of the component is less likely to be the issue than a tag conflict.</p>\",next:'step-23'},{text:'The ability has no \"Cost\" Gameplay Effect.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> An ability does not need to have a cost to be activated.</p>\",next:'step-23'},{text:'The <code>Try Activate Ability by Class</code> node is bugged.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> This node is the standard way to activate abilities and is very reliable. The failure is almost certainly in your data setup (tags, costs, cooldowns), not the node itself.</p>\",next:'step-23'}]},\n        'step-23': {isTask: true, skill:'systems',title:'The Unapplied Cooldown (GAS)',prompt:\"<p>Your dash ability now activates through GAS. However, the cooldown isn't working. The ability can be spammed. You have a \\\"Cooldown\\\" Gameplay Effect specified in the ability's details.</p><strong>Why would a Cooldown Gameplay Effect fail to apply?</strong>\",choices:[{text:'The <code>Gameplay Effect\\'s</code> duration is set to <code>Instant</code> instead of <code>Has Duration</code>. A cooldown must have a duration to be effective.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> An instant Gameplay Effect applies and is immediately removed. For a cooldown, the effect must be applied to the character for a set duration, during which it grants a tag that blocks the ability.</p>\",next:'step-24'},{text:'The <code>Gameplay Effect</code> is missing a <code>Magnitude</code> modifier.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> Magnitude is for how much an attribute is changed (e.g., damage amount). It is irrelevant for a simple cooldown tag.</p>\",next:'step-24'},{text:'The <code>Cooldown Tags</code> in the ability are not set correctly.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> The ability needs to check for the cooldown tag granted by the effect. However, if the effect itself isn't applying correctly (due to being Instant), this check doesn't matter.</p>\",next:'step-24'},{text:'The server is not authoritative over the Gameplay Effect.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> By default, Gameplay Effects are handled authoritatively by the server. This is not something you would typically configure incorrectly.</p>\",next:'step-24'}]},\n        \n        // --- Final Build and Polish ---\n        'step-24': {isTask: true, skill:'build',title:'The Cooker Warning',prompt:\"<p>You are packaging a build and see a warning in the log: <code>LogCook: Warning: /Game/Characters/BP_PlayerCharacter references /Game/UI/WBP_DebugHUD. WBP_DebugHUD is an editor-only asset and will not be cooked.</code> The build succeeds, but you're concerned.</p><strong>What is the best way to fix this?</strong>\",choices:[{text:'Wrap the logic that creates the debug widget in a <code>Is Standalone Screen</code> or <code>Is With Editor</code> macro node to ensure it only runs in editor builds.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> These macro nodes are specifically designed to strip out editor-only logic from packaged builds, which resolves the warning and prevents potential errors in the shipped game.</p>\",next:'step-25'},{text:'Delete the debug widget logic entirely.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> The debug widget is likely useful for development. Removing it completely is a short-sighted fix. The goal is to keep it for developers but exclude it for players.</p>\",next:'step-25'},{text:'Move the debug widget to the \"Developer\" content folder.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> This can help organize assets, and some cooker settings can be configured to exclude developer folders. However, using the editor-only macros is a more explicit and reliable way to control the logic flow.</p>\",next:'step-25'},{text:'Ignore the warning, since the build succeeded.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> A successful build with cooking warnings is not a clean build. This warning indicates that a reference will be <code>None</code> in the packaged game, which could lead to a crash if not handled properly.</p>\",next:'step-25'}]},\n        'step-25': {isTask: true, skill:'perf',title:'The Final Polish',prompt:\"<p>The dash is feature-complete. The last piece of feedback is that the stop feels 'floaty'. The player continues to slide for a moment after the dash velocity is applied.</p><strong>What property in the Character Movement Component controls how quickly a character comes to a stop?</strong>\",choices:[{text:'<code>Braking Deceleration Walking</code>. Increasing this value will make the character decelerate faster, resulting in a tighter, more responsive stop.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> This is the direct physics-based property that controls friction and braking force on the ground. Tuning this value is key to achieving the desired game feel for movement.</p>\",next:'conclusion'},{text:'<code>Max Acceleration</code>.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> This controls how quickly the character gets *up to* max speed, not how quickly they stop.</p>\",next:'conclusion'},{text:'\"Mass\".',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> Mass is not used for the standard kinematic movement calculations in the Character Movement Component. It only comes into play when being pushed by external physical forces.</p>\",next:'conclusion'},{text:'<code>Use Separate Braking Friction</code>.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> This boolean enables a separate friction value for braking, but the <code>Braking Deceleration</code> is the actual value that needs to be tuned.</p>\",next:'conclusion'}]}\n      }\n  },\n\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\temp_scorm12_extract\\scorm.js","messages":[{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":4,"column":3,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":121,"endColumn":8,"fix":{"range":[88,91],"text":"let"}},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":5,"column":5,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":5,"endColumn":20,"fix":{"range":[121,124],"text":"let"}},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":6,"column":5,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":6,"endColumn":27,"fix":{"range":[141,144],"text":"let"}},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":9,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":9,"endColumn":21,"fix":{"range":[198,201],"text":"let"}},{"ruleId":"no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":20,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":17},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":20,"column":19,"nodeType":"BlockStatement","messageId":"unexpected","endLine":20,"endColumn":21,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[462,462],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":24,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":17},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":24,"column":19,"nodeType":"BlockStatement","messageId":"unexpected","endLine":24,"endColumn":21,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[581,581],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":36,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":36,"endColumn":26,"fix":{"range":[774,777],"text":"let"}},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":38,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":38,"endColumn":48,"fix":{"range":[873,876],"text":"let"}},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":42,"column":11,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":42,"endColumn":66,"fix":{"range":[986,989],"text":"let"}},{"ruleId":"no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":47,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":47,"endColumn":19},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":47,"column":21,"nodeType":"BlockStatement","messageId":"unexpected","endLine":47,"endColumn":23,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[1272,1272],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":53,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":53,"endColumn":26,"fix":{"range":[1343,1346],"text":"let"}},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":55,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":55,"endColumn":35,"fix":{"range":[1438,1441],"text":"let"}},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":61,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":61,"endColumn":26,"fix":{"range":[1557,1560],"text":"let"}},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":67,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":67,"endColumn":26,"fix":{"range":[1730,1733],"text":"let"}},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":73,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":73,"endColumn":26,"fix":{"range":[1900,1903],"text":"let"}},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":94,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":94,"endColumn":47,"fix":{"range":[2665,2668],"text":"let"}},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":95,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":95,"endColumn":54,"fix":{"range":[2712,2715],"text":"let"}},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":96,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":96,"endColumn":45,"fix":{"range":[2766,2769],"text":"let"}}],"suppressedMessages":[],"errorCount":18,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":15,"fixableWarningCount":0,"source":"/*! Minimal SCORM 1.2 helper (no external deps). */\n(function (win) {\n  'use strict';\n  var SCORM12 = (function () {\n    var API = null;\n    var connected = false;\n\n    function _findAPI(w) {\n      var depth = 0;\n      try {\n        while (w && depth < 20) {\n          if (w.API) return w.API;\n          if (w.parent && w.parent !== w) {\n            w = w.parent;\n          } else {\n            break;\n          }\n          depth++;\n        }\n      } catch (e) {}\n      // opener case\n      try {\n        if (win.opener && win.opener.API) return win.opener.API;\n      } catch (e) {}\n      return null;\n    }\n\n    function getAPI() {\n      if (API) return API;\n      API = _findAPI(win);\n      return API;\n    }\n\n    function init() {\n      if (connected) return true;\n      var api = getAPI();\n      if (!api || typeof api.LMSInitialize !== \"function\") return false;\n      var ok = api.LMSInitialize(\"\") == \"true\";\n      connected = !!ok;\n      if (connected) {\n        try {\n          var status = api.LMSGetValue(\"cmi.core.lesson_status\");\n          if (!status || status === \"not attempted\" || status === \"unknown\" || status === \"0\") {\n            api.LMSSetValue(\"cmi.core.lesson_status\", \"incomplete\");\n            api.LMSCommit(\"\");\n          }\n        } catch (e) {}\n      }\n      return connected;\n    }\n\n    function finish() {\n      var api = getAPI();\n      if (!api || typeof api.LMSFinish !== \"function\") return false;\n      var res = api.LMSFinish(\"\");\n      connected = false;\n      return res == \"true\";\n    }\n\n    function commit() {\n      var api = getAPI();\n      if (!api || typeof api.LMSCommit !== \"function\") return false;\n      return api.LMSCommit(\"\") == \"true\";\n    }\n\n    function getValue(elm) {\n      var api = getAPI();\n      if (!api || typeof api.LMSGetValue !== \"function\") return \"\";\n      return api.LMSGetValue(elm);\n    }\n\n    function setValue(elm, val) {\n      var api = getAPI();\n      if (!api || typeof api.LMSSetValue !== \"function\") return false;\n      return api.LMSSetValue(elm, String(val)) == \"true\";\n    }\n\n    function setStatus(status) {\n      return setValue(\"cmi.core.lesson_status\", status);\n    }\n\n    function getStatus() {\n      return getValue(\"cmi.core.lesson_status\");\n    }\n\n    function setScoreRaw(raw, min, max) {\n      if (typeof raw !== \"undefined\") setValue(\"cmi.core.score.raw\", Math.round(raw));\n      if (typeof min !== \"undefined\") setValue(\"cmi.core.score.min\", Math.round(min));\n      if (typeof max !== \"undefined\") setValue(\"cmi.core.score.max\", Math.round(max));\n    }\n\n    function secondsToSCORMTime(totalSeconds) {\n      totalSeconds = Math.max(0, Math.floor(totalSeconds || 0));\n      var h = Math.floor(totalSeconds / 3600);\n      var m = Math.floor((totalSeconds % 3600) / 60);\n      var s = Math.floor(totalSeconds % 60);\n      function pad(n){ return (n<10?\"0\":\"\")+n; }\n      return pad(h)+\":\"+pad(m)+\":\"+pad(s);\n    }\n\n    function setSessionTimeSeconds(sec) {\n      return setValue(\"cmi.core.session_time\", secondsToSCORMTime(sec));\n    }\n\n    function isConnected() { return connected; }\n\n    return {\n      init: init,\n      finish: finish,\n      commit: commit,\n      getValue: getValue,\n      setValue: setValue,\n      setStatus: setStatus,\n      getStatus: getStatus,\n      setScoreRaw: setScoreRaw,\n      setSessionTimeSeconds: setSessionTimeSeconds,\n      secondsToSCORMTime: secondsToSCORMTime,\n      isConnected: isConnected,\n      getAPI: getAPI\n    };\n  })();\n  win.SCORM12 = SCORM12;\n})(window);\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\temp_scorm_extract\\UE5ScenarioTracker-main\\game.js","messages":[{"ruleId":"prefer-const","severity":1,"message":"'debugAccessState' is never reassigned. Use 'const' instead.","line":11,"column":9,"nodeType":"Identifier","messageId":"useConst","endLine":11,"endColumn":25,"fix":{"range":[561,679],"text":"const debugAccessState = {\n        passwordModalVisible: false // Tracks if the password input is currently shown\n    };"}},{"ruleId":"no-unused-vars","severity":1,"message":"'headerControls' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":17,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'ticketViewColumn' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":17,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":54},{"ruleId":"no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":281,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":281,"endColumn":23},{"ruleId":"prefer-const","severity":1,"message":"'totalLoggedTime' is never reassigned. Use 'const' instead.","line":334,"column":17,"nodeType":"Identifier","messageId":"useConst","endLine":334,"endColumn":32,"fix":{"range":[13074,13174],"text":"const totalLoggedTime = Object.values(initialScenarioState).reduce((acc, s) => acc + s.loggedTime, 0);"}},{"ruleId":"no-unused-vars","severity":1,"message":"'isTestRunning' is defined but never used. Allowed unused vars must match /^_/u.","line":375,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":375,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"isTestRunning"},"fix":{"range":[14978,15129],"text":""},"desc":"Remove unused variable 'isTestRunning'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'resetAllScenarioState' is defined but never used. Allowed unused vars must match /^_/u.","line":535,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":535,"endColumn":35,"suggestions":[{"messageId":"removeVar","data":{"varName":"resetAllScenarioState"},"fix":{"range":[21034,21390],"text":""},"desc":"Remove unused variable 'resetAllScenarioState'."}]},{"ruleId":"prefer-const","severity":1,"message":"'totalLoggedTime' is never reassigned. Use 'const' instead.","line":890,"column":17,"nodeType":"Identifier","messageId":"useConst","endLine":890,"endColumn":32,"fix":{"range":[34824,34917],"text":"const totalLoggedTime = Object.values(scenarioState).reduce((acc, s) => acc + s.loggedTime, 0);"}}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":3,"source":"// Wait for the DOM to be fully loaded before running the game logic\ndocument.addEventListener('DOMContentLoaded', () => {\n\n    // --- GLOBAL CONFIGURATION ---\n    const TOTAL_TEST_TIME_SECONDS = 30 * 60; // Total 30 minutes for the assessment countdown timer\n    const LOW_TIME_WARNING_SECONDS = 5 * 60; // Time remaining threshold to trigger pulsing red timer\n    const PASS_THRESHOLD = 0.80; // Pass if (Ideal Time / Logged Time) >= 80%\n    const DEBUG_PASSWORD = 'IloveUnreal'; // Secret password to enable Debug Mode\n\n    // --- DEBUG ACCESS STATE ---\n    let debugAccessState = {\n        passwordModalVisible: false // Tracks if the password input is currently shown\n    };\n\n    // --- DOM ELEMENT CACHE ---\n    // Note: Removed unused variables related to audit features and hard reset UI.\n    let headerControls, backlogList, ticketViewColumn, ticketPlaceholder, \n        ticketContent, ticketTitle, ticketDescription, ticketStepContent,\n        debugToggle, countdownTimer, jiraBoard, timesUpScreen, \n        debugDropdown; \n    \n    let timerContainer; // Parent container for the countdown timer\n\n    // --- CORE GAME STATE ---\n    let scenarioState = {}; // Stores progress, time logged, and choices for each scenario (Ticket)\n    let currentScenarioId = null; // Key of the scenario currently displayed (e.g., 'golem')\n    let currentStepId = null; // Key of the current question step within the scenario\n    let interruptedSteps = {}; // Stores the last active step for non-completed scenarios\n    let isDebugMode = false; // Flag for debug visualization/controls\n    let mainTimerInterval = null; // ID for the setInterval used for the 30-minute countdown\n    \n    let timeRemaining = TOTAL_TEST_TIME_SECONDS; // Remaining time on the countdown timer\n    \n\t// --- ENCODING UTILITIES (Restored for Test Key Generation) ---\n    /**\n     * Encodes a string to a Unicode-safe Base64 string.\n     * @param {string} str - The string to encode.\n     * @returns {string} The Base64 encoded string.\n     */\n    function base64EncodeUnicode(str) {\n        const utf8Bytes = encodeURIComponent(str).replace(/%([0-9A-F]{2})/g,\n            function(match, p1) {\n                return String.fromCharCode('0x' + p1);\n            });\n            return btoa(utf8Bytes);\n    }\n    \n\t// --- TIMER & TIME UTILITIES ---\n    \n    /**\n     * Converts total seconds into MM:SS format for display.\n     * @param {number} totalSeconds - Total seconds remaining.\n     * @returns {string} Formatted time string (MM:SS).\n     */\n    function formatTime(totalSeconds) {\n        const minutes = Math.floor(totalSeconds / 60);\n        const seconds = Math.floor(totalSeconds % 60);\n        return `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;\n    }\n\n    /**\n     * Calculates the time cost in hours based on the choice type.\n     * @param {string} type - 'correct', 'partial', 'misguided', 'wrong'.\n     * @returns {number} Time cost in hours.\n     */\n    function getTimeCostForChoice(type) {\n        switch (type) {\n            case 'correct':\n                return 0.5; // Optimal\n            case 'partial':\n                return 1.0; // Standard\n            case 'misguided':\n                return 1.5; // Extended\n            case 'wrong':\n                return 2.0; // Maximum\n            default:\n                return 0;\n        }\n    }\n\n    // --- TIMER LOGIC ---\n    \n    /**\n     * Updates the main timer display, applies visual cues, and handles expiry.\n     */\n    function updateMainTimerDisplay() {\n        // 1. Update Display\n        countdownTimer.textContent = formatTime(timeRemaining);\n        \n        // 2. Update Color/Pulse based on time left\n        countdownTimer.classList.remove('pulse-red', 'text-blue-300', 'text-yellow-400', 'text-orange-400', 'text-green-500');\n        if (timeRemaining <= LOW_TIME_WARNING_SECONDS && timeRemaining > 0) {\n            countdownTimer.classList.add('text-yellow-400', 'pulse-red');\n        } else if (timeRemaining > 0) {\n            countdownTimer.classList.add('text-blue-300');\n        }\n\n        // 3. Time's Up Check\n        if (timeRemaining <= 0) {\n            endGameByTime();\n            return;\n        }\n\n        // 4. Decrement\n        timeRemaining--;\n        \n        // 5. Save remaining time to Local Storage\n        localStorage.setItem('ue5ScenarioTimer', timeRemaining.toString());\n    }\n\n    /**\n     * Starts the main 30-minute countdown timer.\n     */\n    function startMainTimer(isInitialStart = false) {\n        // Load time state\n        if (isInitialStart) {\n            timeRemaining = TOTAL_TEST_TIME_SECONDS;\n            localStorage.removeItem('ue5ScenarioTimer');\n        } else {\n            const savedTime = localStorage.getItem('ue5ScenarioTimer');\n            if (savedTime !== null) {\n                timeRemaining = parseInt(savedTime, 10);\n            } else {\n                timeRemaining = TOTAL_TEST_TIME_SECONDS;\n            }\n        }\n        \n        // CRITICAL FIX: Ensure timer container is visible if time is > 0\n        if (timerContainer && timeRemaining > 0) {\n            timerContainer.classList.remove('hidden');\n        }\n\n        if (mainTimerInterval) clearInterval(mainTimerInterval);\n        \n        if (timeRemaining > 0) {\n             updateMainTimerDisplay(); // Initial display update\n             mainTimerInterval = setInterval(updateMainTimerDisplay, 1000); // Start the 1-second interval\n        } else {\n             endGameByTime(); // Time already ran out\n        }\n    }\n    \n    /**\n     * Pauses the countdown timer without clearing state.\n     */\n    function pauseMainTimer() {\n        if (mainTimerInterval) {\n            clearInterval(mainTimerInterval);\n            mainTimerInterval = null;\n        }\n    }\n    \n    /**\n     * Resumes the countdown timer only if the assessment is incomplete.\n     */\n    function resumeMainTimer() {\n        if (!mainTimerInterval) {\n            const allComplete = Object.values(scenarioState).every(state => state.completed);\n            if (!allComplete) {\n                mainTimerInterval = setInterval(updateMainTimerDisplay, 1000);\n            }\n        }\n    }\n\n    // --- CORE GAME INITIALIZATION ---\n\n    /**\n     * Toggles the Debug Mode state and updates the UI visibility.\n     */\n    function toggleDebugMode(forceDisable = false) {\n        if (forceDisable) {\n            isDebugMode = false;\n        } else {\n            isDebugMode = !isDebugMode;\n        }\n        \n        // Manually toggle UI state\n        if (debugDropdown) {\n            debugDropdown.classList.toggle('hidden', !isDebugMode);\n        }\n        \n        // Update internal logic based on new mode\n        if (isDebugMode) {\n            pauseMainTimer();\n            // Allow copying/inspection in debug mode\n            document.body.classList.remove('unselectable');\n        } else {\n            resumeMainTimer();\n            // Re-enable security when exiting debug mode\n            document.body.classList.add('unselectable');\n        }\n        \n        // Update the visual status of the hidden toggle (for consistency)\n        if (debugToggle) {\n            debugToggle.checked = isDebugMode;\n        }\n        \n        // Re-render current step to show/hide hints if a ticket is open\n        if (currentScenarioId && currentStepId) {\n            renderStep(currentScenarioId, currentStepId);\n        }\n    }\n\n    /**\n     * Shows the password input modal when the secret key combination is pressed.\n     */\n    function showPasswordModal() {\n        if (debugAccessState.passwordModalVisible) return;\n        debugAccessState.passwordModalVisible = true;\n\n        const modalHtml = `\n            <div id=\"password-modal\" class=\"fixed inset-0 bg-gray-900 bg-opacity-75 z-[999] flex items-center justify-center\">\n                <div class=\"bg-gray-800 p-8 rounded-xl shadow-2xl text-center max-w-sm w-full\">\n                    <h3 class=\"text-xl font-bold text-blue-400 mb-4\">Administrator Access Required</h3>\n                    <p class=\"text-gray-300 mb-6\">Enter the password to enable Debug Mode:</p>\n                    <input type=\"password\" id=\"password-input\" placeholder=\"Password...\" \n                           class=\"w-full p-3 rounded-lg bg-gray-700 border border-gray-600 text-yellow-300 focus:ring-blue-500 focus:border-blue-500 text-center mb-4\">\n                    <div class=\"flex justify-around space-x-3\">\n                        <button id=\"submit-password\" class=\"flex-1 bg-green-600 hover:bg-green-700 text-white font-semibold py-2 rounded-lg transition-all duration-200\">\n                            Enable\n                        </button>\n                        <button id=\"cancel-password\" class=\"flex-1 bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 rounded-lg transition-all duration-200\">\n                            Cancel\n                        </button>\n                    </div>\n                </div>\n            </div>\n        `;\n        \n        document.body.insertAdjacentHTML('beforeend', modalHtml);\n\n        const modal = document.getElementById('password-modal');\n        const input = document.getElementById('password-input');\n        \n        input.focus();\n\n        const cleanup = () => {\n            modal.remove();\n            debugAccessState.passwordModalVisible = false;\n        };\n\n        const checkPassword = () => {\n            if (input.value === DEBUG_PASSWORD) {\n                toggleDebugMode(); // Enable Debug Mode\n                cleanup();\n            } else {\n                input.value = '';\n                input.placeholder = 'Incorrect Password!';\n                input.classList.add('ring-2', 'ring-red-500');\n                setTimeout(() => {\n                    input.classList.remove('ring-2', 'ring-red-500');\n                }, 1000);\n            }\n        };\n\n        document.getElementById('submit-password').addEventListener('click', checkPassword);\n        document.getElementById('cancel-password').addEventListener('click', cleanup);\n        input.addEventListener('keydown', (e) => {\n            if (e.key === 'Enter') {\n                checkPassword();\n            } else if (e.key === 'Escape') {\n                cleanup();\n            }\n        });\n    }\n\n\n    /**\n     * The primary entry point for setting up the game state.\n     */\n    function initializeApp() {\n        \n        // 1. --- AGGRESSIVE STATE CHECK AND RESET (Fixes infinite modal loop) ---\n        const savedStateJSON = localStorage.getItem('ue5ScenarioState');\n        let initialScenarioState = {};\n        let allCompleteOnLoad = false;\n        \n        if (savedStateJSON) {\n            try {\n                initialScenarioState = JSON.parse(savedStateJSON);\n            } catch (e) {\n                console.error(\"Initial load failed, resetting saved state.\");\n            }\n        }\n        \n        // Determine completion state based on potentially loaded data\n        if (Object.keys(initialScenarioState).length > 0) {\n             allCompleteOnLoad = Object.values(initialScenarioState).every(s => s.completed);\n        }\n        \n        // CRITICAL FIX: If completed, clear the state immediately so the next load starts clean.\n        let showCompletionModal = false;\n        if (allCompleteOnLoad) {\n            // We set a flag to show the modal *this time*\n            showCompletionModal = true;\n            \n            // Then, we clear the data immediately so the next load gets a clean start.\n            localStorage.removeItem('ue5ScenarioState'); // Clears the completion status\n            localStorage.removeItem('ue5InterruptedSteps');\n            localStorage.removeItem('ue5ActiveScenario');\n            localStorage.removeItem('ue5ActiveStep');\n            localStorage.removeItem('ue5ScenarioTimer'); \n        }\n        // --- END AGGRESSIVE STATE CHECK ---\n\n        // 2. Load data from local storage (this loads a default clean state if the state was just cleared above)\n        loadScenarioState();\n        loadInterruptedSteps();\n        \n        // 3. Check for crash recovery / active scenario\n        const activeScenarioId = localStorage.getItem('ue5ActiveScenario');\n        const activeStepId = localStorage.getItem('ue5ActiveStep');\n        \n        // 4. Start the timer (handles loading saved time or 30:00)\n        startMainTimer();\n\n        // 5. Render the backlog\n        renderBacklog();\n        \n        // 6. Recover the active ticket view if the state was saved\n        if (activeScenarioId && activeStepId) {\n             selectScenario(activeScenarioId, activeStepId);\n        }\n        \n        // 7. If completed on load, stop the timer and show the final modal immediately.\n        if (showCompletionModal) { \n            if (timerContainer) {\n                timerContainer.classList.add('hidden');\n            }\n            toggleDebugMode(true); // Ensure debug mode is off\n            stopTimerOnComplete();\n            \n            // Use the initial state's data (which still holds the score) to show the final modal\n            let totalLoggedTime = Object.values(initialScenarioState).reduce((acc, s) => acc + s.loggedTime, 0);\n\n            showAssessmentModal('complete', totalLoggedTime, initialScenarioState); \n        }\n\n        // 8. Initialize debug UI state (Dropdown is always hidden on start)\n        if (debugDropdown) {\n             debugDropdown.classList.add('hidden');\n        }\n    }\n\t\n    // --- CORE INITIALIZATION HELPERS ---\n    \n    /**\n     * Finds and assigns all necessary DOM elements to global variables.\n     */\n    function cacheDOMElements() {\n        headerControls = document.getElementById('header-controls');\n        backlogList = document.getElementById('backlog-list');\n        ticketViewColumn = document.getElementById('ticket-view-column');\n        ticketPlaceholder = document.getElementById('ticket-placeholder');\n        ticketContent = document.getElementById('ticket-content');\n        ticketTitle = document.getElementById('ticket-title');\n        ticketDescription = document.getElementById('ticket-description');\n        ticketStepContent = document.getElementById('ticket-step-content');\n        debugToggle = document.getElementById('debug-toggle'); \n        countdownTimer = document.getElementById('countdown-timer');\n        jiraBoard = document.getElementById('jira-board');\n        timesUpScreen = document.getElementById('times-up-screen');\n        // 'restartTimerBtn' was unused and removed.\n        debugDropdown = document.getElementById('debug-dropdown'); \n        // 'testKeyInput', 'loadKeyBtn', 'hardResetBtn' were unused and removed.\n        \n        // Cache the timer's parent div for visibility control\n        timerContainer = countdownTimer ? countdownTimer.parentElement : null; \n    }\n    \n    /**\n     * Checks if the test is currently running (i.e., not fully completed).\n     * @returns {boolean} True if the assessment is not yet fully complete.\n     */\n    function isTestRunning() {\n        const allComplete = Object.values(scenarioState).every(state => state.completed);\n        return !allComplete;\n    }\n    \n    /**\n     * Attaches all primary event listeners.\n     */\n    function attachEventListeners() {\n        const hardResetBtn = document.getElementById('hard-reset-btn'); // Local variable for local usage\n        \n        // --- ADMIN ACCESS (CTRL + SHIFT + DELETE + Password Gate) ---\n        document.addEventListener('keydown', (e) => {\n            // Check for the combination: CTRL + SHIFT + DELETE (KeyCode 46 is Delete on most systems)\n            if (e.ctrlKey && e.shiftKey && (e.key === 'Delete' || e.keyCode === 46)) {\n                e.preventDefault();\n                // If Debug Mode is already on, the combination turns it off without a password\n                if (isDebugMode) {\n                    toggleDebugMode(true); // Force Disable\n                } else if (!debugAccessState.passwordModalVisible) {\n                    showPasswordModal();\n                }\n            }\n        });\n        \n        // --- SECURITY (Disable Right-Click Menu) ---\n        document.body.addEventListener('contextmenu', (e) => {\n            // Only block right-click if Debug Mode is OFF\n            if (!isDebugMode) {\n                 e.preventDefault(); \n            }\n        });\n        \n        // Debug: Hard Reset button handler (Wipes all local storage)\n        if (hardResetBtn) {\n            hardResetBtn.addEventListener('click', () => {\n                if (!confirm(\"WARNING: This will clear ALL progress, including saved completion data and the timer. Are you sure you want to restart the assessment completely?\")) return;\n\n                localStorage.removeItem('ue5ScenarioTimer');\n                localStorage.removeItem('ue5ScenarioState');\n                localStorage.removeItem('ue5InterruptedSteps');\n                localStorage.removeItem('ue5ActiveScenario');\n                localStorage.removeItem('ue5ActiveStep');\n                \n                location.reload();\n            });\n        }\n    }\n    \n    /**\n     * Calculates the total ideal time (0.5 hours per step) across all scenarios.\n     * @returns {{totalSteps: number, idealTotalTime: number}} The calculated totals.\n     */\n    function calculateTotalIdealTime() {\n        let totalSteps = 0;\n        \n        Object.values(window.SCENARIOS).forEach(scenario => {\n            if (scenario.steps) {\n                // Counting all steps, including dead ends, as they all represent an \"ideal\" 0.5hr time cost for a correct answer.\n                totalSteps += Object.keys(scenario.steps).length;\n            }\n        });\n        return {\n            totalSteps: totalSteps,\n            idealTotalTime: totalSteps * 0.5 \n        };\n    }\n\n    /**\n     * Serializes scenario choices into a compact, stable Base64 JSON string.\n     * @param {object} [stateToSerialize=scenarioState] - The state to serialize.\n     * @returns {string} The Base64 encoded test key.\n     */\n    function generateTestKey(stateToSerialize = scenarioState) {\n        const compactData = {};\n        \n        Object.keys(stateToSerialize).forEach(scenarioId => {\n            const state = stateToSerialize[scenarioId];\n            if (Object.keys(state.choicesMade).length > 0) {\n                // choicesMade contains the original (unshuffled) index, ensuring stability.\n                compactData[scenarioId] = state.choicesMade;\n            }\n        });\n        \n        if (Object.keys(compactData).length === 0) {\n            return \"No Choices Recorded\";\n        }\n\n        try {\n            const jsonString = JSON.stringify(compactData);\n            return base64EncodeUnicode(jsonString);\n        } catch (e) {\n            console.error(\"Failed to generate test key:\", e);\n            return \"ERROR_SERIALIZING_CHOICES\";\n        }\n    }\n\n\n    // --- STATE MANAGEMENT ---\n\n    /**\n     * Loads game state from localStorage, ensuring cleanup of old penalty/corrupted keys.\n     */\n    function loadScenarioState() {\n        const savedStateJSON = localStorage.getItem('ue5ScenarioState');\n        let savedState = {};\n\n        if (savedStateJSON) {\n            try {\n                savedState = JSON.parse(savedStateJSON);\n            } catch (e) {\n                console.error(\"Failed to parse saved state, resetting.\", e);\n                savedState = {}; \n            }\n        }\n\n        const newScenarioState = {};\n        \n        Object.keys(window.SCENARIOS).forEach(scenarioId => {\n            const defaultState = {\n                completed: false,\n                loggedTime: 0,\n                choicesMade: {}\n            };\n\n            newScenarioState[scenarioId] = {\n                ...defaultState,\n                ...(savedState[scenarioId] || {})\n            };\n            \n            // Recalculate logged time based on choicesMade to ensure consistency \n            let recalculateTime = 0;\n            if (newScenarioState[scenarioId].choicesMade) {\n                const scenario = window.SCENARIOS[scenarioId];\n                if (scenario) {\n                    Object.keys(newScenarioState[scenarioId].choicesMade).forEach(stepId => {\n                        const originalIndex = newScenarioState[scenarioId].choicesMade[stepId];\n                        if (scenario.steps[stepId] && scenario.steps[stepId].choices.length > originalIndex) {\n                            recalculateTime += getTimeCostForChoice(scenario.steps[stepId].choices[originalIndex].type);\n                        }\n                    });\n                }\n            }\n            newScenarioState[scenarioId].loggedTime = recalculateTime;\n        });\n        \n        scenarioState = newScenarioState;\n        saveScenarioState();\n    }\n\n    /**\n     * Saves the current game state to localStorage.\n     */\n    function saveScenarioState() {\n        localStorage.setItem('ue5ScenarioState', JSON.stringify(scenarioState));\n    }\n\n    /**\n     * Resets all scenario progress to default values.\n     */\n    function resetAllScenarioState() {\n        scenarioState = {};\n        Object.keys(window.SCENARIOS).forEach(scenarioId => {\n            scenarioState[scenarioId] = {\n                completed: false,\n                loggedTime: 0,\n                choicesMade: {}\n            };\n        });\n        interruptedSteps = {};\n        saveScenarioState();\n    }\n\n    /**\n     * Loads the interrupted steps map from localStorage.\n     */\n    function loadInterruptedSteps() {\n        const savedInterruptedJSON = localStorage.getItem('ue5InterruptedSteps');\n        if (savedInterruptedJSON) {\n            try {\n                interruptedSteps = JSON.parse(savedInterruptedJSON);\n            } catch (e) {\n                console.error(\"Failed to parse interrupted steps state, resetting.\", e);\n                interruptedSteps = {}; \n            }\n        }\n    }\n    \n    /**\n     * Saves the currently active ticket state and the multi-ticket progress map.\n     */\n    function saveCurrentTicketState() {\n        if (currentScenarioId && currentStepId) {\n            localStorage.setItem('ue5ActiveScenario', currentScenarioId);\n            localStorage.setItem('ue5ActiveStep', currentStepId);\n        } else {\n            localStorage.removeItem('ue5ActiveScenario');\n            localStorage.removeItem('ue5ActiveStep');\n        }\n\n        localStorage.setItem('ue5InterruptedSteps', JSON.stringify(interruptedSteps));\n    }\n\n    // --- UI RENDERING & FLOW ---\n\n    /**\n     * Determines the color class for time logged vs. estimate.\n     * @param {number} logged - Logged hours.\n     * @param {number} estimate - Estimated hours.\n     * @returns {string} Tailwind CSS class for color.\n     */\n    function getLoggedTimeColorClass(logged, estimate) {\n        if (logged <= estimate) {\n            return 'text-green-400';\n        } \n        \n        const overBudgetRatio = logged / estimate;\n        \n        if (overBudgetRatio <= 1.20) { \n            return 'text-yellow-400';\n        } else if (overBudgetRatio <= 1.40) {\n            return 'text-orange-400';\n        } else { \n            return 'text-red-400';\n        }\n    }\n\n    /**\n     * Renders the list of tickets in the backlog (left column).\n     */\n    function renderBacklog() {\n        backlogList.innerHTML = '';\n        \n        const scenarioKeys = Object.keys(window.SCENARIOS);\n        \n        const validScenarios = scenarioKeys\n            .map(id => ({ id, data: window.SCENARIOS[id] }))\n            .filter(item => \n                item.data && \n                item.data.meta && \n                item.data.meta.title &&\n                typeof item.data.meta.estimateHours !== 'undefined'\n            );\n\n        validScenarios.forEach(item => {\n            const scenarioId = item.id;\n            const scenario = item.data;\n            const state = scenarioState[scenarioId];\n\n            const meta = scenario.meta;\n            const title = meta.title;\n            const description = meta.description ? meta.description.substring(0, 70) + '...' : \"No description available.\";\n            \n            let estimate = parseFloat(meta.estimateHours); \n            if (isNaN(estimate)) {\n                estimate = 0;\n            }\n            \n            const card = document.createElement('div');\n            const isActive = currentScenarioId === scenarioId && !state.completed;\n            \n            card.className = `p-4 rounded-lg border-l-4 cursor-pointer transition-all duration-200 ${\n                state.completed \n                    ? 'bg-gray-700/50 border-green-600' \n                    : isActive\n                        ? 'bg-blue-900/40 border-blue-400 ring-2 ring-blue-400' \n                        : 'bg-gray-700 hover:bg-gray-600/80 border-blue-500'\n            }`;\n            card.dataset.scenarioId = scenarioId;\n\n            let statusSpan;\n            let loggedTimeDisplay = '';\n            const logged = state.loggedTime;\n            const loggedColorClass = getLoggedTimeColorClass(logged, estimate);\n\n\n            if (state.completed) {\n                statusSpan = `<span class=\"text-xs font-semibold text-green-400\">COMPLETED</span>`;\n                loggedTimeDisplay = `\n                    <div class=\"text-sm text-gray-300\">\n                        Logged: <span class=\"font-bold ${loggedColorClass}\">${logged.toFixed(1)} hrs</span> / \n                        Est: <span class=\"font-bold text-green-400\">${estimate.toFixed(1)} hrs</span>\n                    </div>\n                `;\n            } else {\n                 const savedStepId = interruptedSteps[scenarioId];\n                 \n                 if (savedStepId && savedStepId !== scenario.start) {\n                     statusSpan = `<span class=\"text-xs font-semibold text-yellow-400\">IN PROGRESS</span>`;\n                     loggedTimeDisplay = `\n                        <div class=\"text-sm text-gray-400\">\n                            Logged: <span class=\"font-bold ${loggedColorClass}\">${logged.toFixed(1)} hrs</span> / \n                            Est: <span class=\"font-bold text-green-400\">${estimate.toFixed(1)} hrs</span>\n                        </div>\n                    `;\n                 } else {\n                     statusSpan = `<span class=\"text-xs font-semibold text-blue-400\">NOT STARTED</span>`;\n                     loggedTimeDisplay = `\n                        <div class=\"text-sm text-gray-400\">\n                            Est. Time: <span class=\"font-bold text-green-400\">${estimate.toFixed(1)} hrs</span>\n                        </div>\n                    `;\n                 }\n            }\n            \n            const html = `\n                <h4 class=\"font-bold ${state.completed ? 'text-gray-400 line-through' : 'text-gray-100'}\">${title}</h4>\n                <p class=\"text-xs text-gray-400 mt-1\">${description}</p>\n                <div class=\"mt-3 pt-3 border-t border-gray-600\">\n                    ${statusSpan}\n                    ${loggedTimeDisplay}\n                </div>\n            `;\n\n\n            card.innerHTML = html;\n            \n            if (!state.completed) {\n                card.addEventListener('click', () => selectScenario(scenarioId));\n            }\n\n            backlogList.appendChild(card);\n        });\n    }\n    \n    /**\n     * Renders a specific step (prompt and choices) of a scenario.\n     * @param {string} scenarioId - The ID of the scenario.\n     * @param {string} stepId - The ID of the step to render.\n     */\n    function renderStep(scenarioId, stepId) {\n        const scenario = window.SCENARIOS[scenarioId];\n        const step = scenario.steps[stepId];\n        \n        if (!step) {\n            console.error(`Step \"${stepId}\" not found in scenario \"${scenarioId}\"`);\n            return;\n        }\n        \n        // 1. Update the active ticket references\n        currentScenarioId = scenarioId;\n        currentStepId = stepId;\n\n        // Save the progress of the currently active ticket in the interrupted map\n        interruptedSteps[currentScenarioId] = currentStepId;\n        saveCurrentTicketState();\n\n        // 2. Resume timer if not in debug mode\n        if (!isDebugMode) {\n            resumeMainTimer();\n        }\n\n        // 3. Shuffle choices \n        const shuffledChoices = [...step.choices].sort(() => Math.random() - 0.5);\n\n        // 4. Determine Step Number for display\n        const stepKeys = Object.keys(scenario.steps);\n        const stepIndex = stepKeys.indexOf(stepId);\n        const stepNumber = stepIndex !== -1 ? stepIndex + 1 : 1;\n        const totalSteps = stepKeys.length;\n\n        // Conditionally generate the step count prefix (visible only in debug mode)\n        const stepCountPrefix = isDebugMode \n            ? `Step ${stepNumber} / ${totalSteps}: ` \n            : '';\n\n        // 5. Build the Step Prompt and Choices\n        const stepHtml = `\n            <div id=\"ticket-step-prompt\" class=\"mb-6\">\n                <h5 class=\"text-xl font-bold text-gray-200 mb-4\">${stepCountPrefix}${step.title}</h5>\n                <div class=\"prose prose-sm prose-invert text-gray-300\">${step.prompt}</div>\n            </div>\n            <div id=\"ticket-step-choices\" class=\"space-y-3\"></div>\n        `;\n\n        ticketStepContent.innerHTML = stepHtml;\n\n        const choicesContainer = ticketStepContent.querySelector('#ticket-step-choices');\n\n        // 6. Create Choice Buttons\n        // Map original index to shuffled button for time tracking stability\n        shuffledChoices.forEach((choice) => {\n            const timeCost = getTimeCostForChoice(choice.type);\n            const isCorrect = choice.type === 'correct';\n\n            const btn = document.createElement('button');\n            \n            // Determine button styling (Debug Mode only shows hint colors)\n            let debugClass = '';\n            if (isDebugMode) {\n                if (isCorrect) {\n                     debugClass = 'border-green-600 debug-correct';\n                } else if (choice.type === 'partial') {\n                     debugClass = 'border-yellow-600';\n                } else if (choice.type === 'misguided') {\n                     debugClass = 'border-orange-600';\n                } else {\n                     debugClass = 'border-red-600';\n                }\n            } else {\n                debugClass = 'border-gray-600 hover:border-blue-500';\n            }\n            \n            // Apply unselectable class to choices\n            btn.className = `block w-full text-left p-4 bg-gray-700 hover:bg-gray-600 rounded-lg border transition-all duration-150 focus:outline-none focus:ring-2 focus:ring-blue-500 unselectable ${debugClass}`;\n            \n            btn.innerHTML = `<span class=\"font-bold\">${choice.text}</span>`; \n\n            // Attach minimal data to dataset\n            btn.dataset.choiceNext = choice.next;\n            btn.dataset.choiceTimeCost = timeCost;\n            \n            // CRITICAL: Store the original index from the SCENARIOS array for stable score tracking\n            // We need to find the original index in the unshuffled array\n            const originalIndexInChoices = step.choices.indexOf(choice);\n            if (originalIndexInChoices !== -1) {\n                btn.dataset.originalIndex = originalIndexInChoices;\n            } else {\n                console.error(\"Could not find choice in original array for stable index mapping.\");\n                btn.dataset.originalIndex = -1; // Fallback to -1 if mapping fails\n            }\n\n            btn.addEventListener('click', () => handleChoice(btn));\n            choicesContainer.appendChild(btn);\n        });\n        \n        renderBacklog();\n    }\n\n    /**\n     * Called when a user clicks an answer choice.\n     * @param {HTMLElement} choiceButton - The clicked button element.\n     */\n    function handleChoice(choiceButton) {\n        const { choiceNext, choiceTimeCost, originalIndex } = choiceButton.dataset;\n        const timeCost = parseFloat(choiceTimeCost);\n        const index = parseInt(originalIndex, 10);\n        \n        // 1. Log the time cost (updates global state)\n        const state = scenarioState[currentScenarioId];\n        state.loggedTime += timeCost;\n        \n        // 2. Record the original index of the choice made\n        state.choicesMade[currentStepId] = index;\n\n        saveScenarioState();\n\n        // 3. Check for scenario conclusion\n        if (choiceNext === 'conclusion') {\n            finishScenario();\n        } else {\n            // 4. Move to the next step immediately \n            currentStepId = choiceNext;\n            renderStep(currentScenarioId, currentStepId);\n        }\n    }\n\n    /**\n     * Called when a user clicks a scenario card from the backlog.\n     * @param {string} scenarioId - The ID of the scenario selected.\n     * @param {string|null} startStepId - Optional ID for the step to start at.\n     */\n    function selectScenario(scenarioId, startStepId = null) {\n        \n        // Save previous ticket's progress before switching\n        if (currentScenarioId && currentStepId && currentScenarioId !== scenarioId) {\n            interruptedSteps[currentScenarioId] = currentStepId;\n            localStorage.removeItem('ue5ActiveScenario');\n            localStorage.removeItem('ue5ActiveStep');\n            saveCurrentTicketState(); \n        }\n        \n        const scenario = window.SCENARIOS[scenarioId];\n        \n        // Determine starting step: 1. Passed in ID, 2. Interrupted map, 3. Scenario start\n        currentStepId = startStepId \n            || interruptedSteps[scenarioId] \n            || scenario.start; \n        \n        // Update ticket header\n        ticketTitle.textContent = scenario.meta.title;\n        ticketDescription.textContent = scenario.meta.description;\n\n        // Show ticket content, hide placeholder\n        ticketPlaceholder.classList.add('hidden');\n        ticketContent.classList.remove('hidden');\n\n        // Render the chosen step\n        renderStep(scenarioId, currentStepId);\n        \n        // Update the global active ticket tracking\n        currentScenarioId = scenarioId;\n    }\n    \n    /**\n     * Called when the user completes the final step of a scenario.\n     */\n    function finishScenario() {\n        // Mark as completed\n        const state = scenarioState[currentScenarioId];\n        state.completed = true;\n        \n        // Clear its step from the interrupted map since it's done\n        if (interruptedSteps[currentScenarioId]) {\n            delete interruptedSteps[currentScenarioId];\n        }\n\n        saveScenarioState();\n        saveCurrentTicketState();\n        renderBacklog();\n        \n        // Check if all scenarios are done (triggers final modal)\n        const allComplete = Object.values(scenarioState).every(s => s.completed);\n        \n        if (allComplete) {\n            let totalLoggedTime = Object.values(scenarioState).reduce((acc, s) => acc + s.loggedTime, 0);\n            stopTimerOnComplete(); \n            // Pass the calculated time to the modal\n            showAssessmentModal('complete', totalLoggedTime);\n        } else {\n             // Show the individual ticket conclusion inline\n            pauseMainTimer();\n            renderSingleTicketConclusion();\n        }\n    }\n    \n    /**\n     * Renders the final summary screen for a completed scenario directly into the ticket panel.\n     */\n    function renderSingleTicketConclusion() {\n        \n        const state = scenarioState[currentScenarioId];\n        const scenario = window.SCENARIOS[currentScenarioId];\n        const estimateHours = scenario.meta.estimateHours;\n        const loggedHours = state.loggedTime;\n        \n        const timeColorClass = getLoggedTimeColorClass(loggedHours, estimateHours);\n\n        // Calculate overrun/underrun\n        const timeDifference = (loggedHours - estimateHours);\n        const diffColorClass = timeDifference > 0 ? 'text-red-400' : 'text-green-400';\n        const diffLabel = timeDifference > 0 ? 'Over' : 'Under';\n        const diffValue = Math.abs(timeDifference);\n        \n        let summaryMessage;\n        if (loggedHours <= estimateHours) {\n            summaryMessage = \"Excellent outcome! The solution was found well within the estimated time.\";\n        } else if (loggedHours <= estimateHours * 1.5) {\n            summaryMessage = \"Solid work. The solution was delivered, requiring a moderate but acceptable amount of time.\";\n        } else {\n            summaryMessage = \"Ticket resolved. The issue was complex, resulting in a higher time log than originally estimated.\";\n        }\n        \n        const buttonText = \"Back to Backlog\";\n        const buttonId = \"close-scenario-btn\";\n        \n        const conclusionHtml = `\n            <div class=\"text-center p-8\">\n                <h3 class=\"text-3xl font-bold ${timeColorClass} mb-6\">Ticket Resolved</h3>\n                <p class=\"text-lg text-gray-300 mb-8\">${summaryMessage}</p>\n\n                <div class=\"max-w-md mx-auto bg-gray-700/50 p-6 rounded-lg\">\n                    <h4 class=\"text-xl font-semibold text-gray-100 mb-4\">Ticket Time Breakdown (Step Cost)</h4>\n                    <div class=\"space-y-3 text-left\">\n                        <div class=\"flex justify-between text-gray-300\">\n                            <span>Logged Fix Time:</span>\n                            <span class=\"font-bold\">${loggedHours.toFixed(1)} hrs</span>\n                        </div>\n                        <div class=\"flex justify-between text-gray-300\">\n                            <span>Original Estimate:</span>\n                            <span class=\"font-bold text-green-400\">${estimateHours.toFixed(1)} hrs</span>\n                        </div>\n                        <div class=\"flex justify-between text-lg text-white border-t border-gray-500 pt-3 mt-3\">\n                            <span class=\"font-bold\">${diffLabel} Budget By:</span>\n                            <span class=\"font-bold ${diffColorClass}\">${diffValue.toFixed(1)} hrs</span>\n                        </div>\n                    </div>\n                </div>\n\n                <button id=\"${buttonId}\" class=\"mt-8 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-8 rounded-lg shadow-md transition-all duration-200\">\n                    ${buttonText}\n                </button>\n            </div>\n        `;\n        \n        ticketStepContent.innerHTML = conclusionHtml;\n        \n        // Add event listener to the close button\n        document.getElementById(buttonId).addEventListener('click', () => {\n            // Reset UI to placeholder state\n            ticketContent.classList.add('hidden');\n            ticketPlaceholder.classList.remove('hidden');\n            \n            currentScenarioId = null;\n            currentStepId = null;\n            \n            saveCurrentTicketState(); \n\n            renderBacklog();\n            \n            // Resume the timer now that the user is selecting the next task\n            resumeMainTimer();\n        });\n    }\n\n    /**\n     * Stops the game when the timer runs out. \n     */\n    function endGameByTime() {\n        clearInterval(mainTimerInterval);\n        localStorage.removeItem('ue5ScenarioTimer'); \n        \n        if (timerContainer) {\n            timerContainer.classList.add('hidden');\n        }\n\n        countdownTimer.classList.remove('pulse-red', 'text-blue-300', 'text-yellow-400');\n        countdownTimer.classList.add('text-orange-400');\n        countdownTimer.textContent = \"00:00\";\n        \n        // Show \"Time's Up\" modal\n        showAssessmentModal('timeout'); \n    }\n    \n    /**\n     * Stops the timer when all scenarios are completed.\n     */\n    function stopTimerOnComplete() {\n        clearInterval(mainTimerInterval);\n        localStorage.removeItem('ue5ScenarioTimer'); \n        \n        // HIDE THE TIMER DISPLAY ENTIRELY\n        if (timerContainer) {\n            timerContainer.classList.add('hidden');\n        }\n\n        // Ensure no low-time colors here\n        countdownTimer.classList.remove('pulse-red', 'text-blue-300', 'text-yellow-400', 'text-orange-400');\n        countdownTimer.classList.add('text-green-500');\n        countdownTimer.textContent = \"Complete!\";\n    }\n\n    /**\n     * Assessment modal rendering function (ONLY for final, global status).\n     * @param {string} status - 'timeout' or 'complete'.\n     * @param {number|null} [totalLoggedTime=null] - Total simulated time in hours.\n     * @param {object} [stateToUse=scenarioState] - The state object to use for generating the key.\n     */\n    function showAssessmentModal(status, totalLoggedTime = null, stateToUse = scenarioState) {\n        pauseMainTimer(); // Ensure timer stops when the modal appears\n\n        let mainTitle, subText, mainTitleColor;\n        let finalStatsHtml = '';\n        let buttonHtml = ''; \n        \n        // Determine completion based on the state that was passed in\n        const allScenariosComplete = Object.values(stateToUse).every(s => s.completed);\n\n        if (status === 'timeout') {\n            // TIME'S UP status\n            mainTitle = \"Time's Up!\";\n            subText = \"The assessment period has ended. Assessment incomplete.\";\n            mainTitleColor = \"text-orange-400\";\n            \n            buttonHtml = `\n                <p class=\"text-sm text-gray-400 mt-4\">This assessment is incomplete.</p>\n            `;\n            \n        } else if (allScenariosComplete || totalLoggedTime !== null) { \n            // ASSESSMENT COMPLETE status \n            \n            // 1. Calculate final scores\n            if (totalLoggedTime === null) {\n                // If the time is null (e.g., loaded from a cleared state), recalculate from the passed state\n                totalLoggedTime = Object.values(stateToUse).reduce((acc, s) => acc + s.loggedTime, 0);\n            }\n            \n            // Note: calculateTotalIdealTime correctly uses the global SCENARIOS data\n            const { idealTotalTime } = calculateTotalIdealTime();\n            const efficiencyScore = totalLoggedTime > 0 ? (idealTotalTime / totalLoggedTime) : 0;\n            const finalEfficiencyPercent = Math.round(efficiencyScore * 100);\n            const passed = efficiencyScore >= PASS_THRESHOLD;\n            \n            // 2. Generate Test Key (Using the state that was passed in)\n            const testKey = generateTestKey(stateToUse);\n\n            mainTitle = passed ? \"Assessment Passed\" : \"Assessment Completed\";\n            mainTitleColor = passed ? \"text-green-500\" : \"text-yellow-500\";\n            subText = passed \n                ? \"Congratulations! Your results are logged based on efficient problem-solving.\"\n                : \"You completed all tickets. Review the details below.\";\n            \n            // 4. Assemble Final Stats HTML (Reproducible Key added back)\n            finalStatsHtml = `\n                <div class=\"mt-4 border-t border-gray-600 pt-4\">\n                    <h4 class=\"text-xl font-bold ${mainTitleColor} mb-3\">Final Time Report</h4>\n                    <div class=\"space-y-2 text-left max-w-sm mx-auto\">\n                        <div class=\"flex justify-between text-sm text-gray-200\">\n                            <span>Total Optimal Time (0.5h/step):</span>\n                            <span class=\"font-bold\">${idealTotalTime.toFixed(1)} hrs</span>\n                        </div>\n                         <div class=\"flex justify-between text-sm text-gray-200\">\n                            <span>Total Simulated Time (Choice Cost):</span>\n                            <span class=\"font-bold text-sm\">${totalLoggedTime.toFixed(1)} hrs</span>\n                        </div>\n                        <div class=\"flex justify-between text-lg text-white border-t border-gray-500 pt-3\">\n                            <span class=\"font-bold\">Efficiency Score:</span>\n                            <span class=\"font-bold ${mainTitleColor}\">${finalEfficiencyPercent}%</span>\n                        </div>\n                        <p class=\"text-xs text-gray-400 text-center\">(Pass Threshold: ${PASS_THRESHOLD * 100}%)</p>\n                    </div>\n                </div>\n                \n                <div class=\"mt-4 border-t border-gray-600 pt-4\">\n                    <h4 class=\"text-xl font-bold text-gray-100 mb-3\">Reproducible Test Key</h4>\n                    <p class=\"text-sm text-gray-400 mb-2\">Copy this key to recreate this exact test path and results.</p>\n                    \n                    <div class=\"flex justify-center\">\n                        <span id=\"test-key-display\" class=\"font-mono text-xs md:text-sm bg-gray-700/70 p-3 rounded-lg break-all max-w-full inline-block text-yellow-300\">\n                            ${testKey}\n                        </span>\n                    </div>\n                    \n                    <button id=\"copy-key-btn\" class=\"mt-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg text-sm transition-all duration-200\">\n                        Copy Key\n                    </button>\n                </div>\n            `;\n            \n            buttonHtml = `\n                <p class=\"text-sm text-gray-400 mt-4\">This assessment is complete.</p>\n            `;\n        }\n\n        // --- Render Modal ---\n        const modalContentHtml = `\n            <div id=\"final-modal-content\" class=\"bg-gray-800 p-6 rounded-xl shadow-2xl text-center max-w-lg w-full max-h-[90vh] overflow-y-auto\">\n                <h2 class=\"text-3xl font-extrabold ${mainTitleColor} mb-2\">${mainTitle}</h2>\n                <p class=\"text-base text-gray-300 mb-2\">${subText}</p>\n                \n                ${finalStatsHtml}\n\n                ${buttonHtml}\n            </div>\n        `;\n\n        timesUpScreen.innerHTML = modalContentHtml;\n        jiraBoard.classList.add('hidden');\n        timesUpScreen.classList.remove('hidden');\n\n        // Attach Copy button listener\n        if (allScenariosComplete || totalLoggedTime !== null) {\n            const copyButton = document.getElementById('copy-key-btn');\n            const keyDisplay = document.getElementById('test-key-display');\n            \n            if (copyButton && keyDisplay) {\n                copyButton.addEventListener('click', () => {\n                    const keyToCopy = keyDisplay.textContent; \n                    \n                    // Use document.execCommand('copy') for better compatibility in iframe environments\n                    const tempInput = document.createElement('textarea');\n                    tempInput.value = keyToCopy;\n                    document.body.appendChild(tempInput);\n                    tempInput.select();\n                    document.execCommand('copy');\n                    document.body.removeChild(tempInput);\n\n                    copyButton.textContent = 'Copied!';\n                    setTimeout(() => {\n                        copyButton.textContent = 'Copy Key';\n                    }, 2000);\n                });\n            }\n        }\n    }\n\n\n    // --- Entry Point ---\n    cacheDOMElements();\n    attachEventListeners();\n    initializeApp();\n\n});","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Sam Deiter\\Documents\\GitHub\\UE5QuestionGenerator\\temp_scorm_extract\\UE5ScenarioTracker-main\\questions.js","messages":[{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":59,"column":205,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":59,"endColumn":206,"suggestions":[{"messageId":"removeEscape","fix":{"range":[3221,3222],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[3221,3221],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":70,"column":1477,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":70,"endColumn":1478,"suggestions":[{"messageId":"removeEscape","fix":{"range":[7289,7290],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[7289,7289],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":73,"column":532,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":73,"endColumn":533,"suggestions":[{"messageId":"removeEscape","fix":{"range":[7931,7932],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[7931,7931],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":73,"column":559,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":73,"endColumn":560,"suggestions":[{"messageId":"removeEscape","fix":{"range":[7958,7959],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[7958,7958],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":73,"column":820,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":73,"endColumn":821,"suggestions":[{"messageId":"removeEscape","fix":{"range":[8219,8220],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[8219,8219],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":78,"column":1255,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":78,"endColumn":1256,"suggestions":[{"messageId":"removeEscape","fix":{"range":[10582,10583],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[10582,10582],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":78,"column":1269,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":78,"endColumn":1270,"suggestions":[{"messageId":"removeEscape","fix":{"range":[10596,10597],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[10596,10596],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":78,"column":1601,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":78,"endColumn":1602,"suggestions":[{"messageId":"removeEscape","fix":{"range":[10928,10929],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[10928,10928],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":91,"column":666,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":91,"endColumn":667,"suggestions":[{"messageId":"removeEscape","fix":{"range":[19409,19410],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[19409,19409],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":91,"column":1299,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":91,"endColumn":1300,"suggestions":[{"messageId":"removeEscape","fix":{"range":[20042,20043],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[20042,20042],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":92,"column":1019,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":92,"endColumn":1020,"suggestions":[{"messageId":"removeEscape","fix":{"range":[21395,21396],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[21395,21395],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":93,"column":1645,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":93,"endColumn":1646,"suggestions":[{"messageId":"removeEscape","fix":{"range":[23666,23667],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[23666,23666],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":93,"column":1710,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":93,"endColumn":1711,"suggestions":[{"messageId":"removeEscape","fix":{"range":[23731,23732],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[23731,23731],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":98,"column":688,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":98,"endColumn":689,"suggestions":[{"messageId":"removeEscape","fix":{"range":[25610,25611],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[25610,25610],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":104,"column":1027,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":104,"endColumn":1028,"suggestions":[{"messageId":"removeEscape","fix":{"range":[32838,32839],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[32838,32838],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":107,"column":692,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":107,"endColumn":693,"suggestions":[{"messageId":"removeEscape","fix":{"range":[34196,34197],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[34196,34196],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":107,"column":962,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":107,"endColumn":963,"suggestions":[{"messageId":"removeEscape","fix":{"range":[34466,34467],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[34466,34466],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":107,"column":1303,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":107,"endColumn":1304,"suggestions":[{"messageId":"removeEscape","fix":{"range":[34807,34808],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[34807,34807],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":108,"column":961,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":108,"endColumn":962,"suggestions":[{"messageId":"removeEscape","fix":{"range":[36113,36114],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[36113,36113],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\'.","line":169,"column":1648,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":169,"endColumn":1649,"suggestions":[{"messageId":"removeEscape","fix":{"range":[79725,79726],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[79725,79725],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]}],"suppressedMessages":[],"errorCount":20,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ============================================================================\n// === QUESTIONS DATA: SCENARIOS ==============================================\n// ============================================================================\n// This file defines all of the scenario data used by the UE5 Scenario Tracker.\n// Each key in the SCENARIOS object represents an interactive debugging \"ticket\"\n// in a Jira-style format.\n// ----------------------------------------------------------------------------\n// STRUCTURE OVERVIEW:\n//\n// SCENARIO {\n//   meta: { \n//     title: string, \n//     description: string, \n//     estimateHours: number // Target completion time for efficiency score\n//   },\n//   start: \"step-id\", // The key of the first step to display\n//   steps: {\n//     'step-id': {\n//       isTask: true | false, // True if a core problem/False if a dead-end follow-up\n//       skill: 'category',    // Used for tracking skill focus (e.g., 'rep', 'anim')\n//       title: 'Step Title',\n//       prompt: '<p>HTML prompt text...</p>',\n//       choices: [\n//         {\n//           text: 'The choice text.',\n//           type: 'correct' | 'partial' | 'misguided' | 'wrong', // Maps to time cost (0.5, 1.0, 1.5, 2.0 hrs)\n//           feedback: '<p>HTML feedback text with points/time cost...</p>',\n//           next: 'next-step-id' | 'conclusion' // ID of the next step or 'conclusion' to finish the ticket\n//         },\n//         // ... other choices\n//       ]\n//     }\n//   }\n// }\n// ----------------------------------------------------------------------------\n\nwindow.SCENARIOS = {\n  // --------------------------------------------------------------------------\n  // GOLEM SCENARIO: A deep dive into multiple systems (Compilation, Anim, VFX, Perf, Rep)\n  // --------------------------------------------------------------------------\n  golem: {\n    meta: {\n      title: \"BP_GuardianGolem is Non-Functional: Full Debug Hunt\",\n      description:\n        \"Critical enemy asset fails to spawn, T-poses, leaks VFX memory, and breaks on the network.\",\n      estimateHours: 14.0 // Adjusted for increased debugging complexity and dead ends\n    },\n    start: \"step-1\",\n    steps:\n      {\n        // === 1. COMPILATION & CLASS ABSTRACTION ISSUES ===\n        'step-1': {\n          isTask: true, \n          skill:'compile',\n          title:'Abstract Class Error',\n          prompt:\"<p>You try to place <code>BP_GuardianGolem</code> in the level, but nothing happens. The <strong>Output Log</strong> shows: <code>Error: Could not create actor... The class is abstract and must be subclassed.</code></p><strong>What is the cause of this abstract class error in Blueprints?</strong>\",\n          choices:[\n            {text:\"Implement the required unimplemented function inherited from the parent C++ class.\",type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> The Blueprint is abstract because it inherits an unimplemented event, often marked with an error in the My Blueprint panel.</p>\",next:'step-2'},\n            {text:'Delete the asset and re-create it, hoping the corruption clears.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> This is a destructive action that won\\'t solve the root inheritance problem.</p>\",next:'step-1W'},\n            {text:'Check the Blueprint\\'s variables for an unchecked <code>Expose on Spawn</code> property.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> <code>Expose on Spawn</code> is related to spawning but does not make a class abstract. This fix is misguided and wastes time.</p>\",next:'step-1M'},\n            {text:'Recompile the parent C++ code without making any changes.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> This is an indirect approach. You need to investigate the inherited functions.</p>\",next:'step-3'}\n          ]\n        },\n        \n        'step-1W': {isTask: false, skill:'compile',title:'Asset Deletion Wastes Time',prompt:\"<p>Deleting and recreating the asset failed to fix the error because the problem is inherited from the parent class. You must now find the function.</p><strong>How do you find the unimplemented function?</strong>\",choices:[{text:'In the My Blueprint panel, right-click the parent function name and select \"Implement function\".',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> Re-focusing on the correct workflow. The editor guides you to implement required functions.</p>\",next:'step-3'},{text:'Open the parent C++ class and remove the \"BlueprintImplementableEvent\" tag.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> Dangerous code change that breaks the game systems relying on this event.</p>\",next:'step-3'}]},\n        \n        'step-1M': {isTask: false, skill:'compile',title:'Misguided Variable Check Failure',prompt:\"<p>Checking the <code>Expose on Spawn</code> property did not resolve the abstract class error. This property only affects variables passed during the <code>Spawn Actor</code> node and is not the cause of an abstract class definition.</p><strong>You realize this was a dead end. What should you do next to address the abstract class error?</strong>\",choices:[{text:'Go back and investigate the inherited functions in the My Blueprint panel.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> Returning to the correct path, you realize the error is caused by an unimplemented inherited function.</p>\",next:'step-3'},{text:'Try recompiling the parent C++ code again (Partial answer from Step 1).',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> You are still avoiding the direct investigation, wasting more time on indirect fixes.</p>\",next:'step-3'}]},\n\n        // === 2. ANIMATION & DATA FLOW ISSUES ===\n        'step-2': {isTask: true, skill:'anim',title:'The Runtime T-Pose',prompt:\"<p>The Golem now spawns, but is stuck in a T-Pose. The AnimBP preview is working, but the in-game character is frozen.</p><strong>Where is the most likely data disconnect preventing animation playback?</strong>\",choices:[{text:\"Trace the AnimBP's Event Graph logic to ensure data variables (like Speed) are being updated from the main Golem Blueprint (Cast failure).\",type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> The <code>AnimBP</code> is a separate machine that relies on data from the character. If the <code>Cast</code> fails, the <code>State Machine</code> defaults to its entry pose (T-Pose).</p>\",next:'step-3'},{text:'Change the Skeletal Mesh Component\\'s \"Animation Mode\" to \"Use Animation Asset\".',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> This would play a single animation, not result in a T-Pose, suggesting the <code>AnimBP</code> is assigned but not driven.</p>\",next:'step-3'},{text:'Reimport the Skeletal Mesh and all associated animations.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> The preview works, confirming the asset is fine. The problem is runtime logic.</p>\",next:'step-2W'},{text:'Check if the character\\'s physics asset is blocking movement.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> You think this is a physics issue and check the Golem\\'s Physics Asset.</p>\",next:'step-2M'}]},\n        \n        // Dead-end: Mistaking T-pose for asset corruption\n        'step-2W': {isTask: false, skill:'anim',title:'Asset Reimport Was Useless',prompt:\"<p>You wasted maximum time re-importing the Golem mesh and animations. The issue persists. Since the animation preview works, the issue is clearly runtime logic, not asset corruption.</p><strong>Where must the core data flow failure lie?</strong>\",choices:[{text:'Check the data casting between the AnimBP and the main Golem Blueprint.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> You correctly refocused on the AnimBP\\'s dependency on the Golem\\'s runtime data.</p>\",next:'step-3'},{text:'Check the Golem\\'s <code>Movement Mode</code>, maybe it\\'s set to <code>None</code>.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> This is an unrelated fix. Movement mode doesn\\'t affect the AnimBP ticking logic.</p>\",next:'step-3'}]},\n\n        // Dead-end: Mistaking T-pose for physics issues\n        'step-2M': {isTask: false, skill:'anim',title:'Physics Asset Investigation (Dead End)',prompt:\"<p>You spent extended time reviewing and simplifying the Golem's <code>Physics Asset</code>. While optimization is good, it had no effect on the T-pose because the character's animation system runs separately from the physics simulation.</p><strong>You realize the problem must be in the AnimBP's initialization. What is the next step?</strong>\",choices:[{text:'Check the data casting between the AnimBP and the main Golem Blueprint.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> Correctly identifying the AnimBP's dependency on character data as the root cause.</p>\",next:'step-3'},{text:'Check if the Golem\\'s <code>Skeletal Mesh Component</code> is set to <code>Visible</code>.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> The Golem is visible, just T-posing. This is an obviously wrong check.</p>\",next:'step-3'}]},\n        \n        'step-3': {isTask: true, skill:'anim',title:'Tracing the Data Flow Failure',prompt:\"<p>You find the AnimBP's <code>Cast to BP_GuardianGolem</code> node fails immediately on <code>Event Blueprint Update Animation</code> due to a timing issue.</p><strong>What is the standard, robust pattern to fix this AnimBP casting failure?</strong>\",choices:[{text:\"Use <code>Event Blueprint Initialize Animation</code> to establish a solid reference to the Golem once, avoiding the per-frame cast and potential timing issues.\",type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> Initializing the reference once at the correct time is far more efficient than casting every frame on Update Animation.</p>\",next:'step-4'},{text:'Add an <code>IsValid</code> check after the Cast. Only update variables if the Cast succeeds.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> This prevents crashes but causes a jarring pop-in (visual technical debt) as the character T-poses until the Cast succeeds.</p>\",next:'step-4'},{text:'Add a 0.2 second Delay before the Cast to ensure the character is fully possessed.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> This is a brittle, \\'magic number\\' fix prone to failing on different machine speeds or during hitches.</p>\",next:'step-4'},{text:'Move the Cast logic to the Golem Blueprint and send the data back to the AnimBP via a variable binding.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> This inverts the data flow complexity and doesn\\'t solve the core timing issue.</p>\",next:'step-4'}]},\n        'step-4': {isTask: true, skill:'anim',title:'The T-Pose Visual Tech Debt',prompt:\"<p>You choose the <strong>Partial</strong> answer (the <code>IsValid</code> check). The Golem animates, but QA reports the Golem \\\"snaps\\\" from a T-pose when it first spawns. The lead asks you to move on, but you know this is bad practice.</p><strong>What do you call the best practice pattern you should have used?</strong>\",choices:[{text:\"The robust, event-driven reference initialization pattern (using <code>Initialize Animation</code>).\",type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> Acknowledging the tech debt and remembering the best practice. This is the correct soft skill.</p>\",next:'step-5'},{text:'The <code>Character Movement Component</code> has its <code>Default Land Movement Mode</code> set to None.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> Unrelated to the animation initialization issue.</p>\",next:'step-5'},{text:'The AnimBP is overriding the wrong function, it should use <code>Post Update Animation</code>.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> <code>Update Animation</code> is the correct place to update variables.</p>\",next:'step-5'},{text:'The delay node was still the better solution for reliability.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> Still believing in the fragile delay solution shows a lack of understanding of event-driven reliability.</p>\",next:'step-5'}]},\n        \n        // === 3. VFX, SOUND, & ACTOR LIFECYCLE ISSUES ===\n        'step-5': {isTask: true, skill:'vfx',title:'The Missing Anim Notify',prompt:\"<p>The Golem animates, but a crucial ground-shatter VFX is missing during the Slam Attack. The VFX is triggered by an <code>Anim Notify</code> called <code>FX_SlamImpact</code>.</p><strong>What is your primary check when debugging a failing Anim Notify?</strong>\",choices:[{text:\"Open the Animation Sequence (A_Golem_Slam) and verify the <code>FX_SlamImpact</code> notify exists on the <code>Notify Track</code> and is correctly placed/spelled.\",type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> The <code>Anim Notify</code> asset and its timeline placement are the source. Missing or misspelled notifies are the most common cause.</p>\",next:'step-6'},{text:'Place a breakpoint on the corresponding event in the AnimBP\\'s <code>Event Graph</code>.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> This is a good second step, but if the notify is missing from the timeline, the breakpoint will never be hit, wasting time tracing the wrong component.</p>\",next:'step-6'},{text:'Check the <code>Niagara System</code> asset to ensure it is not compiled with errors.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> You have no evidence the <code>Niagara System</code> is the problem yet; the issue points to the trigger mechanism.</p>\",next:'step-6'},{text:'Change the notify\\'s timing in the Montage instead of the <code>Anim Sequence</code>.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> <code>Anim Notifies</code> are placed on the base sequence, not the montage layer.</p>\",next:'step-6'}]},\n        'step-6': {isTask: true, skill:'vfx',title:'The Emitter Spawns at Origin',prompt:\"<p>You fix a typo in the <code>Anim Notify</code> name, and the VFX plays, but it always spawns at the world origin (0,0,0) instead of under the Golem's foot.</p><strong>How do you fix the VFX spawn location?</strong>\",choices:[{text:'Use <code>Spawn Emitter Attached</code> and provide the Golem\\'s mesh and a foot socket name as the attach point.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> Attaching ensures the effect tracks the skeletal mesh, using relative transforms for the most accurate and robust positioning.</p>\",next:'step-7'},{text:'Use <code>Get Socket Location</code> on the mesh and feed that world location into <code>Spawn Emitter at Location</code>.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> This works, but is less robust. If the Golem moves rapidly, the location could be slightly off before the next tick updates the position.</p>\",next:'step-7'},{text:\"Manually add the Golem's world location to a hard-coded offset vector.\",type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> Brittle fix that breaks if the Golem's location or rotation changes dramatically.</p>\",next:'step-7'},{text:'The <code>Niagara System</code> needs its <code>Local Space</code> flag enabled.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> You are attempting to fix the world-space location with a local-space particle setting.</p>\",next:'step-6W'}]},\n        \n        // Dead-end: Mismatching world vs local space settings for spawn\n        'step-6W': {isTask: false, skill:'vfx',title:'Local Space Confusion (Dead End)',prompt:\"<p>You tried enabling <code>Local Space</code> in the <code>Niagara System</code>, but it had no effect on the emitter's spawn location. <code>Local Space</code> only controls whether the particles move with the emitter's parent. The issue is where the emitter's *container* is spawned in the world.</p><strong>What is the correct way to handle spatial relationships for spawning emitters?</strong>\",choices:[{text:'Use <code>Spawn Emitter Attached</code> and provide the Golem\\'s mesh and a socket name as the attach point.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> The correct approach is always to attach the emitter to the skeletal mesh for reliable tracking.</p>\",next:'step-7'},{text:'Set the <code>Spawn Emitter at Location</code> node to use the character\\'s world <code>Root Component</code> location.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> This is a step up, but it still lacks the precision of a dedicated foot socket.</p>\",next:'step-7'}]},\n\n        'step-7': {isTask: true, skill:'vfx',title:'Leaking VFX Actors',prompt:\"<p>The VFX plays correctly, but after a few attacks, the frame rate dips. <code>obj list class=NiagaraActor</code> shows hundreds of <code>Niagara actors</code> still in memory.</p><strong>What is causing this memory leak?</strong>\",choices:[{text:\"Check the <code>Spawn Emitter Attached</code> node to ensure the <code>Auto Destroy</code> checkbox is checked.\",type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> The actor container must explicitly be marked for destruction via <code>Auto Destroy</code> or a manual <code>Destroy Actor</code> node after the effect is complete.</p>\",next:'step-8'},{text:'Manually call <code>Destroy Actor</code> on the emitter reference after a Delay node matching the effect\\'s duration.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> This achieves cleanup but is less efficient and more error-prone than using the built-in <code>Auto Destroy</code> flag.</p>\",next:'step-8'},{text:'Reduce the particle count in the <code>Niagara System</code> to lessen memory pressure.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> This addresses symptoms but not the root cause (actor lifecycle management).</p>\",next:'step-8'},{text:'Wait for the <code>Garbage Collector</code> to run; it will eventually clean up unused actors.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> The <code>Garbage Collector</code> only cleans up unreferenced memory, not actors that are still referenced or not explicitly marked for destruction.</p>\",next:'step-8'}]},\n        \n        // === 4. MATERIAL & RENDERING OPTIMIZATION ISSUES ===\n        'step-8': {isTask: true, skill:'material',title:'Unlit Gray VFX',prompt:\"<p>The memory leak is fixed, but the VFX looks flat, gray, and unlit instead of a fiery explosion. The Material uses a <code>Particle Color</code> node multiplied by a texture, but the result is black (0,0,0).</p><strong>What is the best fix to correctly drive the Material?</strong>\",choices:[{text:'In the Niagara emitter, add or adjust the <code>Scale Color</code> module to output the necessary color data for the Material to use.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> The Material expects particle color data, but the <code>Niagara system</code> wasn\\'t providing it. Fix the data flow from the particle system to the shader.</p>\",next:'step-9'},{text:\"Delete the <code>Particle Color</code> node and connect the texture directly to the material's <code>Emissive</code> output.\",type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> This makes it visible but removes particle system control (fading/lifetime color changes), breaking the intended look.</p>\",next:'step-9'},{text:'Change the material\\'s <code>Blend Mode</code> from Opaque to Additive.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> This changes the blend, but doesn\\'t fix the unlit black result, and risks severe overdraw.</p>\",next:'step-9'},{text:'Reimport the texture files used by the material.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> The black output is a logical flaw in the shader graph/data flow, not a texture import error.</p>\",next:'step-9'}]},\n        'step-9': {isTask: true, skill:'perf',title:'Overdraw Crisis (Visual Tech Debt)',prompt:\"<p>You chose the <strong>Partial</strong> answer (deleting the <code>Particle Color</code> node). The VFX is now visible, but it looks terrible and performance dips because the material is set to <strong>Translucent</strong>.</p><strong>What optimization should you perform immediately to resolve the Translucent/Overdraw issue?</strong>\",choices:[{text:'Change the material\\'s <code>Blend Mode</code> from <code>Translucent</code> to a more performant option like <code>Additive</code> or <code>Masked</code>.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> <code>Translucency</code> is extremely costly when multiple particles overlap. Changing the blend mode fixes the overdraw issue.</p>\",next:'step-10'},{text:'Reduce the size of the particle sprites in the <code>Niagara system</code>.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> Reduces the severity of overdraw but doesn\\'t fix the fundamental performance cost of the <code>Translucent</code> blend mode.</p>\",next:'step-10'},{text:'Enable the <code>Use Ray Tracing</code> flag on the material.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> <code>Ray Tracing</code> is a high-end feature that adds significant cost; it will not fix the overdraw issue.</p>\",next:'step-10'},{text:'Wait for the rendering team to provide a better shader.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> Blaming another team for a basic setup error is not a solution.</p>\",next:'step-10'}]},\n        'step-10': {isTask: true, skill:'perf',title:'The Draw Call Spike (Mass Placement)',prompt:\"<p>The lead places 50 Golems in the level for a stress test. The frame rate drops significantly, and the profiler flags <code>Draw Calls</code> and the <code>Render Thread</code> as the bottleneck.</p><strong>What common material setup is most likely causing excessive draw calls across all Golems?</strong>\",choices:[{text:'Check if the Golem\\'s eye glow or another feature is generating a unique <code>Dynamic Material Instance (DMI)</code> per Golem, thus breaking instancing.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> <code>DMIs</code> force unique <code>draw calls</code>, which is the classic cause of a <code>draw call spike</code> when actors should be instanced.</p>\",next:'step-11'},{text:'The VFX material is still causing complexity issues.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> Complexity affects shader time, not <code>draw call</code> count. You misidentified the bottleneck, but the area of investigation is material related.</p>\",next:'step-11'},{text:'The Golem <code>Skeletal Mesh</code> has too many material slots (<code>sub-meshes</code>).',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> This fix is misguided as the issue is DMI instantiation, not sub-mesh count.</p>\",next:'step-10M'},{text:'The <code>Tick</code> function is too heavy, starving the <code>Render Thread</code>.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> The profiler points specifically to the <code>Render Thread</code>\\'s <code>draw call</code> cost, not the <code>Game Thread</code>\\'s <code>Tick</code> cost.</p>\",next:'step-11'}]},\n        \n        // Dead-end: Mesh optimization doesn't fix instancing break\n        'step-10M': {isTask: false, skill:'perf',title:'Merging Mesh Slots (Dead End)',prompt:\"<p>You spent extended time optimizing the Golem mesh by combining its material slots (sub-meshes). While this reduced the base draw calls per Golem from 3 to 2, the **draw call spike** on the `Render Thread` persists when 50 Golems are placed.</p><strong>You realize the problem is still related to the material's instance parameters. What is the root cause?</strong>\",choices:[{text:'The eye glow is generating a unique <code>Dynamic Material Instance (DMI)</code> per Golem, thus breaking instancing.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> Correctly identifying the DMI as the sole cause of the draw call spike.</p>\",next:'step-11'},{text:'The mesh is using <code>World Position Offset</code>, which prevents instancing.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> <code>WPO</code> can be instanced if not using per-instance parameters. This is a common confusion point.</p>\",next:'step-11'}]},\n\n        'step-11': {isTask: true, skill:'material',title:'The DMI Refactor',prompt:\"<p>You confirm the Golem's eye material uses a <code>Dynamic Material Instance (DMI)</code> to drive the 'Enraged Glow' color per instance.</p><strong>What is the best alternative to <code>DMIs</code> for performant, instance-specific material parameters?</strong>\",choices:[{text:'Refactor the eye material to use a <code>Material Parameter Collection (MPC)</code>, which is a global data asset that can be updated in a single render pass.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> <code>MPCs</code> are the standard solution for globally synchronized material changes that don\\'t break instancing, saving hundreds of <code>draw calls</code>.</p>\",next:'step-12'},{text:'Use a <code>Per-Instance Custom Data</code> node in the material, driven by C++ code.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> Highly performant, but <code>MPCs</code> are generally easier to implement in <code>Blueprint-heavy</code> projects.</p>\",next:'step-12'},{text:'Remove the <code>DMI</code> and simplify the material until it no longer needs instance-specific parameters.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> This forces an unnecessary design change; the requirement is to *keep* the per-instance glow but make it performant.</p>\",next:'step-12'},{text:'Set the material to <code>Unlit</code>, as <code>unlit</code> materials are inherently faster to draw.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> The lit/unlit state does not affect whether the renderer can instance the material.</p>\",next:'step-12'}]},\n        'step-12': {isTask: true, skill:'material',title:'MPC Naming Conflict',prompt:\"<p>You implement the <code>MPC</code> glow, but when you test, the Golem's eyes are always the wrong color (e.g., green) regardless of the Golem's state.</p><strong>What is the most likely cause of your <code>MPC</code> value being ignored or overwritten?</strong>\",choices:[{text:'Another system in the level is also writing to the same <code>MPC</code> parameter every frame, causing a <code>naming collision</code> and overwriting your value.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> This is a classic 'battle of the systems' bug since <code>MPCs</code> are global. Parameter names must be unique to the feature.</p>\",next:'step-13'},{text:\"The Material assigned to the eye doesn't actually reference the <code>MPC</code>.\",type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> Plausible, but the eye color would likely be default (black), not a specific wrong color like green.</p>\",next:'step-13'},{text:'The Golem Blueprint is setting the <code>MPC</code> value on <code>Event BeginPlay</code>, which is too early.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> Timing is less of an issue here than the constant frame-by-frame overwrite.</p>\",next:'step-13'},{text:'You must call <code>Apply Changes</code> after setting an <code>MPC</code> value.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> No such node exists; the update is immediate.</p>\",next:'step-13'}]},\n        \n        // === 5. NETWORKING & REPLICATION ISSUES ===\n        'step-13': {isTask: true, skill:'rep',title:'Multilayer Glow Failure',prompt:\"<p>You rename your <code>MPC</code> parameter, and the glow works in single-player. But in multiplayer, client Golems don't glow when enraged. The server Golem glows correctly.</p><strong>What is the standard, efficient fix for replicating cosmetic state changes like the eye color?</strong>\",choices:[{text:\"Change the <code>IsEnraged</code> boolean variable's replication type to <code>RepNotify</code> and place the visual update logic in the generated <code>OnRep_IsEnraged</code> function.\",type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> <code>RepNotify</code> is efficient, event-driven, and correctly handles late joiners by ensuring the visual update runs reliably on clients when the variable state changes.</p>\",next:'step-14'},{text:'Create a <code>Multicast RPC</code> that runs the visual update logic on all clients whenever the state changes.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> A <code>Multicast</code> works for existing clients but fails for late joiners, who will never receive the <code>RPC</code>, causing desync.</p>\",next:'step-14'},{text:'Run the visual update logic on the client\\'s <code>Event Tick</code>, checking for the server-replicated variable change.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> Polling on <code>Tick</code> is highly inefficient, wasting CPU cycles checking a state that changes infrequently.</p>\",next:'step-14'},{text:'Enable the \"Replicates\" flag on the <code>Material Parameter Collection</code> asset itself.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> Data assets do not replicate; only actors and their properties do.</p>\",next:'step-14'}]},\n        'step-14': {isTask: true, skill:'rep',title:'Multilayer Animation Desync',prompt:\"<p>The glow replicates. However, when the Golem attacks, the server Golem plays the slam montage perfectly, but client Golems slide without the animation.</p><strong>How must the montage playback be replicated to clients?</strong>\",choices:[{text:\"Place the <code>Play Anim Montage</code> node inside a reliable <code>Multicast RPC</code>, ensuring all clients are explicitly told to run the cosmetic animation.\",type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> One-shot cosmetic events (like Montages or <code>VFX playback</code>) must be explicitly <code>Multicast</code> to all clients, as they are not automatically replicated with movement.</p>\",next:'step-15'},{text:'Change the <code>montage trigger variable</code> to a <code>RepNotify</code>.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> This is an indirect way that adds unnecessary state management complexity when a direct <code>Multicast RPC</code> is the cleaner pattern for one-shot events.</p>\",next:'step-15'},{text:'Increase the replication rate settings on the Golem\\'s <code>Skeletal Mesh Component</code>.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> Increasing the rate helps smooth movement but does not resolve the logical issue that the engine was never told to play the animation on the client.</p>\",next:'step-15'},{text:'Set the <code>Anim Montage</code> asset\\'s \"Replicate\" property to true.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> <code>Anim Montage</code> assets do not have a simple replication flag.</p>\",next:'step-15'}]},\n        'step-15': {isTask: true, skill:'rep',title:'Input Lockout Bug',prompt:\"<p>After being attacked by the Golem, players sometimes lose the ability to jump or use their secondary attack. Their primary attack still works.</p><strong>What is the most likely cause of this partial input lockout?</strong>\",choices:[{text:'A logic path is enabling a <code>Gameplay Ability</code> input or setting a <code>Gameplay Tag</code> on the character, but the corresponding disabling logic is failing to run.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> <code>Partial lockouts</code> are almost always tied to <code>Gameplay Tags</code> or the <code>Ability System</code> failing to remove an active state that is blocking specific input bindings.</p>\",next:'step-16'},{text:'The <code>character movement component</code> is disabled, preventing only movement-related inputs.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> The primary attack works, so the <code>movement component</code> isn\\'t the primary cause. The problem is selective input processing.</p>\",next:'step-16'},{text:'The <code>player controller</code> is losing its input focus (<code>Unpossessed</code>).',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> If <code>unpossessed</code>, the player would lose all input, including primary attack.</p>\",next:'step-16'},{text:'The <code>input mapping context</code> is corrupted.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> Corruption would cause a persistent, non-conditional failure.</p>\",next:'step-16'}]},\n        \n        // === 6. FINAL CLEANUP & BUILD ISSUES ===\n        'step-16': {isTask: true, skill:'perf',title:'Collision Snagging',prompt:\"<p>QA reports one last bug: \\\"The Golem sometimes gets stuck on small bits of rubble on the ground.\\\"</p><strong>What is the first and most direct thing to check to debug character movement snagging?</strong>\",choices:[{text:\"Select the Golem's <code>CapsuleComponent</code> in its Blueprint and check its size and position. Use the <code>p.ShowCollision</code> console command in-game to visualize it.\",type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> A character's movement is almost always governed by its root capsule. Visualizing the collision in-game is the fastest way to confirm if it\\'s too wide or low.</p>\",next:'step-17'},{text:\"Open the Golem's <code>Physics Asset</code> and simplify the collision bodies on its legs and feet.\",type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> This affects physical interactions, but the character\\'s primary *movement* collision is the capsule. Check the capsule first.</p>\",next:'step-17'},{text:'Increase the <code>Max Step Height</code> in the <code>Character Movement Component</code>.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> This can help the character walk over small ledges, but doesn\\'t solve the problem if the capsule is fundamentally too large.</p>\",next:'step-17'},{text:\"Increase the Golem's mass in its <code>Character Movement Component</code>.\",type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> Mass affects physics pushback, not basic collision shape for walking.</p>\",next:'step-17'}]},\n        'step-17': {isTask: true, skill:'material',title:'Build Packaging Failure',prompt:\"<p>The Golem is now working. You start the packaging process, but it fails with an error in the log: <code>Error: Found editor-only material expression DebugFloat3Values in /Game/Golems/Materials/M_Golem_Eye. Disallowed for cook.</code></p><strong>What does this mean?</strong>\",choices:[{text:'A <code>debug node</code> was left in the eye material. These nodes are not allowed in packaged builds and must be removed.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> The cooker strips out anything meant only for the editor. Leaving temporary <code>debug nodes</code> in the material graph causes this specific cook error.</p>\",next:'step-18'},{text:\"The material has a compile error that only shows up during cooking.\",type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> It is a compile error, but the log message is very specific. It\\'s not a general error, but one caused by a specific type of node.</p>\",next:'step-18'},{text:'You need to install the <code>Material Debugging Utilities</code> plugin for the packaged game.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> Debugging tools are explicitly meant for the editor only.</p>\",next:'step-18'},{text:'The material needs to be saved with the <code>Shipping Build</code> flag enabled.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> No such flag exists for individual material assets.</p>\",next:'step-18'}]},\n        'step-18': {isTask: true, skill:'material',title:'Cleaning the Shader',prompt:\"<p>You remove the offending <code>debug node</code> and re-save the material. You restart the packaging process. It fails again with a different, more general error regarding the Golem mesh.</p><strong>What common material error prevents a mesh from being included in a packaged build?</strong>\",choices:[{text:'The <code>Collision Hull</code> for the mesh is missing or the <code>LODs</code> were imported incorrectly, causing a <code>static mesh validation error</code> during cook.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> Complex meshes, especially <code>skeletal meshes</code>, must pass cook-time validation, which often fails due to missing <code>collision geometry</code> or malformed <code>LODs</code>.</p>\",next:'conclusion'},{text:'The material is still using a <code>virtual texture asset</code>.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> While <code>virtual textures</code> require proper setup, this is usually a separate warning, not a hard cook failure on a <code>static mesh component</code>.</p>\",next:'conclusion'},{text:'You forgot to set the <code>Skeletal Mesh Component</code> to \"Hidden In Game\".',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> Hiding actors does not affect cook validation.</p>\",next:'conclusion'},{text:'The issue is actually with the AnimBP, which must be compiled for the target platform.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> The error points to the mesh component itself, not the <code>AnimBP</code> logic.</p>\",next:'conclusion'}]}\n      }\n  },\n  // --------------------------------------------------------------------------\n  // DASH SCENARIO: Focus on Character Input, Movement, and Networking Authority\n  // --------------------------------------------------------------------------\n  dash: {\n    meta: {\n      title: \"Player Dash Ability is Broken\",\n      description:\n        \"Traversal ability unresponsive. Covers input setup, cooldowns, movement, effects, and replication.\",\n      estimateHours: 16.0 // Adjusted for a more realistic, yet efficient, completion target\n    },\n    start: \"step-1\",\n    steps:\n      {\n        // === 1. INPUT & CORE MECHANICS (Input Mapping, Movement, Cooldowns) ===\n        'step-1': {isTask: true, skill:'input',title:'The Unresponsive Dash',prompt:\"<p>You've set up an Enhanced Input Action for a player dash, but pressing the button does nothing. The <code>OnStarted</code> event never fires in your Character Blueprint.</p><strong>What is the most common reason for an Enhanced Input Action to fail?</strong>\",choices:[{text:'The <code>Input Mapping Context</code> containing the dash action has not been added to the <code>Player Controller</code> at runtime.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> Enhanced Input requires you to explicitly add your mapping contexts to the player's subsystem, usually on <code>BeginPlay</code>. Without this step, the system has no registered actions to listen for.</p>\",next:'step-2'},{text:'The input event is being consumed by another Blueprint.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> This is a possible issue, but the mapping context not being added is a more fundamental setup error that would prevent the input from ever being processed in the first place.</p>\",next:'step-2'},{text:'The <code>Input Action</code> asset has <code>Consume Input</code> unchecked.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> This setting controls whether the input continues down the stack *after* it fires. It doesn't prevent the initial event from firing.</p>\",next:'step-2'},{text:'The <code>Character Movement Component</code> is blocking the input.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> The movement component handles movement logic; it does not block raw input action events from firing.</p>\",next:'step-1W'}]},\n        'step-1W': {isTask: false, skill:'input',title:'Wrong Subsystem',prompt:\"<p>You search your Character Blueprint's <code>BeginPlay</code> but can't find where to add the mapping context. You try adding it to the Game Instance instead, but it still doesn't work.</p><strong>Where is the correct place to add an Input Mapping Context?</strong>\",choices:[{text:'Get the <code>Player Controller</code>, get its <code>Enhanced Input Local Player Subsystem</code>, and call <code>Add Mapping Context</code>.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> You've found the correct execution path. Input is managed by a player-specific subsystem, which is accessed through the <code>Player Controller</code>.</p>\",next:'step-2'},{text:'Add it in the <code>Project Settings</code> under <code>Input</code>.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> That section is for the legacy input system. Enhanced Input is configured via its own assets and must be added at runtime.</p>\",next:'step-2'},{text:'The <code>Level Blueprint</code> must add it for all players.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> While this might work for a single-player game, it's bad practice. Input is player-specific and should be handled in a player-specific class like the Player Controller or Pawn.</p>\",next:'step-2'},{text:'You have to cast to the specific pawn from the <code>Player Controller</code> first.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> The subsystem exists on the Local Player, which is accessible directly from the Player Controller. You don't need a reference to the pawn for this step.</p>\",next:'step-2'}]},\n        \n        // --- Core Movement Logic ---\n        'step-2': {isTask: true, skill:'movement',title:'Movement Without Motion',prompt:\"<p>The input now fires! Your logic calls a <code>Launch Character</code> node to propel the player forward. You use a <code>Print String</code> to confirm the node is executing, but your character doesn't move at all.</p><strong>What is the most likely reason for <code>Launch Character</code> to do nothing?</strong>\",choices:[{text:'The <code>Launch Velocity</code> input is <code>(0,0,0)</code>, or the player is already moving at max speed and the current velocity is not being overridden.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> A zero-vector launch will have no effect. You must calculate a velocity based on the character's forward direction. Also, ensure the <code>XYOverride</code> and <code>ZOverride</code> booleans are checked to ignore current velocity.</p>\",next:'step-3'},{text:'The <code>Character Movement Component</code> has <code>Simulate Physics</code> enabled.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> <code>Launch Character</code> is designed to work with the Character Movement Component's standard (non-physics-simulating) movement modes.</p>\",next:'step-3'},{text:'The player is blocked by a small object on the floor.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> If the player were blocked, you would typically see a small nudge or collision effect. A complete lack of any motion points to a zero-velocity input.</p>\",next:'step-2M'},{text:'The <code>Event Tick</code> on the character is disabled.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> <code>Launch Character</code> is an impulse and does not depend on the actor's Tick being enabled to function.</p>\",next:'step-3'}]},\n        \n        'step-2M': {isTask: false, skill:'movement',title:'Adjusting Walk Speed (Dead End)',prompt:\"<p>You decide the character is too heavy and try increasing the <code>Max Walk Speed</code> and <code>Braking Deceleration</code> on the <code>Character Movement Component</code>.</p><p>This is a dead end! <code>Max Walk Speed</code> and <code>Braking Deceleration</code> only affect ground movement and are irrelevant to the <code>Launch Character</code> node. The character still doesn't move.</p><strong>What must you check next?</strong>\",choices:[{text:'Check the <code>Launch Velocity</code> input for a zero vector, and check the <code>XYOverride</code>/<code>ZOverride</code> booleans.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> Returning to the core issue. The problem is with the launch parameters, not the character's standard locomotion settings.</p>\",next:'step-3'},{text:'Delete the <code>Launch Character</code> node and replace it with <code>Add Force</code>.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> <code>Add Force</code> requires simulating physics and is completely inappropriate for Character movement.</p>\",next:'step-3'},{text:'Check if the character\\'s mesh has <code>No Collision</code> set.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> Collision prevents motion, but not *absence* of motion. You are wasting time on unrelated settings.</p>\",next:'step-3'}]},\n\n        // --- Cooldown and Resource Management ---\n        'step-3': {isTask: true, skill:'systems',title:'Infinite Dashes',prompt:\"<p>You fix the velocity calculation and the dash works! However, the player can spam the dash button infinitely without any limitation. The dash is supposed to have a 2-second cooldown.</p><strong>What is the standard way to implement a cooldown for an ability?</strong>\",choices:[{text:'Use a boolean like <code>bIsDashOnCooldown</code>, set it to true after dashing, and use a <code>Set Timer by Event</code> node with a 2-second delay to call an event that sets it back to false.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> This is a robust and common pattern. The boolean acts as a gate for the ability, and the timer reliably re-opens the gate after the specified duration.</p>\",next:'step-4'},{text:'On dash, record the <code>Get Game Time in Seconds</code> and, on the next attempt, check if the current time is greater than the recorded time plus 2.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> This works, but it's less efficient than a timer because it requires you to run this check every time the input is pressed. The boolean gate is a cleaner, more performant approach.</p>\",next:'step-4'},{text:'Add a <code>Delay</code> node for 2 seconds at the end of the dash logic.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> This is a critical error. A Delay node will freeze the entire execution chain. If the player presses the button during the delay, the input will be ignored. It does not prevent the initial logic from running again.</p>\",next:'step-4'},{text:'Create a <code>Timeline</code> that is 2 seconds long and only allow dashing when it is finished.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> Timelines are for updating values over time (like a fade or a pulse), not for simple cooldown timers. A Timer is the correct and more lightweight tool for this job.</p>\",next:'step-4'}]},\n        'step-4': {isTask: true, skill:'systems',title:'Free Stamina',prompt:\"<p>The cooldown works. Now, the dash is supposed to cost 25 stamina, but the player's stamina bar doesn't decrease. You have a \\\"Stamina\\\" float variable on your Character Blueprint.</p><strong>The dash logic includes a node that subtracts 25 from the \\\"Stamina\\\" variable. Why might the value not be changing?</strong>\",choices:[{text:'The logic checks if the player has <strong>enough</strong> stamina <strong>before</strong> subtracting, but the initial check is failing, preventing the subtraction from ever running.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> This is a common logic flow error. You put a guard clause (e.g., <code>Branch: Stamina >= 25</code>) at the start, but if the player's stamina is, for example, 24.9, the subtraction logic is never reached.</p>\",next:'step-5'},{text:'The <code>Stamina</code> variable is not marked as <code>Instance Editable</code>.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> This setting only affects whether you can change the variable's default value from the level editor. It has no impact on changing the value at runtime via Blueprint nodes.</p>\",next:'step-5'},{text:'The subtraction is happening, but another node on <code>Event Tick</code> is resetting the stamina back to full every frame.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> This is a plausible and frustrating bug, but it's a good practice to first check the logic immediately surrounding the ability call before hunting for unrelated logic on the Tick event.</p>\",next:'step-5'},{text:'You are trying to subtract from a local variable that was copied from the real Stamina variable, instead of the actual class member variable.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> While this is a common error in text-based programming, in Blueprints you typically drag the variable directly from the \\\"My Blueprint\\\" panel, ensuring you're modifying the correct one.</p>\",next:'step-5'}]},\n        \n        // === 2. VFX, SOUND, & CAMERA ISSUES (Cosmetics) ===\n        'step-5': {isTask: true, skill:'vfx',title:'The Silent Whoosh',prompt:\"<p>The stamina cost is now correctly applied. A 'whoosh' sound is supposed to play during the dash via a <code>Play Sound at Location</code> node. The node is executing, but no sound is heard.</p><strong>What is the most fundamental reason for this node to fail to produce sound?</strong>\",choices:[{text:'The <code>Sound</code> input pin on the node is not assigned to a <code>Sound Wave</code> or <code>Sound Cue</code> asset.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> Just like many other nodes, if the primary asset input is <code>None</code>, the node will execute silently but do nothing. This is always the first thing to check.</p>\",next:'step-6'},{text:'The <code>Location</code> input is <code>(0,0,0)</code> and the player is far away from the world origin.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> This would also result in silence, but a missing sound asset is a more common and basic setup error.</p>\",next:'step-6'},{text:\"The sound's <code>Attenuation</code> settings have a radius of zero.\",type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> This is a plausible cause, but it's a data issue within the sound asset itself. You should first verify that the Blueprint node is even configured with an asset to play.</p>\",next:'step-6'},{text:'You are using <code>Play Sound at Location</code> instead of <code>Play Sound 2D</code>.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> A dash sound is spatialized and should emanate from the player, so <code>Play Sound at Location</code> is the correct node to use. <code>Play Sound 2D</code> is for non-spatial UI sounds.</p>\",next:'step-6'}]},\n        'step-6': {isTask: true, skill:'vfx',title:'The Invisible Trail',prompt:\"<p>The dash sound now plays correctly. A Niagara particle system is supposed to create a trail effect, but no particles appear. You've added a Niagara Component to your Character Blueprint.</p><strong>What is the most common reason for a Niagara Component to not play its effect at runtime?</strong>\",choices:[{text:'The component\\'s <code>Auto Activate</code> property is set to false, and you have not explicitly called the <code>Activate</code> node on the component in your dash logic.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> For performance, it's common practice to disable auto-activation for effects that only play on demand. You must manually trigger them with an <code>Activate</code> node when the ability is used.</p>\",next:'step-7'},{text:'The Niagara System asset itself has a compile error.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> This is possible, but you should always check your Blueprint activation logic first. A missing <code>Activate</code> call is far more common than a broken asset.</p>\",next:'step-7'},{text:'The material used by the particles is transparent, making them invisible.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> While a bad material could cause issues, it's highly unlikely to be completely invisible. It's more probable that the system isn't being told to run at all.</p>\",next:'step-7'},{text:'The <code>Niagara Component</code> must be the root component of the <code>Blueprint</code>.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> Particle components are meant to be attached to other components (like the character's mesh) and should almost never be the root.</p>\",next:'step-7'}]},\n        \n        // === 3. NETWORKING & REPLICATION ISSUES (Cosmetics & Authority) ===\n        'step-7': {isTask: true, skill:'rep',title:'The Invisible Dash',prompt:\"<p>The dash now works perfectly for you. In multiplayer, however, you can see your own dash effect, but you can't see other players dashing. They just teleport from point A to B.</p><strong>Why are the cosmetic parts of the dash (sound, VFX) not visible on other clients?</strong>\",choices:[{text:'The events that trigger the cosmetics are only running on the server and the local client. They need to be called from a <code>Multicast</code> RPC to execute on all clients.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> The server handles the authoritative movement (the teleport), which everyone sees. But cosmetic effects must be explicitly told to play for all observers via a Multicast event.</p>\",next:'step-8'},{text:'The <code>Niagara System</code> asset needs its <code>Replicates</code> flag checked.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> Assets do not have replication flags. Their *execution* must be controlled by replicated logic.</p>\",next:'step-8'},{text:'The other clients are too far away to see the effect.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> This is a logic replication issue, not a distance or culling problem. The clients are not being told to play the effect at all.</p>\",next:'step-8'},{text:'The logic should be in a <code>Run on Owning Client</code> RPC instead.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> This would make the effect visible to the player who is dashing (which it already is), but other players still wouldn't see it. A Multicast is needed to show it to everyone.</p>\",next:'step-8'}]},\n        \n        // --- Movement Authority and Synchronization ---\n        'step-8': {isTask: true, skill:'rep',title:'The Snap-Back',prompt:\"<p>You've multicast the cosmetic effects. Now, clients report that when they dash, they move smoothly for a moment and then snap back to their starting position.</p><strong>What causes this classic client-server desynchronization?</strong>\",choices:[{text:\"The dash logic (e.g., <code>Launch Character</code>) is only being executed on the client. The server, which has authority, doesn't know the dash occurred and corrects the client's position.\",type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> This is a fundamental networking concept. Any action that changes an actor's position must be executed on the server. The client's input should trigger a <code>Run on Server</code> RPC that contains the movement logic.</p>\",next:'step-9'},{text:'The client\\'s network connection is lagging.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> Lag will make the snap-back more noticeable, but the root cause is the logical error of not running the movement code on the server.</p>\",next:'step-9'},{text:'The <code>Character Movement Component</code> has <code>Allow Client-Side Prediction</code> disabled.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> Client-side prediction is what allows clients to feel responsive. You try enabling it to fix the snap-back.</p>\",next:'step-8M'},{text:'The Multicast event for the VFX is interfering with the movement.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> Cosmetic events and character movement are handled by separate systems and do not interfere with each other. This is a complete distraction.</p>\",next:'step-8W'}]},\n        \n        // Dead-end: Client Prediction Failure\n        'step-8M': {isTask: false, skill:'rep',title:'Client Prediction Failure (Dead End)',prompt:\"<p>You enabled <code>Allow Client-Side Prediction</code>, but the character still snaps back. Client-side prediction helps smooth *movement interpolation*, but it relies on the server validating and accepting the input, which isn't happening because the dash isn't running on the server.</p><strong>What is the next logical step to ensure the dash is acknowledged by the server?</strong>\",choices:[{text:'The client\\'s input must trigger a <code>Run on Server</code> RPC that contains the movement logic.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> You correctly identified the need for server authority over movement, not just client-side prediction.</p>\",next:'step-9'},{text:'Check the <code>Is Authority</code> node before the launch and branch the logic.',type:'partial',feedback:\"<p><strong>Standard Time Logged:</strong> Checking authority is often a good practice, but it doesn't solve the core problem of getting the client input to execute the authoritative action on the server.</p>\",next:'step-9'},{text:'Increase the <code>Network Update Frequency</code> on the character.',type:'misguided',feedback:\"<p><strong>Extended Time Logged (Investigation):</strong> This just increases the rate of the snap-back, not preventing the server from correcting the move.</p>\",next:'step-9'}]},\n        \n        // Dead-end: Irrelevant Authority Check\n        'step-8W': {isTask: false, skill:'rep',title:'Irrelevant Authority Check (Dead End)',prompt:\"<p>You waste time checking the relationship between the cosmetic multicast and character movement. This is a false lead; they are handled separately.</p><strong>What fundamental networking principle are you overlooking regarding player movement?</strong>\",choices:[{text:\"The client's input must trigger a <code>Run on Server</code> RPC that contains the movement logic.\",type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> Client-driven movement must always be executed by the server to maintain network authority and synchronization.</p>\",next:'step-9'},{text:'Check the <code>Is Valid</code> node before the launch and branch the logic.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> Irrelevant to network authority.</p>\",next:'step-9'},{text:'Increase the size of the <code>Replicated Movement</code> property struct.',type:'wrong',feedback:\"<p><strong>Maximum Time Logged (Ineffective Fix):</strong> Incorrectly looking for a setting that doesn't exist to solve a logic error.</p>\",next:'step-9'}]},\n\n        // === 4. ANIMATION & COLLISION REFINEMENT ===\n        'step-9': {isTask: true, skill:'collision',title:'Dashing Through Walls',prompt:\"<p>You've moved the dash logic to a server RPC and it replicates correctly. However, QA reports that if they dash at a thin wall, they sometimes pass right through it.</p><strong>What feature of the Character Movement Component is designed to prevent this?</strong>\",choices:[{text:'Enabling <code>Sweep</code> on the movement call (e.g., <code>Set Actor Location</code>) or using a movement component function that sweeps automatically, like <code>Add Movement Input</code>.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> A 'teleport' without a sweep will not check for collisions between the start and end points. Enabling sweeping treats the movement as a continuous motion and respects collision, preventing tunneling.</p>\",next:'step-10'},{text:'Increasing the character\\'s capsule radius.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> While a larger capsule makes collision more likely, it doesn't solve the underlying issue of teleporting through objects without checking the path taken.</p>\",next:'step-10'},{text:'Enabling <code>Continuous Collision Detection</code> (CCD) on the capsule component.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> CCD is for physics-simulating objects to prevent tunneling at high speeds. For Character Movement, which is not a true physics simulation, sweeping is the correct and more performant solution.</p>\",next:'step-10'},{text:'Increasing the mass of the character.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> Mass has no effect on the kinematic movement of the Character Movement Component.</p>\",next:'step-10'}]},\n        'step-10': {isTask: true, skill:'animation',title:'The Static Dash',prompt:\"<p>The dash is mechanically sound. Now for the animation. You have a dash animation montage, but when you call <code>Play Anim Montage</code>, the character remains in their idle/run pose.</p><strong>What is a common setup error that prevents an Anim Montage from playing?</strong>\",choices:[{text:\"The <code>Anim BP's AnimGraph</code> is missing a <code>Slot</code> node. Montages need a named slot to play into, which overrides the base animation from the state machine.\",type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> The <code>AnimGraph</code> is a flow of poses. A <code>Slot</code> node acts as an injection point where a montage can temporarily take over the final animation pose.</p>\",next:'step-11'},{text:'The montage asset has not been saved.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> An unsaved asset would likely result in a <code>None</code> reference and a warning in the output log. If the node is executing without warnings, the problem is likely in the Anim BP setup.</p>\",next:'step-11'},{text:'The character is not in the correct <code>Movement Mode</code> (e.g., <code>Falling</code>).',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> Montages can be played regardless of the character's movement mode.</p>\",next:'step-11'},{text:'You must use <code>Play Animation</code> instead of <code>Play Anim Montage</code>.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> <code>Play Animation</code> is for simple, single-asset playback. Montages are specifically designed for layered, temporary animations like attacks or abilities, and <code>Play Anim Montage</code> is the correct node.</p>\",next:'step-11'}]},\n        'step-11': {isTask: true, skill:'animation',title:'The Blending Snap',prompt:\"<p>You add a Slot node and the dash montage now plays. However, it snaps into the animation and snaps back out instantly, which looks very jarring.</p><strong>What controls the smooth transition into and out of a montage?</strong>\",choices:[{text:'The <code>Blend In</code> and <code>Blend Out</code> time settings within the <code>Anim Montage</code> asset itself.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> These properties, found in the montage's details panel, control the duration over which the engine will interpolate from the base animation pose to the montage pose, and vice-versa.</p>\",next:'step-12'},{text:'The <code>Interpolation</code> settings on the <code>Blendspace</code> used in the <code>State Machine</code>.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> Blendspace interpolation affects transitions *within* the state machine (e.g., from idle to run), not how a montage blends on top of it.</p>\",next:'step-12'},{text:'A \"Montage Blend\" node in the Anim BP event graph.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> No such node exists. Blending is controlled by the montage asset's data.</p>\",next:'step-12'},{text:'The <code>Play Rate</code> input on the <code>Play Anim Montage</code> node.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> Play Rate controls the speed of the animation's playback, not the smoothness of the transition into it.</p>\",next:'step-12'}]},\n        'step-12': {isTask: true, skill:'animation',title:'The Root Motion Problem',prompt:\"<p>The blending is now smooth. However, the dash is now moving the player almost twice as far as intended. It seems like two systems are applying motion.</p><strong>What is the cause of this \\\"double movement\\\"?</strong>\",choices:[{text:'The animation has <code>Root Motion</code>, and you are also applying movement with a <code>Launch Character</code> node. You should do one or the other, not both.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> <code>Root Motion</code> extracts movement from the animation itself and applies it to the character. If you're also applying a manual launch, you're applying two sources of velocity. You should either disable <code>Root Motion</code> or remove the <code>Launch Character</code> call.</p>\",next:'step-13'},{text:'The animation\\'s <code>Play Rate</code> is set to 2.0.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> A faster play rate would make the animation finish faster, but it wouldn't double the distance of a separate <code>Launch Character</code> call.</p>\",next:'step-13'},{text:'The server is correcting the client\\'s position, causing an overshoot.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> A server correction would typically cause a snap-back, not a consistent doubling of movement distance.</p>\",next:'step-13'},{text:'The character\\'s <code>Max Walk Speed</code> is too high.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> Max Walk Speed applies to standard ground movement and does not affect the velocity applied by a launch or root motion.</p>\",next:'step-13'}]},\n        \n        // --- UI & Rendering Polish ---\n        'step-13': {isTask: true, skill:'ui',title:'Stale Stamina Bar',prompt:\"<p>You decide to use <code>Launch Character</code> and disable <code>Root Motion</code>. The movement is now correct. However, the UI's stamina bar does not update immediately after a dash. It only updates after the next time the player jumps or sprints.</p><strong>What causes this kind of delayed UI update?</strong>\",choices:[{text:'The UI is not being notified of the change. The stamina bar\\'s value is probably only being updated by other events (like jumping) and not by the dash event.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> This indicates that your UI update logic is not centralized. A robust solution is to use an <code>Event Dispatcher</code> or an <code>interface call</code> whenever stamina changes, which the UI can bind to and update itself accordingly.</p>\",next:'step-14'},{text:'The stamina bar widget has <code>Is Volatile</code> set to false.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> <code>Is Volatile</code> forces the widget to be redrawn every frame, which is bad for performance and doesn't solve the underlying problem that the data it's trying to draw is stale.</p>\",next:'step-14'},{text:'The widget has its <code>Tick</code> disabled.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> While you could update the UI on Tick, this is inefficient (\\\"polling\\\"). An event-driven approach where the UI is told when to update is far better.</p>\",next:'step-14'},{text:'The player\\'s stamina variable is not replicated.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> If the variable isn't replicated, clients' UI would be out of sync with the server. However, the problem describes a delayed update even for the local player, which points to a logic flow issue, not a replication one.</p>\",next:'step-14'}]},\n        'step-14': {isTask: true, skill:'render',title:'The Missing Blur',prompt:\"<p>The dash is supposed to trigger a radial blur Post Process effect. You have a Post Process Component on your character, and your logic is setting its parameters, but nothing happens to the screen.</p><strong>Why would setting parameters on a Post Process Component have no visible effect?</strong>\",choices:[{text:'The component is not enabled. You need to set its <code>Enabled</code> property to true at the start of the dash and false at the end.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> Just like particle systems, Post Process Components can be enabled and disabled for performance. Simply changing their parameters won't do anything if the component itself is not active.</p>\",next:'step-15'},{text:'The <code>Blend Weight</code> of the component is set to 0.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> A blend weight of 0 would also make the effect invisible. However, the enabled/disabled state is a more common and fundamental gate for the entire component's influence.</p>\",next:'step-15'},{text:'The level already has an Unbound <code>Post Process Volume</code> with a higher priority.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> While priority matters for blending, even a low-priority component would have *some* visible effect unless its blend weight was zero or it was disabled.</p>\",next:'step-15'},{text:'The material used for the effect has a compile error.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> A material error would likely show up as the default grid material on screen, not a complete lack of any effect.</p>\",next:'step-15'}]},\n        'step-15': {isTask: true, skill:'camera',title:'The Static Camera',prompt:\"<p>The dash is supposed to briefly increase the camera's Field of View (FOV) for a sense of speed. Your logic calls <code>Set Field of View</code> on the player's camera, but the FOV remains unchanged.</p><strong>What is the most likely reason the camera's properties are not being updated?</strong>\",choices:[{text:'You are getting a reference to the wrong camera. You might be modifying the default Camera Component instead of the active one, especially if you are using a system like a spring arm.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> A common error is to have multiple camera components (e.g., one for first-person, one for third-person) and get a reference to the inactive one. You must ensure you are targeting the currently active player camera.</p>\",next:'step-16'},{text:'The <code>Camera Manager</code> is overriding your settings.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> The Player Camera Manager is the final authority on camera settings. If it's running a camera shake or another effect, it could be overwriting your FOV change. However, getting a bad reference to the camera itself is a more basic error.</p>\",next:'step-16'},{text:'The \"Lock Camera\" setting is enabled on the character.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> No such setting exists. Camera control is managed through the Player Controller and Camera Manager.</p>\",next:'step-16'},{text:'You cannot change the <code>FOV</code> at runtime; it must be set in the <code>Blueprint</code> defaults.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> The FOV is designed to be changed dynamically at runtime for effects like sprinting, aiming, and dashing.</p>\",next:'step-16'}]},\n        \n        // === 5. COLLISION, PHYSICS & MOVEMENT REFINEMENT ===\n        'step-16': {isTask: true, skill:'physics',title:'The Immovable Crate',prompt:\"<p>Dashing into a physics-simulating crate is supposed to send it flying. Instead, it just stops your dash. Your overlap logic calls an <code>Add Impulse</code> node on the crate.</p><strong>Why would <code>Add Impulse</code> fail to move an object that is simulating physics?</strong>\",choices:[{text:'The impulse strength is too low compared to the mass of the object, or the crate has its <code>Lock Position</code> constraint enabled in its physics settings.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> Physics calculations are a balance of forces. If the impulse is too weak or the object's mass is astronomical, there will be no visible movement. Locked constraints would also prevent any movement.</p>\",next:'step-17'},{text:'The <code>Velocity Change</code> boolean on the <code>Add Impulse</code> node is unchecked.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> Checking this box makes the impulse ignore the object's mass, which can be a good way to guarantee movement. However, the root cause is still likely an imbalance of mass and force.</p>\",next:'step-17'},{text:'The crate is not a child of a Voxel Physics object.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> This is not a concept in standard Unreal Engine physics. Any component with <code>Simulate Physics</code> enabled can receive an impulse.</p>\",next:'step-17'},{text:'The server is rejecting the physics interaction.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> While physics replication can be complex, a basic impulse call that fails to move an object locally points to a physics properties issue, not a networking one.</p>\",next:'step-17'}]},\n        'step-17': {isTask: true, skill:'collision',title:'Dashing Off Ledges',prompt:\"<p>A new design requires an aerial dash. If the player dashes while in the air, they should move forward, not fall. Currently, they dash forward but still fall due to gravity.</p><strong>What setting in the <code>Launch Character</code> node can be used to achieve this?</strong>\",choices:[{text:'Check the <code>Z Override</code> boolean. This will make the Z component of your launch velocity replace the character\\'s current vertical velocity (i.e., gravity).',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> This is precisely what Z Override is for. By providing a Z velocity of 0 and overriding, you are effectively canceling out gravity for the duration of the launch, resulting in a horizontal air dash.</p>\",next:'step-18'},{text:'Set the <code>Character Movement Component\\'s Gravity Scale</code> to 0 before the dash.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> This would work, but it's a \\\"leaky\\\" abstraction. You would need to remember to set it back to 1.0 after the dash. The <code>Launch Character</code> node's built-in override is a cleaner, more self-contained solution.</p>\",next:'step-18'},{text:'Set the <code>Movement Mode</code> to <code>Flying</code> before the dash.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> While this would negate gravity, it's a heavy-handed state change that has many other side effects. It's not the intended way to implement an air dash.</p>\",next:'step-18'},{text:'The Z value of the <code>Launch Velocity</code> needs to be a large positive number.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> This would launch the character upwards, not create a level horizontal dash. To cancel falling, you need to override the existing downward velocity.</p>\",next:'step-18'}]},\n        'step-18': {isTask: true, skill:'systems',title:'Dashing While Stunned',prompt:\"<p>The player can still dash even when a 'stunned' gameplay effect is active. The stun effect is supposed to block all abilities.</p><strong>What is the best-practice way to have systems like stuns block abilities like the dash?</strong>\",choices:[{text:'Use <code>Gameplay Tags</code>. The stun effect should grant the player a <code>State.Stunned</code> tag, and the dash ability logic should have a check for <code>Has Tag: State.Stunned</code> at the very beginning.',type:'correct',feedback:\"<p><strong>Optimal Time Logged:</strong> <code>Gameplay Tags</code> are the ideal, data-driven way to manage states and abilities. It's scalable, decoupled, and makes it easy to see what states an actor is in and what abilities are blocked by those states.</p>\",next:'step-19'},{text:'Create a <code>bIsStunned</code> boolean on the Player Character and check it before dashing.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> This works for one or two states, but it's not scalable. What if you add a \\\"rooted\\\" state, a \\\"silenced\\\" state, etc.? You'll end up with a messy pile of booleans. Tags are designed to solve this problem cleanly.</p>\",next:'step-19'},{text:'From the stun logic, call <code>Disable Input</code> on the <code>Player Controller</code>.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> This is a sledgehammer approach. It would block *all* input, including looking around or opening the menu. A proper stun should only block specific actions, which tags allow you to do.</p>\",next:'step-19'},{text:'The dash logic should get all actors with a \"stun\" component and check if the player is one of them.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> This inverts the dependency and is very inefficient. The player should know their own state; they shouldn't have to search the entire world to find out if they are stunned.</p>\",next:'step-19'}]},\n        'step-19': {isTask: true, skill:'collision',title:'The Trace Check',prompt:\"<p>To prevent dashing into walls, you add a capsule trace before the launch to see if the path is clear. However, the trace immediately hits your own character, and the dash always fails.</p><strong>How do you prevent a trace from hitting the actor that initiated it?</strong>\",choices:[{text:'Add your character to the <code>Actors to Ignore</code> array pin on the trace node.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> This is the most direct and explicit way to solve the problem. The trace will then ignore the specified actor and correctly check the environment beyond it.</p>\",next:'step-20'},{text:'In your character\\'s collision settings, set the <code>Trace Response</code> channel to <code>Ignore</code>.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> This would make your character ignore *all* traces of that type, which could have unintended side effects for other systems (like AI visibility checks or weapon targeting).</p>\",next:'step-20'},{text:'Set the <code>Trace Complexity</code> to <code>Simple Collision</code>.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> This determines whether the trace uses the simple physics body or the complex per-poly mesh. It doesn't affect which actors are hit.</p>\",next:'step-20'},{text:'Start the trace from a location far in front of the character.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> This is a common but flawed workaround. It creates a \\\"dead zone\\\" right in front of the player where obstacles won\\'t be detected. Using \\\"Actors to Ignore\\\" is the correct solution.</p>\",next:'step-20'}]},\n        \n        // === 6. PERFORMANCE & FINAL GAS REFACTOR ===\n        'step-20': {isTask: true, skill:'perf',title:'The Cost of Dashing',prompt:\"<p>The game runs smoothly, but a profiler reveals that every time a dash occurs, there is a small but noticeable garbage collection (GC) hitch. The dash logic itself doesn't seem to be creating actors.</p><strong>What non-obvious part of Blueprint can create objects and trigger GC?</strong>\",choices:[{text:'Using <code>Format Text</code> nodes or string <code>Append</code> nodes. These create new <code>FString</code> objects in memory that the garbage collector eventually needs to clean up.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> This is a common hidden performance cost. For frequently updated debug text or UI, these nodes can generate a lot of temporary string objects. In performance-critical code, it's better to avoid them.</p>\",next:'step-21'},{text:'Calling a pure function.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> Pure functions are just functions that don't modify state; they do not inherently create objects or cause GC hitches.</p>\",next:'step-21'},{text:'Using a <code>For Each Loop</code> node.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> Loops iterate over existing memory; they do not allocate new objects for each iteration.</p>\",next:'step-21'},{text:'Creating a local variable inside a function.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> Local variables are allocated on the stack and are cleaned up when the function returns. They are not managed by the garbage collector and do not cause GC hitches.</p>\",next:'step-21'}]},\n        'step-21': {isTask: true, skill:'audio',title:'The Abrupt Sound Cutoff',prompt:\"<p>The dash sound effect has a nice, fading tail. However, if the player dashes again quickly, the tail of the previous sound cuts off instantly to play the new one.</p><strong>How do you allow multiple instances of a sound to overlap and play out fully?</strong>\",choices:[{text:'In the <code>Sound Cue</code> or <code>Sound Wave</code> asset, adjust the <code>Concurrency</code> settings to allow more than one instance of the sound to play at once.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> Concurrency settings manage how many instances of a sound can be active. By increasing the \\\"Max Count\\\", you allow new sounds to play without stopping the old ones.</p>\",next:'step-22'},{text:'Use \"Spawn Sound Attached\" instead of \"Play Sound at Location\".',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> Both nodes are affected by the asset's concurrency settings. Changing the node won't solve the underlying data limitation.</p>\",next:'step-22'},{text:'Add a <code>Fade Out</code> node before playing the new sound.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> This would make the problem sound smoother, but it wouldn't solve the core issue of allowing the sounds to overlap naturally.</p>\",next:'step-22'},{text:'In the <code>Project Settings</code>, increase the <code>Max Audio Channels</code>.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> While a very low number of max channels could cause sounds to be culled, the Concurrency setting on the asset itself is the direct and intended control for this specific behavior.</p>\",next:'step-22'}]},\n        \n        // --- Gameplay Ability System (GAS) Conversion ---\n        'step-22': {isTask: true, skill:'systems',title:'The State Machine Conflict (GAS)',prompt:\"<p>You refactor your dash logic to use a Gameplay Ability from the Gameplay Ability System (GAS). When you try to activate the ability, it fails silently.</p><strong>What is a common reason for a Gameplay Ability to fail to activate?</strong>\",choices:[{text:'The ability is being blocked by another tag. The <code>Blocked by Tags</code> property on the ability is preventing it from running while the character has a tag like <code>State.Sprinting</code>.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> <code>GAS</code> uses <code>Gameplay Tags</code> extensively for control flow. An ability can have tags that block it, and it can be blocked by tags that the character currently possesses. This is the first place to check for an activation failure.</p>\",next:'step-23'},{text:'The <code>Ability System Component</code> is not on the <code>Player State</code>.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> While the ASC is often on the Player State, it can also be on the Character. The location of the component is less likely to be the issue than a tag conflict.</p>\",next:'step-23'},{text:'The ability has no \"Cost\" Gameplay Effect.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> An ability does not need to have a cost to be activated.</p>\",next:'step-23'},{text:'The <code>Try Activate Ability by Class</code> node is bugged.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> This node is the standard way to activate abilities and is very reliable. The failure is almost certainly in your data setup (tags, costs, cooldowns), not the node itself.</p>\",next:'step-23'}]},\n        'step-23': {isTask: true, skill:'systems',title:'The Unapplied Cooldown (GAS)',prompt:\"<p>Your dash ability now activates through GAS. However, the cooldown isn't working. The ability can be spammed. You have a \\\"Cooldown\\\" Gameplay Effect specified in the ability's details.</p><strong>Why would a Cooldown Gameplay Effect fail to apply?</strong>\",choices:[{text:'The <code>Gameplay Effect\\'s</code> duration is set to <code>Instant</code> instead of <code>Has Duration</code>. A cooldown must have a duration to be effective.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> An instant Gameplay Effect applies and is immediately removed. For a cooldown, the effect must be applied to the character for a set duration, during which it grants a tag that blocks the ability.</p>\",next:'step-24'},{text:'The <code>Gameplay Effect</code> is missing a <code>Magnitude</code> modifier.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> Magnitude is for how much an attribute is changed (e.g., damage amount). It is irrelevant for a simple cooldown tag.</p>\",next:'step-24'},{text:'The <code>Cooldown Tags</code> in the ability are not set correctly.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> The ability needs to check for the cooldown tag granted by the effect. However, if the effect itself isn't applying correctly (due to being Instant), this check doesn't matter.</p>\",next:'step-24'},{text:'The server is not authoritative over the Gameplay Effect.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> By default, Gameplay Effects are handled authoritatively by the server. This is not something you would typically configure incorrectly.</p>\",next:'step-24'}]},\n        \n        // --- Final Build and Polish ---\n        'step-24': {isTask: true, skill:'build',title:'The Cooker Warning',prompt:\"<p>You are packaging a build and see a warning in the log: <code>LogCook: Warning: /Game/Characters/BP_PlayerCharacter references /Game/UI/WBP_DebugHUD. WBP_DebugHUD is an editor-only asset and will not be cooked.</code> The build succeeds, but you're concerned.</p><strong>What is the best way to fix this?</strong>\",choices:[{text:'Wrap the logic that creates the debug widget in a <code>Is Standalone Screen</code> or <code>Is With Editor</code> macro node to ensure it only runs in editor builds.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> These macro nodes are specifically designed to strip out editor-only logic from packaged builds, which resolves the warning and prevents potential errors in the shipped game.</p>\",next:'step-25'},{text:'Delete the debug widget logic entirely.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> The debug widget is likely useful for development. Removing it completely is a short-sighted fix. The goal is to keep it for developers but exclude it for players.</p>\",next:'step-25'},{text:'Move the debug widget to the \"Developer\" content folder.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> This can help organize assets, and some cooker settings can be configured to exclude developer folders. However, using the editor-only macros is a more explicit and reliable way to control the logic flow.</p>\",next:'step-25'},{text:'Ignore the warning, since the build succeeded.',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> A successful build with cooking warnings is not a clean build. This warning indicates that a reference will be <code>None</code> in the packaged game, which could lead to a crash if not handled properly.</p>\",next:'step-25'}]},\n        'step-25': {isTask: true, skill:'perf',title:'The Final Polish',prompt:\"<p>The dash is feature-complete. The last piece of feedback is that the stop feels 'floaty'. The player continues to slide for a moment after the dash velocity is applied.</p><strong>What property in the Character Movement Component controls how quickly a character comes to a stop?</strong>\",choices:[{text:'<code>Braking Deceleration Walking</code>. Increasing this value will make the character decelerate faster, resulting in a tighter, more responsive stop.',type:'correct',feedback:\"<p><strong>Correct (+5 points):</strong> This is the direct physics-based property that controls friction and braking force on the ground. Tuning this value is key to achieving the desired game feel for movement.</p>\",next:'conclusion'},{text:'<code>Max Acceleration</code>.',type:'misguided',feedback:\"<p><strong>Misguided (+0 points):</strong> This controls how quickly the character gets *up to* max speed, not how quickly they stop.</p>\",next:'conclusion'},{text:'\"Mass\".',type:'wrong',feedback:\"<p><strong>Wrong (+0 points):</strong> Mass is not used for the standard kinematic movement calculations in the Character Movement Component. It only comes into play when being pushed by external physical forces.</p>\",next:'conclusion'},{text:'<code>Use Separate Braking Friction</code>.',type:'partial',feedback:\"<p><strong>Partially Correct (+2 points):</strong> This boolean enables a separate friction value for braking, but the <code>Braking Deceleration</code> is the actual value that needs to be tuned.</p>\",next:'conclusion'}]}\n      }\n  },\n\n};","usedDeprecatedRules":[]}]
